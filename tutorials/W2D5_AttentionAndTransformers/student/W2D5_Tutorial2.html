
<!DOCTYPE html>

<html lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/><meta content="Docutils 0.18.1: http://docutils.sourceforge.net/" name="generator"/>
<title>Bonus Tutorial: Understanding Pre-training, Fine-tuning and Robustness of Transformers — Neuromatch Academy: Deep Learning</title>
<script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
<!-- Loaded before other Sphinx assets -->
<link href="../../../_static/styles/theme.css?digest=796348d33e8b1d947c94" rel="stylesheet"/>
<link href="../../../_static/styles/bootstrap.css?digest=796348d33e8b1d947c94" rel="stylesheet"/>
<link href="../../../_static/styles/pydata-sphinx-theme.css?digest=796348d33e8b1d947c94" rel="stylesheet"/>
<link href="../../../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=796348d33e8b1d947c94" rel="stylesheet"/>
<link as="font" crossorigin="" href="../../../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" rel="preload" type="font/woff2"/>
<link as="font" crossorigin="" href="../../../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" rel="preload" type="font/woff2"/>
<link as="font" crossorigin="" href="../../../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" rel="preload" type="font/woff2"/>
<link href="../../../_static/pygments.css" rel="stylesheet" type="text/css">
<link href="../../../_static/styles/sphinx-book-theme.css?digest=4ec06e9971c5264fbd345897d5258098f11cc577" rel="stylesheet" type="text/css">
<link href="../../../_static/togglebutton.css" rel="stylesheet" type="text/css">
<link href="../../../_static/copybutton.css" rel="stylesheet" type="text/css">
<link href="../../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" rel="stylesheet" type="text/css">
<link href="../../../_static/sphinx-thebe.css" rel="stylesheet" type="text/css">
<link href="../../../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" rel="stylesheet" type="text/css">
<!-- Pre-loaded scripts that we'll load fully later -->
<link as="script" href="../../../_static/scripts/bootstrap.js?digest=796348d33e8b1d947c94" rel="preload"/>
<link as="script" href="../../../_static/scripts/pydata-sphinx-theme.js?digest=796348d33e8b1d947c94" rel="preload"/>
<script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
<script src="../../../_static/jquery.js"></script>
<script src="../../../_static/underscore.js"></script>
<script src="../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
<script src="../../../_static/doctools.js"></script>
<script src="../../../_static/clipboard.min.js"></script>
<script src="../../../_static/copybutton.js"></script>
<script src="../../../_static/scripts/sphinx-book-theme.js?digest=8bf782fb4ee92b3d3646425e50f299c4e1fd152d"></script>
<script>let toggleHintShow = 'Click to show';</script>
<script>let toggleHintHide = 'Click to hide';</script>
<script>let toggleOpenOnPrint = 'true';</script>
<script src="../../../_static/togglebutton.js"></script>
<script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
<script src="../../../_static/design-tabs.js"></script>
<script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
<script async="async" src="../../../_static/sphinx-thebe.js"></script>
<script type="application/vnd.jupyter.widget-state+json">{"state": {"007c553db88949729b9875240f43e567": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "c5fe70288f6447dfbbd2871616b58181": {"model_name": "OutputModel", "model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_007c553db88949729b9875240f43e567", "msg_id": "", "outputs": [{"output_type": "stream", "name": "stdout", "text": "If you want to download the slides: https://osf.io/download/6eudb/\n"}, {"output_type": "display_data", "metadata": {}, "data": {"text/plain": "<IPython.lib.display.IFrame at 0x7f2240af57c0>", "text/html": "\n        <iframe\n            width=\"730\"\n            height=\"410\"\n            src=\"https://mfr.ca-1.osf.io/render?url=https://osf.io/6eudb/?direct%26mode=render%26action=download%26mode=render\"\n            frameborder=\"0\"\n            allowfullscreen\n            \n        ></iframe>\n        "}}], "tabbable": null, "tooltip": null}}, "8df6104e01bc44b5b743e515b0c610d4": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "bde97f3231ca46feac3dc73729f7adca": {"model_name": "OutputModel", "model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_8df6104e01bc44b5b743e515b0c610d4", "msg_id": "", "outputs": [{"output_type": "stream", "name": "stdout", "text": "Video available at https://youtube.com/watch?v=dMpvzEEDOwI\n"}, {"output_type": "display_data", "metadata": {}, "data": {"text/plain": "<IPython.lib.display.YouTubeVideo at 0x7f22405559d0>", "text/html": "\n        <iframe\n            width=\"730\"\n            height=\"410\"\n            src=\"https://www.youtube.com/embed/dMpvzEEDOwI?fs=1&rel=0\"\n            frameborder=\"0\"\n            allowfullscreen\n            \n        ></iframe>\n        ", "image/jpeg": "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"}}], "tabbable": null, "tooltip": null}}, "a533b4455a214fbf8da5ad86a0b34aa4": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "7fa369c9151a4f9283cf1402e70a033b": {"model_name": "OutputModel", "model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_a533b4455a214fbf8da5ad86a0b34aa4", "msg_id": "", "outputs": [{"output_type": "stream", "name": "stdout", "text": "Video available at https://www.bilibili.com/video/BV13q4y1X7Tt\n"}, {"output_type": "display_data", "metadata": {}, "data": {"text/plain": "<__main__.PlayVideo at 0x7f2175fa6e20>", "text/html": "\n        <iframe\n            width=\"730\"\n            height=\"410\"\n            src=\"https://player.bilibili.com/player.html?bvid=BV13q4y1X7Tt&page=1?fs=1&autoplay=False\"\n            frameborder=\"0\"\n            allowfullscreen\n            \n        ></iframe>\n        "}}], "tabbable": null, "tooltip": null}}, "71d30dbf9bc44d93807a71328ff7a898": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "ea98d59b455b490284368d1304980c87": {"model_name": "TabModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "TabModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "TabView", "box_style": "", "children": ["IPY_MODEL_bde97f3231ca46feac3dc73729f7adca", "IPY_MODEL_7fa369c9151a4f9283cf1402e70a033b"], "layout": "IPY_MODEL_71d30dbf9bc44d93807a71328ff7a898", "selected_index": 0, "tabbable": null, "titles": ["Youtube", "Bilibili"], "tooltip": null}}, "9ec0e2f9825443c4b3c828821b986e84": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": "auto", "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": "0.5em", "right": null, "top": null, "visibility": null, "width": "auto"}}, "f607a5890de64fd195135b169d72bba2": {"model_name": "ButtonStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "ButtonStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "button_color": "#aaffaa", "font_family": null, "font_size": "2em", "font_style": null, "font_variant": null, "font_weight": null, "text_color": null, "text_decoration": null}}, "33958ca4bf054424b4277e5bb1941ed8": {"model_name": "ButtonModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": ["happy"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "ButtonModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "ButtonView", "button_style": "", "description": "\ud83d\ude42", "disabled": false, "icon": "", "layout": "IPY_MODEL_9ec0e2f9825443c4b3c828821b986e84", "style": "IPY_MODEL_f607a5890de64fd195135b169d72bba2", "tabbable": null, "tooltip": "happy"}}, "8c2657ff8fab4834b4009a2833b515e7": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": "auto", "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": "0.5em", "right": null, "top": null, "visibility": null, "width": "auto"}}, "ae3f078154dc47feb44723abfd23c9ac": {"model_name": "ButtonStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "ButtonStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "button_color": "#dddd77", "font_family": null, "font_size": "2em", "font_style": null, "font_variant": null, "font_weight": null, "text_color": null, "text_decoration": null}}, "26331ade8a784388a18d55d79410848b": {"model_name": "ButtonModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": ["medium"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "ButtonModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "ButtonView", "button_style": "", "description": "\ud83d\ude10", "disabled": false, "icon": "", "layout": "IPY_MODEL_8c2657ff8fab4834b4009a2833b515e7", "style": "IPY_MODEL_ae3f078154dc47feb44723abfd23c9ac", "tabbable": null, "tooltip": "medium"}}, "742355180e28418d967e79bc153efc3a": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": "auto", "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": "0.5em", "right": null, "top": null, "visibility": null, "width": "auto"}}, "9909c57c9db54c3e9d6439484e78600c": {"model_name": "ButtonStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "ButtonStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "button_color": "#ffaaaa", "font_family": null, "font_size": "2em", "font_style": null, "font_variant": null, "font_weight": null, "text_color": null, "text_decoration": null}}, "ea278cb4c1b24a7497a874d09cf26a30": {"model_name": "ButtonModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": ["sad"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "ButtonModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "ButtonView", "button_style": "", "description": "\ud83d\ude41", "disabled": false, "icon": "", "layout": "IPY_MODEL_742355180e28418d967e79bc153efc3a", "style": "IPY_MODEL_9909c57c9db54c3e9d6439484e78600c", "tabbable": null, "tooltip": "sad"}}, "7b3a8dc2d0254ff7a90170ebc32cf4de": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": "auto", "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": "auto"}}, "40670a6a364049249efc99ef49a26bee": {"model_name": "TextStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "TextStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "background": null, "description_width": "", "font_size": null, "text_color": null}}, "f4707e92912744b998a71f7bf4846dbe": {"model_name": "TextareaModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "TextareaModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "TextareaView", "continuous_update": true, "description": "", "description_allow_html": false, "disabled": false, "layout": "IPY_MODEL_7b3a8dc2d0254ff7a90170ebc32cf4de", "placeholder": "We want your feedback!", "rows": null, "style": "IPY_MODEL_40670a6a364049249efc99ef49a26bee", "tabbable": null, "tooltip": null, "value": ""}}, "759fdde7f3814e778a27d582a5d89a6d": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": "auto", "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": "auto"}}, "88d2476419c943a58383089a94cac111": {"model_name": "ButtonStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "ButtonStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "button_color": null, "font_family": null, "font_size": null, "font_style": null, "font_variant": null, "font_weight": null, "text_color": null, "text_decoration": null}}, "3cd34cca1f0a4595959083fa317f1fc5": {"model_name": "ButtonModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "ButtonModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "ButtonView", "button_style": "", "description": "Submit", "disabled": false, "icon": "", "layout": "IPY_MODEL_759fdde7f3814e778a27d582a5d89a6d", "style": "IPY_MODEL_88d2476419c943a58383089a94cac111", "tabbable": null, "tooltip": null}}, "b770f620a61a40a69927e4bc6937a18e": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": "none", "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "7cf77697e9ae43b4b0ac296a03ed35e1": {"model_name": "HBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HBoxView", "box_style": "", "children": ["IPY_MODEL_f4707e92912744b998a71f7bf4846dbe", "IPY_MODEL_3cd34cca1f0a4595959083fa317f1fc5"], "layout": "IPY_MODEL_b770f620a61a40a69927e4bc6937a18e", "tabbable": null, "tooltip": null}}, "78fec6d007a54fce8fad6e79b633fe12": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": "none", "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "3f5529acd0814be58fbd82e193b65c54": {"model_name": "LabelStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "LabelStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "background": null, "description_width": "", "font_family": null, "font_size": null, "font_style": null, "font_variant": null, "font_weight": null, "text_color": null, "text_decoration": null}}, "f5af703738b84c26ba8b384d18daf323": {"model_name": "LabelModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "LabelModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "LabelView", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_78fec6d007a54fce8fad6e79b633fe12", "placeholder": "\u200b", "style": "IPY_MODEL_3f5529acd0814be58fbd82e193b65c54", "tabbable": null, "tooltip": null, "value": "Thanks for your feedback!"}}, "72976d41193b4145ba606e8c9288a4aa": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "34dd34f1c47449e0834c46ec8ed21e6a": {"model_name": "HBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HBoxView", "box_style": "", "children": ["IPY_MODEL_33958ca4bf054424b4277e5bb1941ed8", "IPY_MODEL_26331ade8a784388a18d55d79410848b", "IPY_MODEL_ea278cb4c1b24a7497a874d09cf26a30"], "layout": "IPY_MODEL_72976d41193b4145ba606e8c9288a4aa", "tabbable": null, "tooltip": null}}, "0f7e658f50e84e0da0028b20cc056eed": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "462d22228fcd416c86e04fb7787022bb": {"model_name": "VBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_34dd34f1c47449e0834c46ec8ed21e6a", "IPY_MODEL_7cf77697e9ae43b4b0ac296a03ed35e1", "IPY_MODEL_f5af703738b84c26ba8b384d18daf323"], "layout": "IPY_MODEL_0f7e658f50e84e0da0028b20cc056eed", "tabbable": null, "tooltip": null}}, "0b289f741519464eae739c54235e4beb": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "90f2e1a7971c4be997114cfa3a51f558": {"model_name": "VBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_462d22228fcd416c86e04fb7787022bb"], "layout": "IPY_MODEL_0b289f741519464eae739c54235e4beb", "tabbable": null, "tooltip": null}}, "6567e91a868c445699ffce1d58ad1610": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "5e3c21904e2649048cbd3f2efeef1e5b": {"model_name": "OutputModel", "model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_6567e91a868c445699ffce1d58ad1610", "msg_id": "", "outputs": [{"output_type": "stream", "name": "stdout", "text": "Video available at https://youtube.com/watch?v=buZLOKdf7Qw\n"}, {"output_type": "display_data", "metadata": {}, "data": {"text/plain": "<IPython.lib.display.YouTubeVideo at 0x7f22407be280>", "text/html": "\n        <iframe\n            width=\"730\"\n            height=\"410\"\n            src=\"https://www.youtube.com/embed/buZLOKdf7Qw?fs=1&rel=0\"\n            frameborder=\"0\"\n            allowfullscreen\n            \n        ></iframe>\n        ", "image/jpeg": "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"}}], "tabbable": null, "tooltip": null}}, "56367cb0585147c2b8773662cbad5a51": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "6ce0bbc4f7564cd19edff2728a9598dd": {"model_name": "OutputModel", "model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_56367cb0585147c2b8773662cbad5a51", "msg_id": "", "outputs": [{"output_type": "stream", "name": "stdout", "text": "Video available at https://www.bilibili.com/video/BV1CU4y1n7bV\n"}, {"output_type": "display_data", "metadata": {}, "data": {"text/plain": "<__main__.PlayVideo at 0x7f2175eeeb80>", "text/html": "\n        <iframe\n            width=\"730\"\n            height=\"410\"\n            src=\"https://player.bilibili.com/player.html?bvid=BV1CU4y1n7bV&page=1?fs=1&autoplay=False\"\n            frameborder=\"0\"\n            allowfullscreen\n            \n        ></iframe>\n        "}}], "tabbable": null, "tooltip": null}}, "396984e22e5f400a93673f6ccadb38e8": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "237f219474934a7a8dcb1016ef5cfc72": {"model_name": "TabModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "TabModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "TabView", "box_style": "", "children": ["IPY_MODEL_5e3c21904e2649048cbd3f2efeef1e5b", "IPY_MODEL_6ce0bbc4f7564cd19edff2728a9598dd"], "layout": "IPY_MODEL_396984e22e5f400a93673f6ccadb38e8", "selected_index": 0, "tabbable": null, "titles": ["Youtube", "Bilibili"], "tooltip": null}}, "b6670d35f898439c9aacdf6c0f05dfbd": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": "auto", "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": "0.5em", "right": null, "top": null, "visibility": null, "width": "auto"}}, "352a6ec43d5840619937989c39be9bc4": {"model_name": "ButtonStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "ButtonStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "button_color": "#aaffaa", "font_family": null, "font_size": "2em", "font_style": null, "font_variant": null, "font_weight": null, "text_color": null, "text_decoration": null}}, "6179254d6dff48b0a3c88ff10b9b8626": {"model_name": "ButtonModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": ["happy"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "ButtonModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "ButtonView", "button_style": "", "description": "\ud83d\ude42", "disabled": false, "icon": "", "layout": "IPY_MODEL_b6670d35f898439c9aacdf6c0f05dfbd", "style": "IPY_MODEL_352a6ec43d5840619937989c39be9bc4", "tabbable": null, "tooltip": "happy"}}, "26dd2a712cd64bbca2bfb3930c80f79e": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": "auto", "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": "0.5em", "right": null, "top": null, "visibility": null, "width": "auto"}}, "086796d82b5a408d8c454471dc24c2db": {"model_name": "ButtonStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "ButtonStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "button_color": "#dddd77", "font_family": null, "font_size": "2em", "font_style": null, "font_variant": null, "font_weight": null, "text_color": null, "text_decoration": null}}, "442b58bbd27940519425729570211f37": {"model_name": "ButtonModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": ["medium"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "ButtonModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "ButtonView", "button_style": "", "description": "\ud83d\ude10", "disabled": false, "icon": "", "layout": "IPY_MODEL_26dd2a712cd64bbca2bfb3930c80f79e", "style": "IPY_MODEL_086796d82b5a408d8c454471dc24c2db", "tabbable": null, "tooltip": "medium"}}, "6806f48bb1494245a7429c761eeef2c5": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": "auto", "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": "0.5em", "right": null, "top": null, "visibility": null, "width": "auto"}}, "127c9c4bf2cc42a883a40b46b3035b19": {"model_name": "ButtonStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "ButtonStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "button_color": "#ffaaaa", "font_family": null, "font_size": "2em", "font_style": null, "font_variant": null, "font_weight": null, "text_color": null, "text_decoration": null}}, "4ac672cb159e45d6aab72b99c27ea414": {"model_name": "ButtonModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": ["sad"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "ButtonModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "ButtonView", "button_style": "", "description": "\ud83d\ude41", "disabled": false, "icon": "", "layout": "IPY_MODEL_6806f48bb1494245a7429c761eeef2c5", "style": "IPY_MODEL_127c9c4bf2cc42a883a40b46b3035b19", "tabbable": null, "tooltip": "sad"}}, "2b9f7348633a49579c420c789152116f": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": "auto", "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": "auto"}}, "bbe1e60ba84744de8115850cc5db5932": {"model_name": "TextStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "TextStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "background": null, "description_width": "", "font_size": null, "text_color": null}}, "de50defbe5d04c9083df2b351e680440": {"model_name": "TextareaModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "TextareaModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "TextareaView", "continuous_update": true, "description": "", "description_allow_html": false, "disabled": false, "layout": "IPY_MODEL_2b9f7348633a49579c420c789152116f", "placeholder": "We want your feedback!", "rows": null, "style": "IPY_MODEL_bbe1e60ba84744de8115850cc5db5932", "tabbable": null, "tooltip": null, "value": ""}}, "4b7f03ce899f4672af1c74cf6ef41be6": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": "auto", "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": "auto"}}, "8b95d71f2204451ab0b89128b55b354e": {"model_name": "ButtonStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "ButtonStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "button_color": null, "font_family": null, "font_size": null, "font_style": null, "font_variant": null, "font_weight": null, "text_color": null, "text_decoration": null}}, "652a78c319074073a8b4c224f82041fc": {"model_name": "ButtonModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "ButtonModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "ButtonView", "button_style": "", "description": "Submit", "disabled": false, "icon": "", "layout": "IPY_MODEL_4b7f03ce899f4672af1c74cf6ef41be6", "style": "IPY_MODEL_8b95d71f2204451ab0b89128b55b354e", "tabbable": null, "tooltip": null}}, "dd7085ed209e4527aa14837ceed5081e": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": "none", "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "d5b73fac5a0942b0b1bcb6579fc65ac9": {"model_name": "HBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HBoxView", "box_style": "", "children": ["IPY_MODEL_de50defbe5d04c9083df2b351e680440", "IPY_MODEL_652a78c319074073a8b4c224f82041fc"], "layout": "IPY_MODEL_dd7085ed209e4527aa14837ceed5081e", "tabbable": null, "tooltip": null}}, "b69f20f5c0234371adc27f01d78f3891": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": "none", "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "f9331957ba5149cf92de4259bd011923": {"model_name": "LabelStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "LabelStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "background": null, "description_width": "", "font_family": null, "font_size": null, "font_style": null, "font_variant": null, "font_weight": null, "text_color": null, "text_decoration": null}}, "58101ce4f79d4feb94f2638b42a01c88": {"model_name": "LabelModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "LabelModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "LabelView", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_b69f20f5c0234371adc27f01d78f3891", "placeholder": "\u200b", "style": "IPY_MODEL_f9331957ba5149cf92de4259bd011923", "tabbable": null, "tooltip": null, "value": "Thanks for your feedback!"}}, "948a5ae275d045709a735f2e615dce13": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "bba2a684e2864f819193c00092c36fe1": {"model_name": "HBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HBoxView", "box_style": "", "children": ["IPY_MODEL_6179254d6dff48b0a3c88ff10b9b8626", "IPY_MODEL_442b58bbd27940519425729570211f37", "IPY_MODEL_4ac672cb159e45d6aab72b99c27ea414"], "layout": "IPY_MODEL_948a5ae275d045709a735f2e615dce13", "tabbable": null, "tooltip": null}}, "014bda3fc3754cc3bf2fce17e26584cd": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "485432dfa66547ea9d2130084bdd3dca": {"model_name": "VBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_bba2a684e2864f819193c00092c36fe1", "IPY_MODEL_d5b73fac5a0942b0b1bcb6579fc65ac9", "IPY_MODEL_58101ce4f79d4feb94f2638b42a01c88"], "layout": "IPY_MODEL_014bda3fc3754cc3bf2fce17e26584cd", "tabbable": null, "tooltip": null}}, "bf7b100811cf456ab8fdab1b87c38008": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "538584ff77a1462b8225a9234c1bab55": {"model_name": "VBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_485432dfa66547ea9d2130084bdd3dca"], "layout": "IPY_MODEL_bf7b100811cf456ab8fdab1b87c38008", "tabbable": null, "tooltip": null}}, "acfe93d410fc4d988fb224579ec4dc25": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "373d80332f4b4800ba33892e4ca0c35d": {"model_name": "OutputModel", "model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_acfe93d410fc4d988fb224579ec4dc25", "msg_id": "", "outputs": [{"output_type": "stream", "name": "stdout", "text": "Video available at https://youtube.com/watch?v=hJdV2L2t4-c\n"}, {"output_type": "display_data", "metadata": {}, "data": {"text/plain": "<IPython.lib.display.YouTubeVideo at 0x7f2175ef3070>", "text/html": "\n        <iframe\n            width=\"730\"\n            height=\"410\"\n            src=\"https://www.youtube.com/embed/hJdV2L2t4-c?fs=1&rel=0\"\n            frameborder=\"0\"\n            allowfullscreen\n            \n        ></iframe>\n        ", "image/jpeg": "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"}}], "tabbable": null, "tooltip": null}}, "d3066d9c5a5a4e6492d178771927a2bc": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "4f1f54cd7f244adeb4ea7e9c441adaa4": {"model_name": "OutputModel", "model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_d3066d9c5a5a4e6492d178771927a2bc", "msg_id": "", "outputs": [{"output_type": "stream", "name": "stdout", "text": "Video available at https://www.bilibili.com/video/BV1Y54y1E77J\n"}, {"output_type": "display_data", "metadata": {}, "data": {"text/plain": "<__main__.PlayVideo at 0x7f2175fcdeb0>", "text/html": "\n        <iframe\n            width=\"730\"\n            height=\"410\"\n            src=\"https://player.bilibili.com/player.html?bvid=BV1Y54y1E77J&page=1?fs=1&autoplay=False\"\n            frameborder=\"0\"\n            allowfullscreen\n            \n        ></iframe>\n        "}}], "tabbable": null, "tooltip": null}}, "f6a19f2637f847c999be0e2346572da2": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "3eb1f8d0a4ee48e48d775f83513af7d3": {"model_name": "TabModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "TabModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "TabView", "box_style": "", "children": ["IPY_MODEL_373d80332f4b4800ba33892e4ca0c35d", "IPY_MODEL_4f1f54cd7f244adeb4ea7e9c441adaa4"], "layout": "IPY_MODEL_f6a19f2637f847c999be0e2346572da2", "selected_index": 0, "tabbable": null, "titles": ["Youtube", "Bilibili"], "tooltip": null}}, "dc2f9052b6e84b81968f26d89a60ca81": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": "auto", "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": "0.5em", "right": null, "top": null, "visibility": null, "width": "auto"}}, "7ca9475f5d0b417ba4ff6b61deb346dc": {"model_name": "ButtonStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "ButtonStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "button_color": "#aaffaa", "font_family": null, "font_size": "2em", "font_style": null, "font_variant": null, "font_weight": null, "text_color": null, "text_decoration": null}}, "2e01a29b30ee4d86b1d57b37b2cda0be": {"model_name": "ButtonModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": ["happy"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "ButtonModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "ButtonView", "button_style": "", "description": "\ud83d\ude42", "disabled": false, "icon": "", "layout": "IPY_MODEL_dc2f9052b6e84b81968f26d89a60ca81", "style": "IPY_MODEL_7ca9475f5d0b417ba4ff6b61deb346dc", "tabbable": null, "tooltip": "happy"}}, "b42bcf09f146449398c963dc46395ea6": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": "auto", "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": "0.5em", "right": null, "top": null, "visibility": null, "width": "auto"}}, "839493d40aa34adba8343ea5b11b453e": {"model_name": "ButtonStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "ButtonStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "button_color": "#dddd77", "font_family": null, "font_size": "2em", "font_style": null, "font_variant": null, "font_weight": null, "text_color": null, "text_decoration": null}}, "f7986b69729e474a8f9e2639c4cd7440": {"model_name": "ButtonModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": ["medium"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "ButtonModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "ButtonView", "button_style": "", "description": "\ud83d\ude10", "disabled": false, "icon": "", "layout": "IPY_MODEL_b42bcf09f146449398c963dc46395ea6", "style": "IPY_MODEL_839493d40aa34adba8343ea5b11b453e", "tabbable": null, "tooltip": "medium"}}, "ade11b9bc41045c4b7b7a770b3d743eb": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": "auto", "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": "0.5em", "right": null, "top": null, "visibility": null, "width": "auto"}}, "63e7fc48954a4e38ada0223f51ea43ef": {"model_name": "ButtonStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "ButtonStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "button_color": "#ffaaaa", "font_family": null, "font_size": "2em", "font_style": null, "font_variant": null, "font_weight": null, "text_color": null, "text_decoration": null}}, "4c476f12adc34dfa8681ff980a1d06a6": {"model_name": "ButtonModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": ["sad"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "ButtonModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "ButtonView", "button_style": "", "description": "\ud83d\ude41", "disabled": false, "icon": "", "layout": "IPY_MODEL_ade11b9bc41045c4b7b7a770b3d743eb", "style": "IPY_MODEL_63e7fc48954a4e38ada0223f51ea43ef", "tabbable": null, "tooltip": "sad"}}, "850fe9b5fb5744df92aff60dfeff4cdd": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": "auto", "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": "auto"}}, "2e0b9e1aa37f4ba6b0ee9af222381184": {"model_name": "TextStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "TextStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "background": null, "description_width": "", "font_size": null, "text_color": null}}, "92968842598c40e381dfe1bd52b38933": {"model_name": "TextareaModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "TextareaModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "TextareaView", "continuous_update": true, "description": "", "description_allow_html": false, "disabled": false, "layout": "IPY_MODEL_850fe9b5fb5744df92aff60dfeff4cdd", "placeholder": "We want your feedback!", "rows": null, "style": "IPY_MODEL_2e0b9e1aa37f4ba6b0ee9af222381184", "tabbable": null, "tooltip": null, "value": ""}}, "236f7139f7fe4c17be8aa3ea04e06fc6": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": "auto", "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": "auto"}}, "0040e9c777db46cdadbdf7645aad1403": {"model_name": "ButtonStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "ButtonStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "button_color": null, "font_family": null, "font_size": null, "font_style": null, "font_variant": null, "font_weight": null, "text_color": null, "text_decoration": null}}, "0ed70a5d2ae4485e95032ef8aebe7630": {"model_name": "ButtonModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "ButtonModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "ButtonView", "button_style": "", "description": "Submit", "disabled": false, "icon": "", "layout": "IPY_MODEL_236f7139f7fe4c17be8aa3ea04e06fc6", "style": "IPY_MODEL_0040e9c777db46cdadbdf7645aad1403", "tabbable": null, "tooltip": null}}, "324ffec9e89d446894a01a4e27618bd7": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": "none", "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "0c523030debe4d14a9d1d22680577081": {"model_name": "HBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HBoxView", "box_style": "", "children": ["IPY_MODEL_92968842598c40e381dfe1bd52b38933", "IPY_MODEL_0ed70a5d2ae4485e95032ef8aebe7630"], "layout": "IPY_MODEL_324ffec9e89d446894a01a4e27618bd7", "tabbable": null, "tooltip": null}}, "2a361664ca0241d0af317c34c84efc70": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": "none", "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "f5c3b659d209469f9c76947fe86337df": {"model_name": "LabelStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "LabelStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "background": null, "description_width": "", "font_family": null, "font_size": null, "font_style": null, "font_variant": null, "font_weight": null, "text_color": null, "text_decoration": null}}, "5c5b7fc5a7124fc3a7c71fda96152b4d": {"model_name": "LabelModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "LabelModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "LabelView", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_2a361664ca0241d0af317c34c84efc70", "placeholder": "\u200b", "style": "IPY_MODEL_f5c3b659d209469f9c76947fe86337df", "tabbable": null, "tooltip": null, "value": "Thanks for your feedback!"}}, "2d1f04c0aef343ed97372fbe27983223": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "ec534a3c651048fb88374f7469021c6f": {"model_name": "HBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HBoxView", "box_style": "", "children": ["IPY_MODEL_2e01a29b30ee4d86b1d57b37b2cda0be", "IPY_MODEL_f7986b69729e474a8f9e2639c4cd7440", "IPY_MODEL_4c476f12adc34dfa8681ff980a1d06a6"], "layout": "IPY_MODEL_2d1f04c0aef343ed97372fbe27983223", "tabbable": null, "tooltip": null}}, "15e3fab4a5af42d39ba93ece2c92319a": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "f5158120209148c2901f98dacbf0f239": {"model_name": "VBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_ec534a3c651048fb88374f7469021c6f", "IPY_MODEL_0c523030debe4d14a9d1d22680577081", "IPY_MODEL_5c5b7fc5a7124fc3a7c71fda96152b4d"], "layout": "IPY_MODEL_15e3fab4a5af42d39ba93ece2c92319a", "tabbable": null, "tooltip": null}}, "7107c69a71494d6aafd1a5a5c8208ca9": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "6a752988ac804ea2acf54504e97102df": {"model_name": "VBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_f5158120209148c2901f98dacbf0f239"], "layout": "IPY_MODEL_7107c69a71494d6aafd1a5a5c8208ca9", "tabbable": null, "tooltip": null}}, "901068560b1d40d4a106cc2c591a0031": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": "auto", "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": "0.5em", "right": null, "top": null, "visibility": null, "width": "auto"}}, "4e022dbc82d7493faca7e8a0c054b7c3": {"model_name": "ButtonStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "ButtonStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "button_color": "#aaffaa", "font_family": null, "font_size": "2em", "font_style": null, "font_variant": null, "font_weight": null, "text_color": null, "text_decoration": null}}, "9d104a869a93496790b1b2f0fe162346": {"model_name": "ButtonModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": ["happy"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "ButtonModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "ButtonView", "button_style": "", "description": "\ud83d\ude42", "disabled": false, "icon": "", "layout": "IPY_MODEL_901068560b1d40d4a106cc2c591a0031", "style": "IPY_MODEL_4e022dbc82d7493faca7e8a0c054b7c3", "tabbable": null, "tooltip": "happy"}}, "1f1db84c14a149b3aaafa93114d70c79": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": "auto", "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": "0.5em", "right": null, "top": null, "visibility": null, "width": "auto"}}, "4d91321fd68b48b3aab006daca968dad": {"model_name": "ButtonStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "ButtonStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "button_color": "#dddd77", "font_family": null, "font_size": "2em", "font_style": null, "font_variant": null, "font_weight": null, "text_color": null, "text_decoration": null}}, "9832586051484ce587c4f380817bbdb2": {"model_name": "ButtonModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": ["medium"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "ButtonModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "ButtonView", "button_style": "", "description": "\ud83d\ude10", "disabled": false, "icon": "", "layout": "IPY_MODEL_1f1db84c14a149b3aaafa93114d70c79", "style": "IPY_MODEL_4d91321fd68b48b3aab006daca968dad", "tabbable": null, "tooltip": "medium"}}, "4bea8e74e1b94a67aeb41fe7ad8c51ae": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": "auto", "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": "0.5em", "right": null, "top": null, "visibility": null, "width": "auto"}}, "e89a3decc6a74414b7e42a0615bd7290": {"model_name": "ButtonStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "ButtonStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "button_color": "#ffaaaa", "font_family": null, "font_size": "2em", "font_style": null, "font_variant": null, "font_weight": null, "text_color": null, "text_decoration": null}}, "b20a5b9101a743ca8d1fa0c98b199484": {"model_name": "ButtonModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": ["sad"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "ButtonModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "ButtonView", "button_style": "", "description": "\ud83d\ude41", "disabled": false, "icon": "", "layout": "IPY_MODEL_4bea8e74e1b94a67aeb41fe7ad8c51ae", "style": "IPY_MODEL_e89a3decc6a74414b7e42a0615bd7290", "tabbable": null, "tooltip": "sad"}}, "599812327b7b4aeeb004ae2829c6969c": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": "auto", "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": "auto"}}, "64ed5f400f9f40c1a9cdc6ecbb324340": {"model_name": "TextStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "TextStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "background": null, "description_width": "", "font_size": null, "text_color": null}}, "29a8d15ab2b84c8f80e5b8c741f1b9a1": {"model_name": "TextareaModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "TextareaModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "TextareaView", "continuous_update": true, "description": "", "description_allow_html": false, "disabled": false, "layout": "IPY_MODEL_599812327b7b4aeeb004ae2829c6969c", "placeholder": "We want your feedback!", "rows": null, "style": "IPY_MODEL_64ed5f400f9f40c1a9cdc6ecbb324340", "tabbable": null, "tooltip": null, "value": ""}}, "ef427074fa164c12880e6651432f71af": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": "auto", "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": "auto"}}, "9ec395345f2749ec9fce73a2f7b5315c": {"model_name": "ButtonStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "ButtonStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "button_color": null, "font_family": null, "font_size": null, "font_style": null, "font_variant": null, "font_weight": null, "text_color": null, "text_decoration": null}}, "52e317aa2239496a9f072757ebf3c266": {"model_name": "ButtonModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "ButtonModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "ButtonView", "button_style": "", "description": "Submit", "disabled": false, "icon": "", "layout": "IPY_MODEL_ef427074fa164c12880e6651432f71af", "style": "IPY_MODEL_9ec395345f2749ec9fce73a2f7b5315c", "tabbable": null, "tooltip": null}}, "d7c69e0f430a44beb4204bc71fef5bc3": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": "none", "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "8771537636824c5b9531406b66408315": {"model_name": "HBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HBoxView", "box_style": "", "children": ["IPY_MODEL_29a8d15ab2b84c8f80e5b8c741f1b9a1", "IPY_MODEL_52e317aa2239496a9f072757ebf3c266"], "layout": "IPY_MODEL_d7c69e0f430a44beb4204bc71fef5bc3", "tabbable": null, "tooltip": null}}, "70c4b1a316274fbbb2da9ea4ac42f9b0": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": "none", "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "dd545aaad4fe48c799f73cd4da7e584c": {"model_name": "LabelStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "LabelStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "background": null, "description_width": "", "font_family": null, "font_size": null, "font_style": null, "font_variant": null, "font_weight": null, "text_color": null, "text_decoration": null}}, "b76b37de7b474d568473c80f9fdf797f": {"model_name": "LabelModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "LabelModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "LabelView", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_70c4b1a316274fbbb2da9ea4ac42f9b0", "placeholder": "\u200b", "style": "IPY_MODEL_dd545aaad4fe48c799f73cd4da7e584c", "tabbable": null, "tooltip": null, "value": "Thanks for your feedback!"}}, "62f3af23e4e94b1492ce698eb43caafa": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "be2413642c6c401aa1e7c4deae56179f": {"model_name": "HBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HBoxView", "box_style": "", "children": ["IPY_MODEL_9d104a869a93496790b1b2f0fe162346", "IPY_MODEL_9832586051484ce587c4f380817bbdb2", "IPY_MODEL_b20a5b9101a743ca8d1fa0c98b199484"], "layout": "IPY_MODEL_62f3af23e4e94b1492ce698eb43caafa", "tabbable": null, "tooltip": null}}, "a01fe2d859184735815194d94f2dd8cf": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "1c76224522624ad59b6bb89bbaf8138f": {"model_name": "VBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_be2413642c6c401aa1e7c4deae56179f", "IPY_MODEL_8771537636824c5b9531406b66408315", "IPY_MODEL_b76b37de7b474d568473c80f9fdf797f"], "layout": "IPY_MODEL_a01fe2d859184735815194d94f2dd8cf", "tabbable": null, "tooltip": null}}, "43384674919140828d87cf7e866771b5": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "0198291eeed94fbcbfadfc0346cc86c0": {"model_name": "VBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_1c76224522624ad59b6bb89bbaf8138f"], "layout": "IPY_MODEL_43384674919140828d87cf7e866771b5", "tabbable": null, "tooltip": null}}, "aaf5fad3925446af8c6dc117d5eaf9bf": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": "auto", "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": "0.5em", "right": null, "top": null, "visibility": null, "width": "auto"}}, "7af00ca9983a460cb70c2b7585eda627": {"model_name": "ButtonStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "ButtonStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "button_color": "#aaffaa", "font_family": null, "font_size": "2em", "font_style": null, "font_variant": null, "font_weight": null, "text_color": null, "text_decoration": null}}, "cc66c20eb4694ab796d67de68b4c5589": {"model_name": "ButtonModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": ["happy"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "ButtonModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "ButtonView", "button_style": "", "description": "\ud83d\ude42", "disabled": false, "icon": "", "layout": "IPY_MODEL_aaf5fad3925446af8c6dc117d5eaf9bf", "style": "IPY_MODEL_7af00ca9983a460cb70c2b7585eda627", "tabbable": null, "tooltip": "happy"}}, "eae4b817c42e4b6fa4d8765f9c8aa96c": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": "auto", "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": "0.5em", "right": null, "top": null, "visibility": null, "width": "auto"}}, "f1c7fd156f004e359de68e07d514dd22": {"model_name": "ButtonStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "ButtonStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "button_color": "#dddd77", "font_family": null, "font_size": "2em", "font_style": null, "font_variant": null, "font_weight": null, "text_color": null, "text_decoration": null}}, "48414236c8474ba4ab08437b201e3f2d": {"model_name": "ButtonModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": ["medium"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "ButtonModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "ButtonView", "button_style": "", "description": "\ud83d\ude10", "disabled": false, "icon": "", "layout": "IPY_MODEL_eae4b817c42e4b6fa4d8765f9c8aa96c", "style": "IPY_MODEL_f1c7fd156f004e359de68e07d514dd22", "tabbable": null, "tooltip": "medium"}}, "069a152a38cd4ceeb49872f6d5cd7680": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": "auto", "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": "0.5em", "right": null, "top": null, "visibility": null, "width": "auto"}}, "aaeaa9b13069435a96b8a71d0a73610c": {"model_name": "ButtonStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "ButtonStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "button_color": "#ffaaaa", "font_family": null, "font_size": "2em", "font_style": null, "font_variant": null, "font_weight": null, "text_color": null, "text_decoration": null}}, "6c96a7ad384f45a3bced0a6922c29734": {"model_name": "ButtonModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": ["sad"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "ButtonModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "ButtonView", "button_style": "", "description": "\ud83d\ude41", "disabled": false, "icon": "", "layout": "IPY_MODEL_069a152a38cd4ceeb49872f6d5cd7680", "style": "IPY_MODEL_aaeaa9b13069435a96b8a71d0a73610c", "tabbable": null, "tooltip": "sad"}}, "216ca0d7733a40afb5424b1a24c475cf": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": "auto", "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": "auto"}}, "df74a573a72d4bfbaad468e156563d8d": {"model_name": "TextStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "TextStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "background": null, "description_width": "", "font_size": null, "text_color": null}}, "6dce3f45575b40babff8cc0ad089a71f": {"model_name": "TextareaModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "TextareaModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "TextareaView", "continuous_update": true, "description": "", "description_allow_html": false, "disabled": false, "layout": "IPY_MODEL_216ca0d7733a40afb5424b1a24c475cf", "placeholder": "We want your feedback!", "rows": null, "style": "IPY_MODEL_df74a573a72d4bfbaad468e156563d8d", "tabbable": null, "tooltip": null, "value": ""}}, "8d624061e26a4f83b12bd7e48f6b95ca": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": "auto", "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": "auto"}}, "8f7f48d4b9fa4a8fbb97a29efa03d504": {"model_name": "ButtonStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "ButtonStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "button_color": null, "font_family": null, "font_size": null, "font_style": null, "font_variant": null, "font_weight": null, "text_color": null, "text_decoration": null}}, "c8b72f4f26614e6db53253b01f6002b7": {"model_name": "ButtonModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "ButtonModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "ButtonView", "button_style": "", "description": "Submit", "disabled": false, "icon": "", "layout": "IPY_MODEL_8d624061e26a4f83b12bd7e48f6b95ca", "style": "IPY_MODEL_8f7f48d4b9fa4a8fbb97a29efa03d504", "tabbable": null, "tooltip": null}}, "bc31574e83f04f1187cacc3d828753fd": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": "none", "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "dbb9d402d1cc4b58a40a18ed96ca99a4": {"model_name": "HBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HBoxView", "box_style": "", "children": ["IPY_MODEL_6dce3f45575b40babff8cc0ad089a71f", "IPY_MODEL_c8b72f4f26614e6db53253b01f6002b7"], "layout": "IPY_MODEL_bc31574e83f04f1187cacc3d828753fd", "tabbable": null, "tooltip": null}}, "016b1504d7be43f2b2f3a96ef6dec5cd": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": "none", "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "e069366fe4fe444eb5f8dbc817fb3819": {"model_name": "LabelStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "LabelStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "background": null, "description_width": "", "font_family": null, "font_size": null, "font_style": null, "font_variant": null, "font_weight": null, "text_color": null, "text_decoration": null}}, "645ca7a920a1467181e78839a219cb7b": {"model_name": "LabelModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "LabelModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "LabelView", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_016b1504d7be43f2b2f3a96ef6dec5cd", "placeholder": "\u200b", "style": "IPY_MODEL_e069366fe4fe444eb5f8dbc817fb3819", "tabbable": null, "tooltip": null, "value": "Thanks for your feedback!"}}, "4a127bcfb1db43ffa526a3cb0566057b": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "e2286b9488ba4d468cea612d4a5f9fdb": {"model_name": "HBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HBoxView", "box_style": "", "children": ["IPY_MODEL_cc66c20eb4694ab796d67de68b4c5589", "IPY_MODEL_48414236c8474ba4ab08437b201e3f2d", "IPY_MODEL_6c96a7ad384f45a3bced0a6922c29734"], "layout": "IPY_MODEL_4a127bcfb1db43ffa526a3cb0566057b", "tabbable": null, "tooltip": null}}, "0264c0c1627e4bb59296965fcb9d53af": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "dd132ecaa5494383944c5afbdf8729be": {"model_name": "VBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_e2286b9488ba4d468cea612d4a5f9fdb", "IPY_MODEL_dbb9d402d1cc4b58a40a18ed96ca99a4", "IPY_MODEL_645ca7a920a1467181e78839a219cb7b"], "layout": "IPY_MODEL_0264c0c1627e4bb59296965fcb9d53af", "tabbable": null, "tooltip": null}}, "db425824c667495791d5acd067b15f9c": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "d34cb364a0da4bd3a361564a6fec4719": {"model_name": "VBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_dd132ecaa5494383944c5afbdf8729be"], "layout": "IPY_MODEL_db425824c667495791d5acd067b15f9c", "tabbable": null, "tooltip": null}}}, "version_major": 2, "version_minor": 0}</script>
<script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
<script crossorigin="anonymous" data-jupyter-widgets-cdn="https://cdn.jsdelivr.net/npm/" src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@1.0.6/dist/embed-amd.js"></script>
<script>DOCUMENTATION_OPTIONS.pagename = 'tutorials/W2D5_AttentionAndTransformers/student/W2D5_Tutorial2';</script>
<link href="../../../_static/nma-dl-logo-square-4xp.png" rel="shortcut icon">
<link href="../../../genindex.html" rel="index" title="Index">
<link href="../../../search.html" rel="search" title="Search"/>
<link href="../../W3D1_TimeSeriesAndNaturalLanguageProcessing/chapter_title.html" rel="next" title="Time Series And Natural Language Processing"/>
<link href="W2D5_Tutorial1.html" rel="prev" title="Tutorial 1: Learn how to work with Transformers"/>
<meta content="width=device-width, initial-scale=1" name="viewport"/>
<meta content="en" name="docsearch:language"/>
</link></link></link></link></link></link></link></link></link></head>
<body data-default-mode="" data-offset="180" data-spy="scroll" data-target="#bd-toc-nav">
<a class="skip-link" href="#main-content">Skip to main content</a>
<input class="sidebar-toggle" id="__primary" name="__primary" type="checkbox"/>
<label class="overlay overlay-primary" for="__primary"></label>
<input class="sidebar-toggle" id="__secondary" name="__secondary" type="checkbox"/>
<label class="overlay overlay-secondary" for="__secondary"></label>
<div class="search-button__wrapper">
<div class="search-button__overlay"></div>
<div class="search-button__search-container">
<form action="../../../search.html" class="bd-search d-flex align-items-center" method="get">
<i class="fa-solid fa-magnifying-glass"></i>
<input aria-label="Search this book..." autocapitalize="off" autocomplete="off" autocorrect="off" class="form-control" id="search-input" name="q" placeholder="Search this book..." spellcheck="false" type="search"/>
<span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
</div>
</div>
<nav class="bd-header navbar navbar-expand-lg bd-navbar" id="navbar-main"><div class="bd-header__inner bd-page-width">
<label class="sidebar-toggle primary-toggle" for="__primary">
<span class="fa-solid fa-bars"></span>
</label>
<div id="navbar-start">
<a class="navbar-brand logo" href="../../intro.html">
<img alt="Logo image" class="logo__image only-light" src="../../../_static/nma-dl-logo-square-4xp.png"/>
<img alt="Logo image" class="logo__image only-dark" src="../../../_static/nma-dl-logo-square-4xp.png"/>
</a>
</div>
<div class="col-lg-9 navbar-header-items">
<div class="mr-auto" id="navbar-center">
<div class="navbar-center-item">
<nav class="navbar-nav">
<p aria-label="Site Navigation" aria-level="1" class="sidebar-header-items__title" role="heading">
        Site Navigation
    </p>
<ul class="navbar-nav" id="navbar-main-elements">
<li class="nav-item">
<a class="nav-link nav-internal" href="../../Schedule/schedule_intro.html">
                        Schedule
                      </a>
</li>
<li class="nav-item">
<a class="nav-link nav-internal" href="../../TechnicalHelp/tech_intro.html">
                        Technical Help
                      </a>
</li>
<li class="nav-item">
<a class="nav-link nav-internal" href="../../TechnicalHelp/Links_Policy.html">
                        Quick links and policies
                      </a>
</li>
<li class="nav-item">
<a class="nav-link nav-internal" href="../../../prereqs/DeepLearning.html">
                        Prerequisites and preparatory materials for NMA Deep Learning
                      </a>
</li>
<li class="nav-item">
<a class="nav-link nav-internal" href="../../W1D1_BasicsAndPytorch/chapter_title.html">
                        Basics And Pytorch (W1D1)
                      </a>
</li>
<div class="nav-item dropdown">
<button aria-expanded="false" aria-haspopup="true" class="btn dropdown-toggle nav-item" data-toggle="dropdown" type="button">
                    More
                </button>
<div class="dropdown-menu">
<li class="nav-item">
<a class="nav-link nav-internal" href="../../W1D2_LinearDeepLearning/chapter_title.html">
                        Linear Deep Learning (W1D2)
                      </a>
</li>
<li class="nav-item">
<a class="nav-link nav-internal" href="../../W1D3_MultiLayerPerceptrons/chapter_title.html">
                        Multi Layer Perceptrons (W1D3)
                      </a>
</li>
<li class="nav-item">
<a class="nav-link nav-internal" href="../../W1D4_Optimization/chapter_title.html">
                        Optimization (W1D4)
                      </a>
</li>
<li class="nav-item">
<a class="nav-link nav-internal" href="../../W2D1_Regularization/chapter_title.html">
                        Regularization (W2D1)
                      </a>
</li>
<li class="nav-item">
<a class="nav-link nav-internal" href="../../Module_WrapUps/FineTuning.html">
                        Deep Learning: The Basics and Fine Tuning Wrap-up
                      </a>
</li>
<li class="nav-item">
<a class="nav-link nav-internal" href="../../W2D2_ConvnetsAndDlThinking/chapter_title.html">
                        Convnets And Dl Thinking (W2D2)
                      </a>
</li>
<li class="nav-item">
<a class="nav-link nav-internal" href="../../W2D3_ModernConvnets/chapter_title.html">
                        Modern Convnets (W2D3)
                      </a>
</li>
<li class="nav-item">
<a class="nav-link nav-internal" href="../../W2D4_GenerativeModels/chapter_title.html">
                        Generative Models (W2D4)
                      </a>
</li>
<li class="nav-item current active">
<a class="nav-link nav-internal" href="../chapter_title.html">
                        Attention And Transformers (W2D5)
                      </a>
</li>
<li class="nav-item">
<a class="nav-link nav-internal" href="../../W3D1_TimeSeriesAndNaturalLanguageProcessing/chapter_title.html">
                        Time Series And Natural Language Processing (W3D1)
                      </a>
</li>
<li class="nav-item">
<a class="nav-link nav-internal" href="../../W3D2_DlThinking2/chapter_title.html">
                        Dl Thinking2 (W3D2)
                      </a>
</li>
<li class="nav-item">
<a class="nav-link nav-internal" href="../../Module_WrapUps/NaturalLanguageProcessing.html">
                        Deep Learning: Convnets and NLP
                      </a>
</li>
<li class="nav-item">
<a class="nav-link nav-internal" href="../../W3D3_UnsupervisedAndSelfSupervisedLearning/chapter_title.html">
                        Unsupervised And Self Supervised Learning (W3D3)
                      </a>
</li>
<li class="nav-item">
<a class="nav-link nav-internal" href="../../W3D4_BasicReinforcementLearning/chapter_title.html">
                        Basic Reinforcement Learning (W3D4)
                      </a>
</li>
<li class="nav-item">
<a class="nav-link nav-internal" href="../../W3D5_ReinforcementLearningForGamesAndDlThinking3/chapter_title.html">
                        Reinforcement Learning For Games And Dl Thinking3 (W3D5)
                      </a>
</li>
<li class="nav-item">
<a class="nav-link nav-internal" href="../../Bonus_DeployModels/chapter_title.html">
                        Deploy Models (Bonus)
                      </a>
</li>
<li class="nav-item">
<a class="nav-link nav-internal" href="../../../projects/README.html">
                        Introduction
                      </a>
</li>
<li class="nav-item">
<a class="nav-link nav-internal" href="../../../projects/docs/project_guidance.html">
                        Daily guide for projects
                      </a>
</li>
<li class="nav-item">
<a class="nav-link nav-internal" href="../../../projects/modelingsteps/intro.html">
                        Modeling Step-by-Step Guide
                      </a>
</li>
<li class="nav-item">
<a class="nav-link nav-internal" href="../../../projects/docs/projects_overview.html">
                        Project Templates
                      </a>
</li>
<li class="nav-item">
<a class="nav-link nav-internal" href="../../../projects/docs/datasets_and_models.html">
                        Models and Data sets
                      </a>
</li>
</div>
</div>
</ul>
</nav>
</div>
</div>
<div id="navbar-end">
<div class="navbar-end-item navbar-persistent--container">
<button aria-label="Search" class="btn btn-sm navbar-btn search-button search-button__button" data-toggle="tooltip" title="Search">
<i class="fa-solid fa-magnifying-glass"></i>
</button>
</div>
<div class="navbar-end-item">
<button aria-label="light/dark" class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" data-toggle="tooltip" title="light/dark">
<span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
<span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
<span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
</button>
</div>
<div class="navbar-end-item">
<ul aria-label="Icon Links" class="navbar-nav" id="navbar-icon-links">
</ul>
</div>
</div>
</div>
<div class="navbar-persistent--mobile">
<button aria-label="Search" class="btn btn-sm navbar-btn search-button search-button__button" data-toggle="tooltip" title="Search">
<i class="fa-solid fa-magnifying-glass"></i>
</button>
</div>
<label class="sidebar-toggle secondary-toggle" for="__secondary">
<span class="fa-solid fa-outdent"></span>
</label>
</div>
</nav>
<div class="bd-container">
<div class="bd-container__inner bd-page-width">
<div class="bd-sidebar-primary bd-sidebar">
<div class="sidebar-header-items sidebar-primary__section">
<div class="sidebar-header-items__center">
<div class="navbar-center-item">
<nav class="navbar-nav">
<p aria-label="Site Navigation" aria-level="1" class="sidebar-header-items__title" role="heading">
        Site Navigation
    </p>
<ul class="navbar-nav" id="navbar-main-elements">
<li class="nav-item">
<a class="nav-link nav-internal" href="../../Schedule/schedule_intro.html">
                        Schedule
                      </a>
</li>
<li class="nav-item">
<a class="nav-link nav-internal" href="../../TechnicalHelp/tech_intro.html">
                        Technical Help
                      </a>
</li>
<li class="nav-item">
<a class="nav-link nav-internal" href="../../TechnicalHelp/Links_Policy.html">
                        Quick links and policies
                      </a>
</li>
<li class="nav-item">
<a class="nav-link nav-internal" href="../../../prereqs/DeepLearning.html">
                        Prerequisites and preparatory materials for NMA Deep Learning
                      </a>
</li>
<li class="nav-item">
<a class="nav-link nav-internal" href="../../W1D1_BasicsAndPytorch/chapter_title.html">
                        Basics And Pytorch (W1D1)
                      </a>
</li>
<div class="nav-item dropdown">
<button aria-expanded="false" aria-haspopup="true" class="btn dropdown-toggle nav-item" data-toggle="dropdown" type="button">
                    More
                </button>
<div class="dropdown-menu">
<li class="nav-item">
<a class="nav-link nav-internal" href="../../W1D2_LinearDeepLearning/chapter_title.html">
                        Linear Deep Learning (W1D2)
                      </a>
</li>
<li class="nav-item">
<a class="nav-link nav-internal" href="../../W1D3_MultiLayerPerceptrons/chapter_title.html">
                        Multi Layer Perceptrons (W1D3)
                      </a>
</li>
<li class="nav-item">
<a class="nav-link nav-internal" href="../../W1D4_Optimization/chapter_title.html">
                        Optimization (W1D4)
                      </a>
</li>
<li class="nav-item">
<a class="nav-link nav-internal" href="../../W2D1_Regularization/chapter_title.html">
                        Regularization (W2D1)
                      </a>
</li>
<li class="nav-item">
<a class="nav-link nav-internal" href="../../Module_WrapUps/FineTuning.html">
                        Deep Learning: The Basics and Fine Tuning Wrap-up
                      </a>
</li>
<li class="nav-item">
<a class="nav-link nav-internal" href="../../W2D2_ConvnetsAndDlThinking/chapter_title.html">
                        Convnets And Dl Thinking (W2D2)
                      </a>
</li>
<li class="nav-item">
<a class="nav-link nav-internal" href="../../W2D3_ModernConvnets/chapter_title.html">
                        Modern Convnets (W2D3)
                      </a>
</li>
<li class="nav-item">
<a class="nav-link nav-internal" href="../../W2D4_GenerativeModels/chapter_title.html">
                        Generative Models (W2D4)
                      </a>
</li>
<li class="nav-item current active">
<a class="nav-link nav-internal" href="../chapter_title.html">
                        Attention And Transformers (W2D5)
                      </a>
</li>
<li class="nav-item">
<a class="nav-link nav-internal" href="../../W3D1_TimeSeriesAndNaturalLanguageProcessing/chapter_title.html">
                        Time Series And Natural Language Processing (W3D1)
                      </a>
</li>
<li class="nav-item">
<a class="nav-link nav-internal" href="../../W3D2_DlThinking2/chapter_title.html">
                        Dl Thinking2 (W3D2)
                      </a>
</li>
<li class="nav-item">
<a class="nav-link nav-internal" href="../../Module_WrapUps/NaturalLanguageProcessing.html">
                        Deep Learning: Convnets and NLP
                      </a>
</li>
<li class="nav-item">
<a class="nav-link nav-internal" href="../../W3D3_UnsupervisedAndSelfSupervisedLearning/chapter_title.html">
                        Unsupervised And Self Supervised Learning (W3D3)
                      </a>
</li>
<li class="nav-item">
<a class="nav-link nav-internal" href="../../W3D4_BasicReinforcementLearning/chapter_title.html">
                        Basic Reinforcement Learning (W3D4)
                      </a>
</li>
<li class="nav-item">
<a class="nav-link nav-internal" href="../../W3D5_ReinforcementLearningForGamesAndDlThinking3/chapter_title.html">
                        Reinforcement Learning For Games And Dl Thinking3 (W3D5)
                      </a>
</li>
<li class="nav-item">
<a class="nav-link nav-internal" href="../../Bonus_DeployModels/chapter_title.html">
                        Deploy Models (Bonus)
                      </a>
</li>
<li class="nav-item">
<a class="nav-link nav-internal" href="../../../projects/README.html">
                        Introduction
                      </a>
</li>
<li class="nav-item">
<a class="nav-link nav-internal" href="../../../projects/docs/project_guidance.html">
                        Daily guide for projects
                      </a>
</li>
<li class="nav-item">
<a class="nav-link nav-internal" href="../../../projects/modelingsteps/intro.html">
                        Modeling Step-by-Step Guide
                      </a>
</li>
<li class="nav-item">
<a class="nav-link nav-internal" href="../../../projects/docs/projects_overview.html">
                        Project Templates
                      </a>
</li>
<li class="nav-item">
<a class="nav-link nav-internal" href="../../../projects/docs/datasets_and_models.html">
                        Models and Data sets
                      </a>
</li>
</div>
</div>
</ul>
</nav>
</div>
</div>
<div class="sidebar-header-items__end">
<div class="navbar-end-item">
<button aria-label="light/dark" class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" data-toggle="tooltip" title="light/dark">
<span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
<span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
<span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
</button>
</div>
<div class="navbar-end-item">
<ul aria-label="Icon Links" class="navbar-nav" id="navbar-icon-links">
</ul>
</div>
</div>
</div>
<div class="sidebar-start-items sidebar-primary__section">
<div class="sidebar-start-items__item">
<a class="navbar-brand logo" href="../../intro.html">
<img alt="Logo image" class="logo__image only-light" src="../../../_static/nma-dl-logo-square-4xp.png"/>
<img alt="Logo image" class="logo__image only-dark" src="../../../_static/nma-dl-logo-square-4xp.png"/>
</a>
</div>
<div class="sidebar-start-items__item">
<form action="../../../search.html" class="bd-search d-flex align-items-center" method="get">
<i class="fa-solid fa-magnifying-glass"></i>
<input aria-label="Search this book..." autocapitalize="off" autocomplete="off" autocorrect="off" class="form-control" id="search-input" name="q" placeholder="Search this book..." spellcheck="false" type="search"/>
<span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
</div>
<div class="sidebar-start-items__item"><nav aria-label="Main" class="bd-links" id="bd-docs-nav">
<div class="bd-toc-item navbar-nav active">
<ul class="nav bd-sidenav bd-sidenav__home-link">
<li class="toctree-l1">
<a class="reference internal" href="../../intro.html">
                    Introduction
                </a>
</li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Schedule/schedule_intro.html">Schedule</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../Schedule/daily_schedules.html">General schedule</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Schedule/shared_calendars.html">Shared calendars</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Schedule/timezone_widget.html">Timezone widget</a></li>
</ul>
</input></li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../TechnicalHelp/tech_intro.html">Technical Help</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../TechnicalHelp/Jupyterbook.html">Using jupyterbook</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../TechnicalHelp/Tutorial_colab.html">Using Google Colab</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../TechnicalHelp/Tutorial_kaggle.html">Using Kaggle</a></li>
</ul>
</input></li>
<li class="toctree-l2"><a class="reference internal" href="../../TechnicalHelp/Discord.html">Using Discord</a></li>
</ul>
</input></li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../TechnicalHelp/Links_Policy.html">Quick links and policies</a></li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../../prereqs/DeepLearning.html">Prerequisites and preparatory materials for NMA Deep Learning</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Basics Module</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../W1D1_BasicsAndPytorch/chapter_title.html">Basics And Pytorch (W1D1)</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"><label class="toctree-toggle" for="toctree-checkbox-4"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../W1D1_BasicsAndPytorch/student/W1D1_Tutorial1.html">Tutorial 1: PyTorch</a></li>
</ul>
</input></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../W1D2_LinearDeepLearning/chapter_title.html">Linear Deep Learning (W1D2)</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-5"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../W1D2_LinearDeepLearning/student/W1D2_Tutorial1.html">Tutorial 1: Gradient Descent and AutoGrad</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../W1D2_LinearDeepLearning/student/W1D2_Tutorial2.html">Tutorial 2: Learning Hyperparameters</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../W1D2_LinearDeepLearning/student/W1D2_Tutorial3.html">Tutorial 3: Deep linear neural networks</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../W1D2_LinearDeepLearning/student/W1D2_BonusLecture.html">Bonus Lecture: Yoshua Bengio</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../W1D3_MultiLayerPerceptrons/chapter_title.html">Multi Layer Perceptrons (W1D3)</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-6"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../W1D3_MultiLayerPerceptrons/student/W1D3_Tutorial1.html">Tutorial 1: Biological vs. Artificial Neural Networks</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../W1D3_MultiLayerPerceptrons/student/W1D3_Tutorial2.html">Tutorial 2: Deep MLPs</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Fine Tuning</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../W1D4_Optimization/chapter_title.html">Optimization (W1D4)</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-7"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../W1D4_Optimization/student/W1D4_Tutorial1.html">Tutorial 1: Optimization techniques</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../W2D1_Regularization/chapter_title.html">Regularization (W2D1)</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-8"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../W2D1_Regularization/student/W2D1_Tutorial1.html">Tutorial 1: Regularization techniques part 1</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../W2D1_Regularization/student/W2D1_Tutorial2.html">Tutorial 2: Regularization techniques part 2</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../Module_WrapUps/FineTuning.html">Deep Learning: The Basics and Fine Tuning Wrap-up</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">ConvNets and Generative Models</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../W2D2_ConvnetsAndDlThinking/chapter_title.html">Convnets And Dl Thinking (W2D2)</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-9"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../W2D2_ConvnetsAndDlThinking/student/W2D2_Tutorial1.html">Tutorial 1: Introduction to CNNs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../W2D2_ConvnetsAndDlThinking/student/W2D2_Tutorial2.html">Tutorial 2: Deep Learning Thinking 1: Cost Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../W2D2_ConvnetsAndDlThinking/student/W2D2_BonusLecture.html">Bonus Lecture: Kyunghyun Cho</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../W2D3_ModernConvnets/chapter_title.html">Modern Convnets (W2D3)</a><input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-10"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../W2D3_ModernConvnets/student/W2D3_Tutorial1.html">Tutorial 1: Learn how to use modern convnets</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../W2D3_ModernConvnets/student/W2D3_Tutorial2.html">Bonus Tutorial: Facial recognition using modern convnets</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../W2D4_GenerativeModels/chapter_title.html">Generative Models (W2D4)</a><input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-11"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../W2D4_GenerativeModels/student/W2D4_Tutorial1.html">Tutorial 1: Variational Autoencoders (VAEs)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../W2D4_GenerativeModels/student/W2D4_Tutorial2.html">Tutorial 2: Diffusion models</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../W2D4_GenerativeModels/student/W2D4_Tutorial3.html">Tutorial 3: Image, Conditional Diffusion and Beyond</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../W2D4_GenerativeModels/student/W2D4_BonusLecture.html">Bonus Lecture: Geoffrey Hinton</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Natural Language Processing</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../chapter_title.html">Attention And Transformers (W2D5)</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-12"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="W2D5_Tutorial1.html">Tutorial 1: Learn how to work with Transformers</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Bonus Tutorial: Understanding Pre-training, Fine-tuning and Robustness of Transformers</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../W3D1_TimeSeriesAndNaturalLanguageProcessing/chapter_title.html">Time Series And Natural Language Processing (W3D1)</a><input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-13"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../W3D1_TimeSeriesAndNaturalLanguageProcessing/student/W3D1_Tutorial1.html">Tutorial 1: Introduction to processing time series</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../W3D1_TimeSeriesAndNaturalLanguageProcessing/student/W3D1_Tutorial2.html">Tutorial 2: Natural Language Processing and LLMs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../W3D1_TimeSeriesAndNaturalLanguageProcessing/student/W3D1_Tutorial3.html">Bonus Tutorial: Multilingual Embeddings</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../W3D2_DlThinking2/chapter_title.html">Dl Thinking2 (W3D2)</a><input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-14"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../W3D2_DlThinking2/student/W3D2_Tutorial1.html">Tutorial 1: Deep Learning Thinking 2: Architectures and Multimodal DL thinking</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../Module_WrapUps/NaturalLanguageProcessing.html">Deep Learning: Convnets and NLP</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Unsupervised and Reinforcement Learning</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../W3D3_UnsupervisedAndSelfSupervisedLearning/chapter_title.html">Unsupervised And Self Supervised Learning (W3D3)</a><input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-15"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../W3D3_UnsupervisedAndSelfSupervisedLearning/student/W3D3_Tutorial1.html">Tutorial 1: Un/Self-supervised learning methods</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../W3D3_UnsupervisedAndSelfSupervisedLearning/student/W3D3_BonusLecture.html">Bonus Lecture: Melanie Mitchell</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../W3D4_BasicReinforcementLearning/chapter_title.html">Basic Reinforcement Learning (W3D4)</a><input class="toctree-checkbox" id="toctree-checkbox-16" name="toctree-checkbox-16" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-16"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../W3D4_BasicReinforcementLearning/student/W3D4_Tutorial1.html">Tutorial 1: Basic Reinforcement Learning</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../W3D4_BasicReinforcementLearning/student/W3D4_BonusLecture.html">Bonus Lecture: Chealsea Finn</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../W3D5_ReinforcementLearningForGamesAndDlThinking3/chapter_title.html">Reinforcement Learning For Games And Dl Thinking3 (W3D5)</a><input class="toctree-checkbox" id="toctree-checkbox-17" name="toctree-checkbox-17" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-17"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../W3D5_ReinforcementLearningForGamesAndDlThinking3/student/W3D5_Tutorial1.html">Tutorial 1: Reinforcement Learning For Games</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../W3D5_ReinforcementLearningForGamesAndDlThinking3/student/W3D5_Tutorial2.html">Tutorial 2: Deep Learning Thinking 3</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../W3D5_ReinforcementLearningForGamesAndDlThinking3/student/W3D5_Tutorial3.html">Bonus Tutorial: Planning with Monte Carlo Tree Search</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../W3D5_ReinforcementLearningForGamesAndDlThinking3/student/W3D5_BonusLecture.html">Bonus Lecture: Amita Kapoor</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Deploy Models on the Web</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Bonus_DeployModels/chapter_title.html">Deploy Models (Bonus)</a><input class="toctree-checkbox" id="toctree-checkbox-18" name="toctree-checkbox-18" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-18"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../Bonus_DeployModels/student/Bonus_Tutorial1.html">Bonus Tutorial: Deploying Neural Networks on the Web</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Project Booklet</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../../projects/README.html">Introduction to projects</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../projects/docs/project_guidance.html">Daily guide for projects</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../projects/modelingsteps/intro.html">Modeling Step-by-Step Guide</a><input class="toctree-checkbox" id="toctree-checkbox-19" name="toctree-checkbox-19" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-19"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../projects/modelingsteps/ModelingSteps_1through2_DL.html">Modeling Steps 1 - 2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../projects/modelingsteps/ModelingSteps_3through4_DL.html">Modeling Steps 3 - 4</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../projects/modelingsteps/ModelingSteps_5through6_DL.html">Modeling Steps 5 - 6</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../projects/modelingsteps/ModelingSteps_7through9_DL.html">Modeling Steps 7 - 9</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../projects/modelingsteps/ModelingSteps_10_DL.html">Modeling Steps 10</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../projects/modelingsteps/TrainIllusionDataProjectDL.html">Example Data Project: the Train Illusion</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../projects/modelingsteps/TrainIllusionModelingProjectDL.html">Example Model Project: the Train Illusion</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../projects/modelingsteps/Example_Deep_Learning_Project.html">Example Deep Learning Project</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../projects/docs/projects_overview.html">Project Templates</a><input class="toctree-checkbox" id="toctree-checkbox-20" name="toctree-checkbox-20" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-20"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../projects/ComputerVision/README.html">Computer Vision</a><input class="toctree-checkbox" id="toctree-checkbox-21" name="toctree-checkbox-21" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-21"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../projects/ComputerVision/slides.html">Slides</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../projects/ComputerVision/ideas_and_datasets.html">Ideas</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../projects/ComputerVision/em_synapses.html">Knowledge Extraction from a Convolutional Neural Network</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../projects/ComputerVision/spectrogram_analysis.html">Music classification and generation with spectrograms</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../projects/ComputerVision/screws.html">Something Screwy - image recognition, detection, and classification of screws</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../projects/ComputerVision/data_augmentation.html">Data Augmentation in image classification models</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../projects/ComputerVision/transfer_learning.html">Transfer Learning</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../projects/ReinforcementLearning/README.html">Reinforcement Learning</a><input class="toctree-checkbox" id="toctree-checkbox-22" name="toctree-checkbox-22" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-22"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../projects/ReinforcementLearning/slides.html">Slides</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../projects/ReinforcementLearning/ideas_and_datasets.html">Ideas</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../projects/ReinforcementLearning/robolympics.html">NMA Robolympics: Controlling robots using reinforcement learning</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../projects/ReinforcementLearning/lunar_lander.html">Performance Analysis of DQN Algorithm on the Lunar Lander task</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../projects/ReinforcementLearning/human_rl.html">Using RL to Model Cognitive Tasks</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../projects/NaturalLanguageProcessing/README.html">Natural Language Processing</a><input class="toctree-checkbox" id="toctree-checkbox-23" name="toctree-checkbox-23" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-23"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../projects/NaturalLanguageProcessing/slides.html">Slides</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../projects/NaturalLanguageProcessing/ideas_and_datasets.html">Ideas</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../projects/NaturalLanguageProcessing/sentiment_analysis.html">Twitter Sentiment Analysis</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../projects/NaturalLanguageProcessing/machine_translation.html">Machine Translation</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../projects/Neuroscience/README.html">Neuroscience</a><input class="toctree-checkbox" id="toctree-checkbox-24" name="toctree-checkbox-24" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-24"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../projects/Neuroscience/slides.html">Slides</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../projects/Neuroscience/ideas_and_datasets.html">Ideas</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../projects/Neuroscience/pose_estimation.html">Animal Pose Estimation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../projects/Neuroscience/cellular_segmentation.html">Segmentation and Denoising</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../projects/Neuroscience/algonauts_videos.html">Load algonauts videos</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../projects/Neuroscience/blurry_vision.html">Vision with Lost Glasses: Modelling how the brain deals with noisy input</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../projects/Neuroscience/finetuning_fmri.html">Moving beyond Labels: Finetuning CNNs on BOLD response</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../projects/Neuroscience/neuro_seq_to_seq.html">Focus on what matters: inferring low-dimensional dynamics from neural recordings</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../projects/docs/datasets_and_models.html">Models and Data sets</a></li>
</ul>
</div>
</nav>
</div>
</div>
<div class="sidebar-end-items sidebar-primary__section">
<div class="sidebar-end-items__item">
</div>
</div>
<div id="rtd-footer-container"></div>
</div>
<main class="bd-main" id="main-content">
<div class="sbt-scroll-pixel-helper"></div>
<div class="bd-content">
<div class="bd-article-container">
<div class="bd-header-article">
<div class="col py-1 d-flex header-article-main">
<div class="header-article__left">
<label class="sidebar-toggle primary-toggle btn btn-sm" data-placement="right" data-toggle="tooltip" for="__primary" title="Toggle primary sidebar">
<span class="fa-solid fa-bars"></span>
</label>
</div>
<div class="header-article__right">
<div class="dropdown dropdown-launch-buttons">
<button aria-expanded="false" aria-label="Launch interactive content" class="btn dropdown-toggle" data-bs-toggle="dropdown" type="button">
<i class="fas fa-rocket"></i>
</button>
<ul class="dropdown-menu">
</ul>
</div>
<button class="btn btn-sm" data-placement="bottom" data-toggle="tooltip" onclick="toggleFullScreen()" title="Fullscreen mode">
<span class="btn__icon-container">
<i class="fas fa-expand"></i>
</span>
</button>
<div class="dropdown dropdown-repository-buttons">
<button aria-expanded="false" aria-label="Source repositories" class="btn dropdown-toggle" data-bs-toggle="dropdown" type="button">
<i class="fab fa-github"></i>
</button>
<ul class="dropdown-menu">
<li><a class="btn btn-sm dropdown-item" data-placement="left" data-toggle="tooltip" href="https://github.com/NeuromatchAcademy/course-content-dl" target="_blank" title="Source repository">
<span class="btn__icon-container">
<i class="fab fa-github"></i>
</span>
<span class="btn__text-container">repository</span>
</a>

<li><a class="btn btn-sm dropdown-item" data-placement="left" data-toggle="tooltip" href="https://github.com/NeuromatchAcademy/course-content-dl/issues/new?title=Issue%20on%20page%20%2Ftutorials/W2D5_AttentionAndTransformers/student/W2D5_Tutorial2.html&amp;body=Your%20issue%20content%20here." target="_blank" title="Open an issue">
<span class="btn__icon-container">
<i class="fas fa-lightbulb"></i>
</span>
<span class="btn__text-container">open issue</span>
</a>

</li></li></ul>
</div>
<div class="dropdown dropdown-download-buttons">
<button aria-expanded="false" aria-label="Download this page" class="btn dropdown-toggle" data-bs-toggle="dropdown" type="button">
<i class="fas fa-download"></i>
</button>
<ul class="dropdown-menu">
<li><a class="btn btn-sm dropdown-item" data-placement="left" data-toggle="tooltip" href="../../../_sources/tutorials/W2D5_AttentionAndTransformers/student/W2D5_Tutorial2.ipynb" target="_blank" title="Download source file">
<span class="btn__icon-container">
<i class="fas fa-file"></i>
</span>
<span class="btn__text-container">.ipynb</span>
</a>

<li>
<button class="btn btn-sm dropdown-item" data-placement="left" data-toggle="tooltip" onclick="printPdf(this)" title="Print to PDF">
<span class="btn__icon-container">
<i class="fas fa-file-pdf"></i>
</span>
<span class="btn__text-container">.pdf</span>
</button>

</li></li></ul>
</div>
<label class="sidebar-toggle secondary-toggle btn btn-sm" data-placement="left" data-toggle="tooltip" for="__secondary" title="Toggle secondary sidebar">
<span class="fa-solid fa-list"></span>
</label>
</div>
</div>
</div>
<div class="onlyprint" id="jb-print-docs-body">
<h1>Bonus Tutorial: Understanding Pre-training, Fine-tuning and Robustness of Transformers</h1>
<!-- Table of contents -->
<div id="print-main-content">
<div id="jb-print-toc">
<div>
<h2> Contents </h2>
</div>
<nav aria-label="Page">
<ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#">
   Bonus Tutorial: Understanding Pre-training, Fine-tuning and Robustness of Transformers
  </a>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#tutorial-objectives">
   Tutorial Objectives
  </a>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#setup">
   Setup
  </a>
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#install-dependencies">
     Install dependencies
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#install-and-import-feedback-gadget">
     Install and import feedback gadget
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#set-environment-variables">
     Set environment variables
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#set-random-seed">
     Set random seed
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#set-device-gpu-or-cpu-execute-set-device">
     Set device (GPU or CPU). Execute
     <code class="docutils literal notranslate">
<span class="pre">
       set_device()
      </span>
</code>
</a>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#bonus-1-language-modeling-as-pre-training">
   Bonus 1: Language modeling as pre-training
  </a>
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#video-1-pre-training">
     Video 1: Pre-training
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#submit-your-feedback">
     Submit your feedback
    </a>
<ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#bonus-interactive-demo-1-gpt-2-for-sentiment-classification">
       Bonus Interactive Demo 1: GPT-2 for sentiment classification
      </a>
<ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#download-the-dataset-from-osf">
         Download the dataset from OSF
        </a>
</li>
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#load-the-dataset">
         Load the dataset
        </a>
</li>
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#bonus-1-1-load-yelp-reviews-dataset">
         Bonus 1.1: Load Yelp reviews dataset ⌛🤗
        </a>
</li>
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#bonus-1-2-setting-up-a-text-context">
         Bonus 1.2: Setting up a text context ✍️
        </a>
</li>
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#bonus-1-3-extending-the-review-with-pre-trained-models">
         Bonus 1.3: Extending the review with pre-trained models 🤖
        </a>
</li>
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#bonus-1-4-sentiment-binary-classification-with-likelihood-of-positive-and-negative-extensions-of-the-review">
         Bonus 1.4: Sentiment binary-classification with likelihood of positive and negative extensions of the review 👍👎
        </a>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#bonus-2-light-weight-fine-tuning">
   Bonus 2: Light-weight fine-tuning
  </a>
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#video-2-fine-tuning">
     Video 2: Fine-tuning
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#id1">
     Submit your feedback
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#bonus-2-1-data-processing">
     Bonus 2.1: Data Processing
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#bonus-2-2-model-loading">
     Bonus 2.2: Model Loading
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#bonus-2-3-fine-tuning">
     Bonus 2.3: Fine-tuning
    </a>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#bonus-3-model-robustness">
   Bonus 3: Model robustness
  </a>
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#video-3-robustness">
     Video 3: Robustness
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#id2">
     Submit your feedback
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#bonus-interactive-demo-3-break-the-model">
     Bonus Interactive Demo 3: Break the model
    </a>
<ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#bonus-3-1-load-an-original-review">
       Bonus 3.1: Load an original review
      </a>
</li>
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#id3">
       Submit your feedback
      </a>
</li>
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#helper-functions-to-avoid-textattack-issue">
       Helper functions to avoid
       <code class="docutils literal notranslate">
<span class="pre">
         textattack
        </span>
</code>
       issue
      </a>
</li>
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#bonus-3-2-augment-the-original-review">
       Bonus 3.2: Augment the original review
      </a>
</li>
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#bonus-3-3-check-model-predictions">
       Bonus 3.3: Check model predictions
      </a>
</li>
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#id4">
       Submit your feedback
      </a>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
</div>
</div>
</div>
<article class="bd-article" role="main">
<p><a href="https://colab.research.google.com/github/NeuromatchAcademy/course-content-dl/blob/main/tutorials/W2D5_AttentionAndTransformers/student/W2D5_Tutorial2.ipynb" target="_blank"><img alt="Open In Colab" src="https://colab.research.google.com/assets/colab-badge.svg"/></a>   <a href="https://kaggle.com/kernels/welcome?src=https://raw.githubusercontent.com/NeuromatchAcademy/course-content-dl/main/tutorials/W2D5_AttentionAndTransformers/student/W2D5_Tutorial2.ipynb" target="_blank"><img alt="Open in Kaggle" src="https://kaggle.com/static/images/open-in-kaggle.svg"/></a></p>
<section class="tex2jax_ignore mathjax_ignore" id="bonus-tutorial-understanding-pre-training-fine-tuning-and-robustness-of-transformers">
<h1>Bonus Tutorial: Understanding Pre-training, Fine-tuning and Robustness of Transformers<a class="headerlink" href="#bonus-tutorial-understanding-pre-training-fine-tuning-and-robustness-of-transformers" title="Permalink to this heading">#</a></h1>
<p><strong>Week 2, Day 5: Attention and Transformers</strong></p>
<p><strong>By Neuromatch Academy</strong></p>
<p><strong>Content creators:</strong> Bikram Khastgir, Rajaswa Patil, Egor Zverev, Kelson Shilling-Scrivo, Alish Dipani, He He</p>
<p><strong>Content reviewers:</strong> Ezekiel Williams, Melvin Selim Atay, Khalid Almubarak, Lily Cheng, Hadi Vafaei, Kelson Shilling-Scrivo</p>
<p><strong>Content editors:</strong> Gagana B, Anoop Kulkarni, Spiros Chavlis</p>
<p><strong>Production editors:</strong> Khalid Almubarak, Gagana B, Spiros Chavlis</p>
</section>
<hr class="docutils"/>
<section class="tex2jax_ignore mathjax_ignore" id="tutorial-objectives">
<h1>Tutorial Objectives<a class="headerlink" href="#tutorial-objectives" title="Permalink to this heading">#</a></h1>
<p>On finishing the tutorial, you will be able to:</p>
<ul class="simple">
<li><p>Write down the objective of language model pre-training</p></li>
<li><p>Understand the framework of pre-training then fine-tuning</p></li>
<li><p>Name three types of biases in pre-trained language models</p></li>
</ul>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"version_major": 2, "version_minor": 0, "model_id": "c5fe70288f6447dfbbd2871616b58181"}</script></div>
</div>
</section>
<hr class="docutils"/>
<section class="tex2jax_ignore mathjax_ignore" id="setup">
<h1>Setup<a class="headerlink" href="#setup" title="Permalink to this heading">#</a></h1>
<p>In this section, we will install, and import libraries, as well as helper functions needed for this tutorial.</p>
<section id="install-dependencies">
<h2>Install dependencies<a class="headerlink" href="#install-dependencies" title="Permalink to this heading">#</a></h2>
<p>There may be <em>errors</em> and/or <em>warnings</em> reported during the installation. However, they are to be ignored.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Install dependencies</span>
<span class="c1"># @markdown There may be *errors* and/or *warnings* reported during the installation. However, they are to be ignored.</span>
<span class="o">!</span>pip<span class="w"> </span>install<span class="w"> </span>-U<span class="w"> </span>transformers<span class="w"> </span>--quiet
<span class="o">!</span>pip<span class="w"> </span>install<span class="w"> </span>-U<span class="w"> </span>accelerate<span class="w"> </span>--quiet
<span class="o">!</span>pip<span class="w"> </span>install<span class="w"> </span>-U<span class="w"> </span>datasets<span class="w"> </span>--quiet
<span class="o">!</span>pip<span class="w"> </span>install<span class="w"> </span>-U<span class="w"> </span>evaluate<span class="w"> </span>--quiet
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="install-and-import-feedback-gadget">
<h2>Install and import feedback gadget<a class="headerlink" href="#install-and-import-feedback-gadget" title="Permalink to this heading">#</a></h2>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Install and import feedback gadget</span>

<span class="o">!</span>pip3<span class="w"> </span>install<span class="w"> </span>vibecheck<span class="w"> </span>datatops<span class="w"> </span>--quiet

<span class="kn">from</span><span class="w"> </span><span class="nn">vibecheck</span><span class="w"> </span><span class="kn">import</span> <span class="n">DatatopsContentReviewContainer</span>
<span class="k">def</span><span class="w"> </span><span class="nf">content_review</span><span class="p">(</span><span class="n">notebook_section</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">DatatopsContentReviewContainer</span><span class="p">(</span>
        <span class="s2">""</span><span class="p">,</span>  <span class="c1"># No text prompt</span>
        <span class="n">notebook_section</span><span class="p">,</span>
        <span class="p">{</span>
            <span class="s2">"url"</span><span class="p">:</span> <span class="s2">"https://pmyvdlilci.execute-api.us-east-1.amazonaws.com/klab"</span><span class="p">,</span>
            <span class="s2">"name"</span><span class="p">:</span> <span class="s2">"neuromatch_dl"</span><span class="p">,</span>
            <span class="s2">"user_key"</span><span class="p">:</span> <span class="s2">"f379rz8y"</span><span class="p">,</span>
        <span class="p">},</span>
    <span class="p">)</span><span class="o">.</span><span class="n">render</span><span class="p">()</span>


<span class="n">feedback_prefix</span> <span class="o">=</span> <span class="s2">"W2D5_T2_Bonus"</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="set-environment-variables">
<h2>Set environment variables<a class="headerlink" href="#set-environment-variables" title="Permalink to this heading">#</a></h2>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Set environment variables</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">'TA_CACHE_DIR'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'data/'</span>
<span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">'NLTK_DATA'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'nltk_data/'</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Imports</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">nltk</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">random</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">string</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">datasets</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">evaluate</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">pprint</span><span class="w"> </span><span class="kn">import</span> <span class="n">pprint</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">tqdm.notebook</span><span class="w"> </span><span class="kn">import</span> <span class="n">tqdm</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">abc</span><span class="w"> </span><span class="kn">import</span> <span class="n">ABC</span><span class="p">,</span> <span class="n">abstractmethod</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">nltk.corpus</span><span class="w"> </span><span class="kn">import</span> <span class="n">brown</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.manifold</span><span class="w"> </span><span class="kn">import</span> <span class="n">TSNE</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">torch.nn</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">nn</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">torch.nn.functional</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">F</span>

<span class="c1"># transformers library</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">transformers</span><span class="w"> </span><span class="kn">import</span> <span class="n">Trainer</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">transformers</span><span class="w"> </span><span class="kn">import</span> <span class="n">pipeline</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">transformers</span><span class="w"> </span><span class="kn">import</span> <span class="n">AutoTokenizer</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">transformers</span><span class="w"> </span><span class="kn">import</span> <span class="n">TrainingArguments</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">transformers</span><span class="w"> </span><span class="kn">import</span> <span class="n">AutoModelForCausalLM</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">transformers</span><span class="w"> </span><span class="kn">import</span> <span class="n">AutoModelForSequenceClassification</span>

<span class="o">%</span><span class="k">load_ext</span> tensorboard
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">ModuleNotFoundError</span><span class="g g-Whitespace">                       </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">5</span><span class="p">],</span> <span class="n">line</span> <span class="mi">3</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span> <span class="c1"># Imports</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="ne">----&gt; </span><span class="mi">3</span> <span class="kn">import</span><span class="w"> </span><span class="nn">nltk</span>
<span class="g g-Whitespace">      </span><span class="mi">4</span> <span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>
<span class="g g-Whitespace">      </span><span class="mi">5</span> <span class="kn">import</span><span class="w"> </span><span class="nn">random</span>

<span class="ne">ModuleNotFoundError</span>: No module named 'nltk'
</pre></div>
</div>
</div>
</div>
</section>
<section id="set-random-seed">
<h2>Set random seed<a class="headerlink" href="#set-random-seed" title="Permalink to this heading">#</a></h2>
<p>Executing <code class="docutils literal notranslate"><span class="pre">set_seed(seed=seed)</span></code> you are setting the seed</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Set random seed</span>

<span class="c1"># @markdown Executing `set_seed(seed=seed)` you are setting the seed</span>

<span class="c1"># for DL its critical to set the random seed so that students can have a</span>
<span class="c1"># baseline to compare their results to expected results.</span>
<span class="c1"># Read more here: https://pytorch.org/docs/stable/notes/randomness.html</span>

<span class="c1"># Call `set_seed` function in the exercises to ensure reproducibility.</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">random</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>

<span class="k">def</span><span class="w"> </span><span class="nf">set_seed</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">seed_torch</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">  </span><span class="sd">"""</span>
<span class="sd">  Handles variability by controlling sources of randomness</span>
<span class="sd">  through set seed values</span>

<span class="sd">  Args:</span>
<span class="sd">    seed: Integer</span>
<span class="sd">      Set the seed value to given integer.</span>
<span class="sd">      If no seed, set seed value to random integer in the range 2^32</span>
<span class="sd">    seed_torch: Bool</span>
<span class="sd">      Seeds the random number generator for all devices to</span>
<span class="sd">      offer some guarantees on reproducibility</span>

<span class="sd">  Returns:</span>
<span class="sd">    Nothing</span>
<span class="sd">  """</span>
  <span class="k">if</span> <span class="n">seed</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">seed</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="mi">2</span> <span class="o">**</span> <span class="mi">32</span><span class="p">)</span>
  <span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
  <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
  <span class="k">if</span> <span class="n">seed_torch</span><span class="p">:</span>
    <span class="n">torch</span><span class="o">.</span><span class="n">manual_seed</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
    <span class="n">torch</span><span class="o">.</span><span class="n">cuda</span><span class="o">.</span><span class="n">manual_seed_all</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
    <span class="n">torch</span><span class="o">.</span><span class="n">cuda</span><span class="o">.</span><span class="n">manual_seed</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
    <span class="n">torch</span><span class="o">.</span><span class="n">backends</span><span class="o">.</span><span class="n">cudnn</span><span class="o">.</span><span class="n">benchmark</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">torch</span><span class="o">.</span><span class="n">backends</span><span class="o">.</span><span class="n">cudnn</span><span class="o">.</span><span class="n">deterministic</span> <span class="o">=</span> <span class="kc">True</span>

  <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">'Random seed </span><span class="si">{</span><span class="n">seed</span><span class="si">}</span><span class="s1"> has been set.'</span><span class="p">)</span>


<span class="c1"># In case that `DataLoader` is used</span>
<span class="k">def</span><span class="w"> </span><span class="nf">seed_worker</span><span class="p">(</span><span class="n">worker_id</span><span class="p">):</span>
<span class="w">  </span><span class="sd">"""</span>
<span class="sd">  DataLoader will reseed workers following randomness in</span>
<span class="sd">  multi-process data loading algorithm.</span>

<span class="sd">  Args:</span>
<span class="sd">    worker_id: integer</span>
<span class="sd">      ID of subprocess to seed. 0 means that</span>
<span class="sd">      the data will be loaded in the main process</span>
<span class="sd">      Refer: https://pytorch.org/docs/stable/data.html#data-loading-randomness for more details</span>

<span class="sd">  Returns:</span>
<span class="sd">    Nothing</span>
<span class="sd">  """</span>
  <span class="n">worker_seed</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">initial_seed</span><span class="p">()</span> <span class="o">%</span> <span class="mi">2</span><span class="o">**</span><span class="mi">32</span>
  <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">worker_seed</span><span class="p">)</span>
  <span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">worker_seed</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="set-device-gpu-or-cpu-execute-set-device">
<h2>Set device (GPU or CPU). Execute <code class="docutils literal notranslate"><span class="pre">set_device()</span></code><a class="headerlink" href="#set-device-gpu-or-cpu-execute-set-device" title="Permalink to this heading">#</a></h2>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Set device (GPU or CPU). Execute `set_device()`</span>
<span class="c1"># especially if torch modules used.</span>

<span class="c1"># inform the user if the notebook uses GPU or CPU.</span>

<span class="k">def</span><span class="w"> </span><span class="nf">set_device</span><span class="p">():</span>
<span class="w">  </span><span class="sd">"""</span>
<span class="sd">  Set the device. CUDA if available, CPU otherwise</span>

<span class="sd">  Args:</span>
<span class="sd">    None</span>

<span class="sd">  Returns:</span>
<span class="sd">    Nothing</span>
<span class="sd">  """</span>
  <span class="n">device</span> <span class="o">=</span> <span class="s2">"cuda"</span> <span class="k">if</span> <span class="n">torch</span><span class="o">.</span><span class="n">cuda</span><span class="o">.</span><span class="n">is_available</span><span class="p">()</span> <span class="k">else</span> <span class="s2">"cpu"</span>
  <span class="k">if</span> <span class="n">device</span> <span class="o">!=</span> <span class="s2">"cuda"</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"WARNING: For this notebook to perform best, "</span>
        <span class="s2">"if possible, in the menu under `Runtime` -&gt; "</span>
        <span class="s2">"`Change runtime type.`  select `GPU` "</span><span class="p">)</span>
  <span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"GPU is enabled in this notebook."</span><span class="p">)</span>

  <span class="k">return</span> <span class="n">device</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">SEED</span> <span class="o">=</span> <span class="mi">2021</span>
<span class="n">set_seed</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="n">SEED</span><span class="p">)</span>
<span class="n">DEVICE</span> <span class="o">=</span> <span class="n">set_device</span><span class="p">()</span>
</pre></div>
</div>
</div>

</div>
</section>
</section>
<hr class="docutils"/>
<section class="tex2jax_ignore mathjax_ignore" id="bonus-1-language-modeling-as-pre-training">
<h1>Bonus 1: Language modeling as pre-training<a class="headerlink" href="#bonus-1-language-modeling-as-pre-training" title="Permalink to this heading">#</a></h1>
<p><em>Time estimate: ~20mins</em></p>
<section id="video-1-pre-training">
<h2>Video 1: Pre-training<a class="headerlink" href="#video-1-pre-training" title="Permalink to this heading">#</a></h2>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"version_major": 2, "version_minor": 0, "model_id": "ea98d59b455b490284368d1304980c87"}</script></div>
</div>
</section>
<section id="submit-your-feedback">
<h2>Submit your feedback<a class="headerlink" href="#submit-your-feedback" title="Permalink to this heading">#</a></h2>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Submit your feedback</span>
<span class="n">content_review</span><span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">feedback_prefix</span><span class="si">}</span><span class="s2">_PreTraining_Video"</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"version_major": 2, "version_minor": 0, "model_id": "90f2e1a7971c4be997114cfa3a51f558"}</script></div>
</div>
<section id="bonus-interactive-demo-1-gpt-2-for-sentiment-classification">
<h3>Bonus Interactive Demo 1: GPT-2 for sentiment classification<a class="headerlink" href="#bonus-interactive-demo-1-gpt-2-for-sentiment-classification" title="Permalink to this heading">#</a></h3>
<p>In this section, we will use the pre-trained language model GPT-2 for sentiment classification.</p>
<p>Let’s first load the Yelp review dataset.</p>
<section id="download-the-dataset-from-osf">
<h4>Download the dataset from OSF<a class="headerlink" href="#download-the-dataset-from-osf" title="Permalink to this heading">#</a></h4>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Download the dataset from OSF</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">requests</span><span class="o">,</span><span class="w"> </span><span class="nn">tarfile</span>

<span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">'HF_DATASETS_CACHE'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'data/'</span>

<span class="n">url</span> <span class="o">=</span> <span class="s2">"https://osf.io/kthjg/download"</span>
<span class="n">fname</span> <span class="o">=</span> <span class="s2">"huggingface.tar.gz"</span>

<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">fname</span><span class="p">):</span>
  <span class="nb">print</span><span class="p">(</span><span class="s1">'Dataset is being downloaded...'</span><span class="p">)</span>
  <span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">allow_redirects</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
  <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span> <span class="s1">'wb'</span><span class="p">)</span> <span class="k">as</span> <span class="n">fd</span><span class="p">:</span>
    <span class="n">fd</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">content</span><span class="p">)</span>
  <span class="nb">print</span><span class="p">(</span><span class="s1">'Download is finished.'</span><span class="p">)</span>

  <span class="k">with</span> <span class="n">tarfile</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span> <span class="k">as</span> <span class="n">ft</span><span class="p">:</span>
    <span class="n">ft</span><span class="o">.</span><span class="n">extractall</span><span class="p">(</span><span class="s1">'data/'</span><span class="p">)</span>
  <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span>
  <span class="nb">print</span><span class="p">(</span><span class="s1">'Files have been extracted.'</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="load-the-dataset">
<h4>Load the dataset<a class="headerlink" href="#load-the-dataset" title="Permalink to this heading">#</a></h4>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Load the dataset</span>

<span class="n">DATASET</span> <span class="o">=</span> <span class="n">datasets</span><span class="o">.</span><span class="n">load_dataset</span><span class="p">(</span><span class="s2">"yelp_review_full"</span><span class="p">,</span>
                                <span class="n">download_mode</span><span class="o">=</span><span class="s2">"reuse_dataset_if_exists"</span><span class="p">,</span>
                                <span class="n">cache_dir</span><span class="o">=</span><span class="s1">'data/'</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">DATASET</span><span class="p">))</span>
</pre></div>
</div>
</div>
</details>

</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># If the above cell produces an error uncomment below and run this cell.</span>
<span class="c1"># DATASET = load_dataset("yelp_review_full", ignore_verifications=True)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="bonus-1-1-load-yelp-reviews-dataset">
<h4>Bonus 1.1: Load Yelp reviews dataset ⌛🤗<a class="headerlink" href="#bonus-1-1-load-yelp-reviews-dataset" title="Permalink to this heading">#</a></h4>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Bonus 1.1: Load Yelp reviews dataset ⌛🤗</span>
<span class="n">train_dataset</span> <span class="o">=</span> <span class="n">DATASET</span><span class="p">[</span><span class="s1">'train'</span><span class="p">]</span>
<span class="n">test_dataset</span> <span class="o">=</span> <span class="n">DATASET</span><span class="p">[</span><span class="s1">'test'</span><span class="p">]</span>

<span class="c1"># filter training data by sentiment value</span>
<span class="n">sentiment_dict</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">sentiment_dict</span><span class="p">[</span><span class="s2">"Sentiment = 0"</span><span class="p">]</span> <span class="o">=</span> <span class="n">train_dataset</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">example</span><span class="p">:</span> <span class="n">example</span><span class="p">[</span><span class="s1">'label'</span><span class="p">]</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span>
<span class="n">sentiment_dict</span><span class="p">[</span><span class="s2">"Sentiment = 1"</span><span class="p">]</span> <span class="o">=</span> <span class="n">train_dataset</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">example</span><span class="p">:</span> <span class="n">example</span><span class="p">[</span><span class="s1">'label'</span><span class="p">]</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span>
<span class="n">sentiment_dict</span><span class="p">[</span><span class="s2">"Sentiment = 2"</span><span class="p">]</span> <span class="o">=</span> <span class="n">train_dataset</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">example</span><span class="p">:</span> <span class="n">example</span><span class="p">[</span><span class="s1">'label'</span><span class="p">]</span><span class="o">==</span><span class="mi">2</span><span class="p">)</span>
<span class="n">sentiment_dict</span><span class="p">[</span><span class="s2">"Sentiment = 3"</span><span class="p">]</span> <span class="o">=</span> <span class="n">train_dataset</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">example</span><span class="p">:</span> <span class="n">example</span><span class="p">[</span><span class="s1">'label'</span><span class="p">]</span><span class="o">==</span><span class="mi">3</span><span class="p">)</span>
<span class="n">sentiment_dict</span><span class="p">[</span><span class="s2">"Sentiment = 4"</span><span class="p">]</span> <span class="o">=</span> <span class="n">train_dataset</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">example</span><span class="p">:</span> <span class="n">example</span><span class="p">[</span><span class="s1">'label'</span><span class="p">]</span><span class="o">==</span><span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>

</div>
<p><strong>Kaggle users:</strong> If the cell above fails, please re-execute it several times!</p>
<p>Next, we’ll set up a text context for the pre-trained language models. We can either sample a review from the Yelp reviews dataset or write our own custom review as the text context. We will perform text-generation and sentiment-classification with this text context.</p>
</section>
<section id="bonus-1-2-setting-up-a-text-context">
<h4>Bonus 1.2: Setting up a text context ✍️<a class="headerlink" href="#bonus-1-2-setting-up-a-text-context" title="Permalink to this heading">#</a></h4>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Bonus 1.2: Setting up a text context ✍️</span>

<span class="k">def</span><span class="w"> </span><span class="nf">clean_text</span><span class="p">(</span><span class="n">text</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Function to clean up text</span>

<span class="sd">    Args:</span>
<span class="sd">      text: String</span>
<span class="sd">        Input text sequence</span>

<span class="sd">    Returns:</span>
<span class="sd">      text: String</span>
<span class="sd">        Returned clean string does not contain new-line characters,</span>
<span class="sd">        backslashes etc.</span>
<span class="sd">    """</span>
    <span class="n">text</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">"</span><span class="se">\\</span><span class="s2">n"</span><span class="p">,</span> <span class="s2">" "</span><span class="p">)</span>
    <span class="n">text</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">,</span> <span class="s2">" "</span><span class="p">)</span>
    <span class="n">text</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">"</span><span class="se">\\</span><span class="s2">"</span><span class="p">,</span> <span class="s2">" "</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">text</span>

<span class="c1"># @markdown ---</span>
<span class="n">sample_review_from_yelp</span> <span class="o">=</span> <span class="s2">"Sentiment = 4"</span>  <span class="c1"># @param ["Sentiment = 0", "Sentiment = 1", "Sentiment = 2", "Sentiment = 3", "Sentiment = 4"]</span>
<span class="c1"># @markdown **Randomly sample a response from the Yelp review dataset with the given sentiment value {0:😠, 1:😦, 2:😐, 3:🙂, 4:😀}**</span>

<span class="c1"># @markdown ---</span>
<span class="n">use_custom_review</span> <span class="o">=</span> <span class="kc">False</span>  <span class="c1"># @param {type:"boolean"}</span>
<span class="n">custom_review</span> <span class="o">=</span> <span class="s2">"I liked this movie very much because ..."</span>  <span class="c1"># @param {type:"string"}</span>
<span class="c1"># @markdown ***Alternatively, write your own review (don't forget to enable custom review using the checkbox given above)***</span>

<span class="c1"># @markdown ---</span>

<span class="c1"># @markdown **NOTE:** *Run the cell after setting all the You can adding different kinds of extension above fields appropriately!*</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">"</span><span class="se">\n</span><span class="s2"> ****** The selected text context ****** </span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
<span class="k">if</span> <span class="n">use_custom_review</span><span class="p">:</span>
  <span class="n">context</span> <span class="o">=</span> <span class="n">clean_text</span><span class="p">(</span><span class="n">custom_review</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
  <span class="n">context</span> <span class="o">=</span> <span class="n">clean_text</span><span class="p">(</span><span class="n">sentiment_dict</span><span class="p">[</span><span class="n">sample_review_from_yelp</span><span class="p">][</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">sentiment_dict</span><span class="p">[</span><span class="n">sample_review_from_yelp</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">)][</span><span class="s2">"text"</span><span class="p">])</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">context</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>

</div>
<p>Here, we’ll ask the pre-trained language models to extend the selected text context further. You can try adding different kinds of extension prompts at the end of the text context, conditioning it for different kinds of text extensions.</p>
</section>
<section id="bonus-1-3-extending-the-review-with-pre-trained-models">
<h4>Bonus 1.3: Extending the review with pre-trained models 🤖<a class="headerlink" href="#bonus-1-3-extending-the-review-with-pre-trained-models" title="Permalink to this heading">#</a></h4>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Bonus 1.3: Extending the review with pre-trained models 🤖</span>

<span class="c1"># @markdown ---</span>
<span class="n">model</span> <span class="o">=</span> <span class="s2">"gpt2"</span>  <span class="c1"># @param ["gpt2", "gpt2-medium", "xlnet-base-cased"]</span>
<span class="n">generator</span> <span class="o">=</span> <span class="n">pipeline</span><span class="p">(</span><span class="s1">'text-generation'</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="n">model</span><span class="p">)</span>
<span class="n">set_seed</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="n">SEED</span><span class="p">)</span>
<span class="c1"># @markdown **Select a pre-trained language model to generate text 🤖**</span>

<span class="c1"># @markdown *(might take some time to download the pre-trained weights for the first time)*</span>

<span class="c1"># @markdown ---</span>
<span class="n">extension_prompt</span> <span class="o">=</span> <span class="s2">"Hence, overall I feel that ..."</span>  <span class="c1"># @param {type:"string"}</span>
<span class="n">num_output_responses</span> <span class="o">=</span> <span class="mi">1</span>  <span class="c1"># @param {type:"slider", min:1, max:10, step:1}</span>
<span class="c1"># @markdown **Provide a prompt to extend the review ✍️**</span>

<span class="n">input_text</span> <span class="o">=</span> <span class="n">context</span> <span class="o">+</span> <span class="s2">" "</span> <span class="o">+</span> <span class="n">extension_prompt</span>
<span class="c1"># @markdown **NOTE:** *Run this cell after setting all the fields appropriately!*</span>

<span class="c1"># @markdown **NOTE:** *Some pre-trained models might not work well with longer texts!*</span>

<span class="n">generated_responses</span> <span class="o">=</span> <span class="n">generator</span><span class="p">(</span><span class="n">input_text</span><span class="p">,</span> <span class="n">max_length</span><span class="o">=</span><span class="mi">512</span><span class="p">,</span> <span class="n">num_return_sequences</span><span class="o">=</span><span class="n">num_output_responses</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">"</span><span class="se">\n</span><span class="s2"> *********** INPUT PROMPT TO THE MODEL ************ </span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">input_text</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">"</span><span class="se">\n</span><span class="s2"> *********** EXTENDED RESPONSES BY THE MODEL ************ </span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
<span class="k">for</span> <span class="n">response</span> <span class="ow">in</span> <span class="n">generated_responses</span><span class="p">:</span>
  <span class="n">pprint</span><span class="p">(</span><span class="n">response</span><span class="p">[</span><span class="s2">"generated_text"</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">input_text</span><span class="p">):]</span> <span class="o">+</span> <span class="s2">" ..."</span><span class="p">)</span>
  <span class="nb">print</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>

</div>
<p>Next, we’ll ask the pre-trained language models to calculate the likelihood of already existing text-extensions. We can define a positive text-extension as well as a negative text-extension. The sentiment of the given text context can then be determined by comparing the likelihoods of the given text extensions.</p>
<p>(For a positive review, a positive text-extension should ideally be given more likelihood by the pre-trained language model as compared to a negative text-extension. Similarly, for a negative review, the negative text-extension should have more likelihood than the positive text-extension.)</p>
</section>
<section id="bonus-1-4-sentiment-binary-classification-with-likelihood-of-positive-and-negative-extensions-of-the-review">
<h4>Bonus 1.4: Sentiment binary-classification with likelihood of positive and negative extensions of the review 👍👎<a class="headerlink" href="#bonus-1-4-sentiment-binary-classification-with-likelihood-of-positive-and-negative-extensions-of-the-review" title="Permalink to this heading">#</a></h4>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Bonus 1.4: Sentiment binary-classification with likelihood of positive and negative extensions of the review 👍👎</span>

<span class="c1"># @markdown ---</span>
<span class="n">model_name</span> <span class="o">=</span> <span class="s2">"gpt2"</span>  <span class="c1"># @param ["gpt2", "gpt2-medium", "xlnet-base-cased"]</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">AutoModelForCausalLM</span><span class="o">.</span><span class="n">from_pretrained</span><span class="p">(</span><span class="n">model_name</span><span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
<span class="n">tokenizer</span> <span class="o">=</span> <span class="n">AutoTokenizer</span><span class="o">.</span><span class="n">from_pretrained</span><span class="p">(</span><span class="n">model_name</span><span class="p">)</span>
<span class="c1"># @markdown **Select a pre-trained language model to score the likelihood of extended review**</span>

<span class="c1"># @markdown *(might take some time to download the pre-trained weights for the first time)*</span>

<span class="c1"># @markdown ---</span>
<span class="n">custom_positive_extension</span> <span class="o">=</span> <span class="s2">"I would definitely recommend this!"</span>  <span class="c1"># @param {type:"string"}</span>
<span class="n">custom_negative_extension</span> <span class="o">=</span> <span class="s2">"I would not recommend this!"</span>  <span class="c1"># @param {type:"string"}</span>
<span class="c1"># @markdown **Provide custom positive and negative extensions to the review ✍️**</span>

<span class="n">texts</span> <span class="o">=</span> <span class="p">[</span><span class="n">context</span><span class="p">,</span> <span class="n">custom_positive_extension</span><span class="p">,</span> <span class="n">custom_negative_extension</span><span class="p">]</span>
<span class="n">encodings</span> <span class="o">=</span> <span class="n">tokenizer</span><span class="p">(</span><span class="n">texts</span><span class="p">)</span>

<span class="n">positive_input_ids</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">encodings</span><span class="p">[</span><span class="s2">"input_ids"</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">encodings</span><span class="p">[</span><span class="s2">"input_ids"</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
<span class="n">positive_attention_mask</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">encodings</span><span class="p">[</span><span class="s2">"attention_mask"</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">encodings</span><span class="p">[</span><span class="s2">"attention_mask"</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
<span class="n">positive_label_ids</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="o">-</span><span class="mi">100</span><span class="p">]</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">encodings</span><span class="p">[</span><span class="s2">"input_ids"</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span> <span class="o">+</span> <span class="n">encodings</span><span class="p">[</span><span class="s2">"input_ids"</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
<span class="n">outputs</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">input_ids</span><span class="o">=</span><span class="n">positive_input_ids</span><span class="p">,</span>
                <span class="n">attention_mask</span><span class="o">=</span><span class="n">positive_attention_mask</span><span class="p">,</span>
                <span class="n">labels</span><span class="o">=</span><span class="n">positive_label_ids</span><span class="p">)</span>
<span class="n">positive_extension_likelihood</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="o">*</span><span class="n">outputs</span><span class="o">.</span><span class="n">loss</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"</span><span class="se">\n</span><span class="s2">Log-likelihood of positive extension = "</span><span class="p">,</span> <span class="n">positive_extension_likelihood</span><span class="o">.</span><span class="n">item</span><span class="p">())</span>

<span class="n">negative_input_ids</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">encodings</span><span class="p">[</span><span class="s2">"input_ids"</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">encodings</span><span class="p">[</span><span class="s2">"input_ids"</span><span class="p">][</span><span class="mi">2</span><span class="p">])</span>
<span class="n">negative_attention_mask</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">encodings</span><span class="p">[</span><span class="s2">"attention_mask"</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">encodings</span><span class="p">[</span><span class="s2">"attention_mask"</span><span class="p">][</span><span class="mi">2</span><span class="p">])</span>
<span class="n">negative_label_ids</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="o">-</span><span class="mi">100</span><span class="p">]</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">encodings</span><span class="p">[</span><span class="s2">"input_ids"</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span> <span class="o">+</span> <span class="n">encodings</span><span class="p">[</span><span class="s2">"input_ids"</span><span class="p">][</span><span class="mi">2</span><span class="p">])</span>
<span class="n">outputs</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">input_ids</span><span class="o">=</span><span class="n">negative_input_ids</span><span class="p">,</span>
                <span class="n">attention_mask</span><span class="o">=</span><span class="n">negative_attention_mask</span><span class="p">,</span>
                <span class="n">labels</span><span class="o">=</span><span class="n">negative_label_ids</span><span class="p">)</span>
<span class="n">negative_extension_likelihood</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="o">*</span><span class="n">outputs</span><span class="o">.</span><span class="n">loss</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"</span><span class="se">\n</span><span class="s2">Log-likelihood of negative extension = "</span><span class="p">,</span> <span class="n">negative_extension_likelihood</span><span class="o">.</span><span class="n">item</span><span class="p">())</span>

<span class="k">if</span> <span class="p">(</span><span class="n">positive_extension_likelihood</span><span class="o">.</span><span class="n">item</span><span class="p">()</span> <span class="o">&gt;</span> <span class="n">negative_extension_likelihood</span><span class="o">.</span><span class="n">item</span><span class="p">()):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"</span><span class="se">\n</span><span class="s2">Positive text-extension has greater likelihood probabilities!"</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"The given review can be predicted to be POSITIVE 👍"</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"</span><span class="se">\n</span><span class="s2">Negative text-extension has greater likelihood probabilities!"</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"The given review can be predicted to be NEGATIVE 👎"</span><span class="p">)</span>
<span class="c1"># @markdown **NOTE:** *Run this cell after setting all the fields appropriately!*</span>

<span class="c1"># @markdown **NOTE:** *Some pre-trained models might not work well with longer texts!*</span>
</pre></div>
</div>
</div>
</details>

</div>
</section>
</section>
</section>
</section>
<hr class="docutils"/>
<section class="tex2jax_ignore mathjax_ignore" id="bonus-2-light-weight-fine-tuning">
<h1>Bonus 2: Light-weight fine-tuning<a class="headerlink" href="#bonus-2-light-weight-fine-tuning" title="Permalink to this heading">#</a></h1>
<p><em>Time estimate: ~10mins</em></p>
<section id="video-2-fine-tuning">
<h2>Video 2: Fine-tuning<a class="headerlink" href="#video-2-fine-tuning" title="Permalink to this heading">#</a></h2>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"version_major": 2, "version_minor": 0, "model_id": "237f219474934a7a8dcb1016ef5cfc72"}</script></div>
</div>
</section>
<section id="id1">
<h2>Submit your feedback<a class="headerlink" href="#id1" title="Permalink to this heading">#</a></h2>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Submit your feedback</span>
<span class="n">content_review</span><span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">feedback_prefix</span><span class="si">}</span><span class="s2">_FineTuning_Video"</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"version_major": 2, "version_minor": 0, "model_id": "538584ff77a1462b8225a9234c1bab55"}</script></div>
</div>
<p>Fine-tuning these large pre-trained models with billions of parameters tends to be very slow. In this section, we will explore the effect of fine-tuning a few layers (while fixing the others) to save training time.</p>
<p>The HuggingFace python library provides a simplified API for training and fine-tuning transformer language models. In this exercise we will fine-tune a pre-trained language model for sentiment classification.</p>
</section>
<section id="bonus-2-1-data-processing">
<h2>Bonus 2.1: Data Processing<a class="headerlink" href="#bonus-2-1-data-processing" title="Permalink to this heading">#</a></h2>
<p>Pre-trained transformer models have a fixed vocabulary of words and sub-words. The input text to a transformer model has to be tokenized into these words and sub-words during the pre-processing stage. We’ll use the HuggingFace <code class="docutils literal notranslate"><span class="pre">tokenizers</span></code> to perform the tokenization here.</p>
<p>(By default we’ll use the BERT base-cased pre-trained language model here. You can try using one of the other models available <a class="reference external" href="https://huggingface.co/transformers/pretrained_models.html">here</a> by changing the model ID values at appropriate places in the code.)</p>
<p>Most of the pre-trained language models have a fixed maximum sequence length. With the HuggingFace <code class="docutils literal notranslate"><span class="pre">tokenizer</span></code> library, we can either pad or truncate input text sequences to maximum length with a few lines of code:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Tokenize the input texts</span>
<span class="n">tokenizer</span> <span class="o">=</span> <span class="n">AutoTokenizer</span><span class="o">.</span><span class="n">from_pretrained</span><span class="p">(</span><span class="s2">"bert-base-cased"</span><span class="p">)</span>


<span class="k">def</span><span class="w"> </span><span class="nf">tokenize_function</span><span class="p">(</span><span class="n">examples</span><span class="p">):</span>
<span class="w">  </span><span class="sd">"""</span>
<span class="sd">  Tokenises incoming sequences;</span>

<span class="sd">  Args:</span>
<span class="sd">    examples: Sequence of strings</span>
<span class="sd">      Sequences to tokenise</span>

<span class="sd">  Returns:</span>
<span class="sd">    Returns transformer autotokenizer object with padded, truncated input sequences.</span>
<span class="sd">  """</span>
  <span class="k">return</span> <span class="n">tokenizer</span><span class="p">(</span><span class="n">examples</span><span class="p">[</span><span class="s2">"text"</span><span class="p">],</span> <span class="n">padding</span><span class="o">=</span><span class="s2">"max_length"</span><span class="p">,</span> <span class="n">truncation</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Here we use the `DATASET` as defined above.</span>
<span class="c1"># Recall that DATASET = load_dataset("yelp_review_full", ignore_verifications=True)</span>
<span class="n">tokenized_datasets</span> <span class="o">=</span> <span class="n">DATASET</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">tokenize_function</span><span class="p">,</span> <span class="n">batched</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>

</div>
<p>We’ll randomly sample a subset of the <a class="reference external" href="https://huggingface.co/datasets/yelp_review_full">Yelp reviews dataset</a> (10k train samples, 5k samples for validation &amp; testing each). You can include more samples here for better performance (at the cost of longer training times!)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Select the data splits</span>
<span class="n">train_dataset</span> <span class="o">=</span> <span class="n">tokenized_datasets</span><span class="p">[</span><span class="s2">"train"</span><span class="p">]</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="n">SEED</span><span class="p">)</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">10000</span><span class="p">))</span>
<span class="n">test_dataset</span> <span class="o">=</span> <span class="n">tokenized_datasets</span><span class="p">[</span><span class="s2">"test"</span><span class="p">]</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2500</span><span class="p">))</span>
<span class="n">validation_dataset</span> <span class="o">=</span> <span class="n">tokenized_datasets</span><span class="p">[</span><span class="s2">"test"</span><span class="p">]</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">2500</span><span class="p">,</span> <span class="mi">5000</span><span class="p">))</span>
</pre></div>
</div>
</div>

</div>
</section>
<section id="bonus-2-2-model-loading">
<h2>Bonus 2.2: Model Loading<a class="headerlink" href="#bonus-2-2-model-loading" title="Permalink to this heading">#</a></h2>
<p>Next, we’ll load a pre-trained checkpoint of the model and decide which layers are to be fine-tuned.</p>
<p>Modify the <code class="docutils literal notranslate"><span class="pre">train_layers</span></code> variable below to pick which layers you would like to fine-tune (you can uncomment the print statements for this). Fine-tuning more layers might result in better performance (at the cost of longer training times). Due to computational limitations (limited GPU memory) we cannot fine-tune the entire model.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Load pre-trained BERT model and freeze layers</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">AutoModelForSequenceClassification</span><span class="o">.</span><span class="n">from_pretrained</span><span class="p">(</span><span class="s2">"bert-base-cased"</span><span class="p">,</span>
                                                           <span class="n">cache_dir</span><span class="o">=</span><span class="s2">"data/"</span><span class="p">,</span>
                                                           <span class="n">num_labels</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">train_layers</span> <span class="o">=</span> <span class="p">[</span><span class="s2">"classifier"</span><span class="p">,</span> <span class="s2">"bert.pooler"</span><span class="p">,</span> <span class="s2">"bert.encoder.layer.11"</span><span class="p">]</span>  <span class="c1"># add/remove layers here (use layer-name sub-strings)</span>

<span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">param</span> <span class="ow">in</span> <span class="n">model</span><span class="o">.</span><span class="n">named_parameters</span><span class="p">():</span>
  <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">x</span> <span class="ow">in</span> <span class="n">name</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">train_layers</span><span class="p">):</span>
    <span class="n">param</span><span class="o">.</span><span class="n">requires_grad</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="c1"># print("FINE-TUNING --&gt;", name)</span>
  <span class="k">else</span><span class="p">:</span>
    <span class="n">param</span><span class="o">.</span><span class="n">requires_grad</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="c1"># print("FROZEN --&gt;", name)</span>
</pre></div>
</div>
</div>

</div>
</section>
<section id="bonus-2-3-fine-tuning">
<h2>Bonus 2.3: Fine-tuning<a class="headerlink" href="#bonus-2-3-fine-tuning" title="Permalink to this heading">#</a></h2>
<p>Fine-tune the model! The HuggingFace <code class="docutils literal notranslate"><span class="pre">Trainer</span></code> class supports easy fine-tuning and logging. You can play around with various hyperparameters here!</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Setup huggingface trainer</span>
<span class="n">training_args</span> <span class="o">=</span> <span class="n">TrainingArguments</span><span class="p">(</span><span class="n">output_dir</span><span class="o">=</span><span class="s2">"yelp_bert"</span><span class="p">,</span>
                                  <span class="n">overwrite_output_dir</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                  <span class="n">eval_strategy</span><span class="o">=</span><span class="s2">"epoch"</span><span class="p">,</span>
                                  <span class="n">per_device_train_batch_size</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span>
                                  <span class="n">per_device_eval_batch_size</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span>
                                  <span class="n">learning_rate</span><span class="o">=</span><span class="mf">5e-5</span><span class="p">,</span>
                                  <span class="n">weight_decay</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
                                  <span class="n">num_train_epochs</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>  <span class="c1"># students may use 5 to see a full training!</span>
                                  <span class="n">fp16</span><span class="o">=</span><span class="kc">False</span> <span class="k">if</span> <span class="n">DEVICE</span><span class="o">==</span><span class="s1">'cpu'</span> <span class="k">else</span> <span class="kc">True</span><span class="p">,</span>
                                  <span class="n">save_steps</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span>
                                  <span class="n">logging_steps</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
                                  <span class="n">report_to</span><span class="o">=</span><span class="s2">"tensorboard"</span>
                                  <span class="p">)</span>
</pre></div>
</div>
</div>

</div>
<p>We’ll use <code class="docutils literal notranslate"><span class="pre">Accuracy</span></code> as the evaluation metric for the sentiment classification task. The HuggingFace <code class="docutils literal notranslate"><span class="pre">datasets</span></code> library supports various metrics. You can try experimenting with other classification metrics here!</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Setup evaluation metric</span>
<span class="k">def</span><span class="w"> </span><span class="nf">compute_metrics</span><span class="p">(</span><span class="n">eval_pred</span><span class="p">):</span>
<span class="w">  </span><span class="sd">"""</span>
<span class="sd">  Computes accuracy of the prediction</span>

<span class="sd">  Args:</span>
<span class="sd">    eval_pred: Tuple</span>
<span class="sd">      Logits predicted by the model vs actual labels</span>

<span class="sd">  Returns:</span>
<span class="sd">    Dictionary containing accuracy of the prediction</span>
<span class="sd">  """</span>
  <span class="n">metric</span> <span class="o">=</span> <span class="n">evaluate</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">"accuracy"</span><span class="p">)</span>
  <span class="n">logits</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">eval_pred</span>
  <span class="n">predictions</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">logits</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
  <span class="k">return</span> <span class="n">metric</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="n">predictions</span><span class="o">=</span><span class="n">predictions</span><span class="p">,</span> <span class="n">references</span><span class="o">=</span><span class="n">labels</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Start the training!</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Instantiate a trainer with training and validation datasets</span>
<span class="n">trainer</span> <span class="o">=</span> <span class="n">Trainer</span><span class="p">(</span>
    <span class="n">model</span><span class="o">=</span><span class="n">model</span><span class="p">,</span>
    <span class="n">args</span><span class="o">=</span><span class="n">training_args</span><span class="p">,</span>
    <span class="n">train_dataset</span><span class="o">=</span><span class="n">train_dataset</span><span class="p">,</span>
    <span class="n">eval_dataset</span><span class="o">=</span><span class="n">validation_dataset</span><span class="p">,</span>
    <span class="n">compute_metrics</span><span class="o">=</span><span class="n">compute_metrics</span><span class="p">,</span>
    <span class="n">tokenizer</span><span class="o">=</span><span class="n">tokenizer</span>
    <span class="p">)</span>
</pre></div>
</div>
</div>

</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Train the model</span>
<span class="k">if</span> <span class="n">DEVICE</span> <span class="o">!=</span> <span class="s1">'cpu'</span><span class="p">:</span>
  <span class="n">trainer</span><span class="o">.</span><span class="n">train</span><span class="p">()</span>
</pre></div>
</div>
</div>

</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Evaluate the model on the test dataset</span>
<span class="k">if</span> <span class="n">DEVICE</span> <span class="o">!=</span> <span class="s1">'cpu'</span><span class="p">:</span>
  <span class="n">trainer</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">test_dataset</span><span class="p">)</span>
</pre></div>
</div>
</div>

</div>
<p>We can now visualize the <code class="docutils literal notranslate"><span class="pre">Tensorboard</span></code> logs to analyze the training process! The HuggingFace <code class="docutils literal notranslate"><span class="pre">Trainer</span></code> class will log various loss values and evaluation metrics automatically!</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Visualize the tensorboard logs</span>
<span class="k">if</span> <span class="n">DEVICE</span> <span class="o">!=</span> <span class="s1">'cpu'</span><span class="p">:</span>
  <span class="o">%</span><span class="k">tensorboard</span> --logdir yelp_bert/runs
</pre></div>
</div>
</div>

</div>
</section>
</section>
<hr class="docutils"/>
<section class="tex2jax_ignore mathjax_ignore" id="bonus-3-model-robustness">
<h1>Bonus 3: Model robustness<a class="headerlink" href="#bonus-3-model-robustness" title="Permalink to this heading">#</a></h1>
<p><em>Time estimate: ~22mins</em></p>
<section id="video-3-robustness">
<h2>Video 3: Robustness<a class="headerlink" href="#video-3-robustness" title="Permalink to this heading">#</a></h2>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"version_major": 2, "version_minor": 0, "model_id": "3eb1f8d0a4ee48e48d775f83513af7d3"}</script></div>
</div>
</section>
<section id="id2">
<h2>Submit your feedback<a class="headerlink" href="#id2" title="Permalink to this heading">#</a></h2>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Submit your feedback</span>
<span class="n">content_review</span><span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">feedback_prefix</span><span class="si">}</span><span class="s2">_Robustness_Video"</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"version_major": 2, "version_minor": 0, "model_id": "6a752988ac804ea2acf54504e97102df"}</script></div>
</div>
<p>Given the previously trained model for sentiment classification, it is possible to deceive it using various text perturbations. The text perturbations can act as previously unseen noise to the model, which might persuade it to impart wrong values of sentiment!</p>
</section>
<section id="bonus-interactive-demo-3-break-the-model">
<h2>Bonus Interactive Demo 3: Break the model<a class="headerlink" href="#bonus-interactive-demo-3-break-the-model" title="Permalink to this heading">#</a></h2>
<section id="bonus-3-1-load-an-original-review">
<h3>Bonus 3.1: Load an original review<a class="headerlink" href="#bonus-3-1-load-an-original-review" title="Permalink to this heading">#</a></h3>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Bonus 3.1: Load an original review</span>

<span class="k">def</span><span class="w"> </span><span class="nf">clean_text</span><span class="p">(</span><span class="n">text</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Function to clean up text</span>

<span class="sd">    Args:</span>
<span class="sd">      text: String</span>
<span class="sd">        Input text sequence</span>

<span class="sd">    Returns:</span>
<span class="sd">      text: String</span>
<span class="sd">        Returned string does not contain characters new-line characters, backslashes etc.</span>
<span class="sd">    """</span>
    <span class="n">text</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">"</span><span class="se">\\</span><span class="s2">n"</span><span class="p">,</span> <span class="s2">" "</span><span class="p">)</span>
    <span class="n">text</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">,</span> <span class="s2">" "</span><span class="p">)</span>
    <span class="n">text</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">"</span><span class="se">\\</span><span class="s2">"</span><span class="p">,</span> <span class="s2">" "</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">text</span>

<span class="c1"># @markdown ---</span>
<span class="n">sample_review_from_yelp</span> <span class="o">=</span> <span class="s2">"Sentiment = 4"</span> <span class="c1">#@param ["Sentiment = 0", "Sentiment = 1", "Sentiment = 2", "Sentiment = 3", "Sentiment = 4"]</span>
<span class="c1"># @markdown **Randomly sample a response from the Yelp review dataset with the given sentiment value {0:😠, 1:😦, 2:😐, 3:🙂, 4:😀}**</span>

<span class="c1"># @markdown ---</span>

<span class="n">context</span> <span class="o">=</span> <span class="n">clean_text</span><span class="p">(</span><span class="n">sentiment_dict</span><span class="p">[</span><span class="n">sample_review_from_yelp</span><span class="p">][</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">sentiment_dict</span><span class="p">[</span><span class="n">sample_review_from_yelp</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">)][</span><span class="s2">"text"</span><span class="p">])</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">"Review for "</span><span class="p">,</span> <span class="n">sample_review_from_yelp</span><span class="p">,</span> <span class="s2">":</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">context</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>

</div>
</section>
<section id="id3">
<h3>Submit your feedback<a class="headerlink" href="#id3" title="Permalink to this heading">#</a></h3>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Submit your feedback</span>
<span class="n">content_review</span><span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">feedback_prefix</span><span class="si">}</span><span class="s2">_Load_an_original_review_Interactive_Demo"</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"version_major": 2, "version_minor": 0, "model_id": "0198291eeed94fbcbfadfc0346cc86c0"}</script></div>
</div>
<p>We can apply various text perturbations to the selected review using the <code class="docutils literal notranslate"><span class="pre">textattack</span></code> python library. This will help us augment the original text to break the model!</p>
<p><strong>Important:</strong> Locally or on colab (with <code class="docutils literal notranslate"><span class="pre">!</span></code>) you can simple</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pip<span class="w"> </span>install<span class="w"> </span>textattack<span class="w"> </span>--quiet
</pre></div>
</div>
<p>Then, import the packages:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">textattack.augmentation</span><span class="w"> </span><span class="kn">import</span> <span class="n">Augmenter</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">textattack.transformations</span><span class="w"> </span><span class="kn">import</span> <span class="n">WordSwapQWERTY</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">textattack.transformations</span><span class="w"> </span><span class="kn">import</span> <span class="n">WordSwapExtend</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">textattack.transformations</span><span class="w"> </span><span class="kn">import</span> <span class="n">WordSwapContract</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">textattack.transformations</span><span class="w"> </span><span class="kn">import</span> <span class="n">WordSwapHomoglyphSwap</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">textattack.transformations</span><span class="w"> </span><span class="kn">import</span> <span class="n">CompositeTransformation</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">textattack.transformations</span><span class="w"> </span><span class="kn">import</span> <span class="n">WordSwapRandomCharacterDeletion</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">textattack.transformations</span><span class="w"> </span><span class="kn">import</span> <span class="n">WordSwapNeighboringCharacterSwap</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">textattack.transformations</span><span class="w"> </span><span class="kn">import</span> <span class="n">WordSwapRandomCharacterInsertion</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">textattack.transformations</span><span class="w"> </span><span class="kn">import</span> <span class="n">WordSwapRandomCharacterSubstitution</span>
</pre></div>
</div>
<p>However, as we faced issues, you can run the cell below to load all necessary classes and functions.</p>
</section>
<section id="helper-functions-to-avoid-textattack-issue">
<h3>Helper functions to avoid <code class="docutils literal notranslate"><span class="pre">textattack</span></code> issue<a class="headerlink" href="#helper-functions-to-avoid-textattack-issue" title="Permalink to this heading">#</a></h3>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Helper functions to avoid `textattack` issue</span>
<span class="o">!</span>pip<span class="w"> </span>install<span class="w"> </span>flair<span class="w"> </span>--quiet

<span class="kn">import</span><span class="w"> </span><span class="nn">flair</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">collections</span><span class="w"> </span><span class="kn">import</span> <span class="n">OrderedDict</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">flair.data</span><span class="w"> </span><span class="kn">import</span> <span class="n">Sentence</span>

<span class="sd">"""</span>
<span class="sd">Word Swap</span>
<span class="sd">-------------------------------</span>
<span class="sd">Word swap transformations act by</span>
<span class="sd">replacing some words in the input.</span>
<span class="sd">Subclasses can implement the abstract WordSwap class by</span>
<span class="sd">overriding self._get_replacement_words</span>
<span class="sd">"""</span>

<span class="k">def</span><span class="w"> </span><span class="nf">default_class_repr</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Formats given input</span>

<span class="sd">    Args:</span>
<span class="sd">      None</span>

<span class="sd">    Returns:</span>
<span class="sd">      Formatted string with additional parameters</span>
<span class="sd">    """</span>
    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">"extra_repr_keys"</span><span class="p">):</span>
        <span class="n">extra_params</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">extra_repr_keys</span><span class="p">():</span>
            <span class="n">extra_params</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">"  ("</span> <span class="o">+</span> <span class="n">key</span> <span class="o">+</span> <span class="s2">")"</span> <span class="o">+</span> <span class="s2">":  {"</span> <span class="o">+</span> <span class="n">key</span> <span class="o">+</span> <span class="s2">"}"</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">extra_params</span><span class="p">):</span>
            <span class="n">extra_str</span> <span class="o">=</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span> <span class="o">+</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">extra_params</span><span class="p">)</span> <span class="o">+</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span>
            <span class="n">extra_str</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">"(</span><span class="si">{</span><span class="n">extra_str</span><span class="si">}</span><span class="s2">)"</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">extra_str</span> <span class="o">=</span> <span class="s2">""</span>
        <span class="n">extra_str</span> <span class="o">=</span> <span class="n">extra_str</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">extra_str</span> <span class="o">=</span> <span class="s2">""</span>
    <span class="k">return</span> <span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}{</span><span class="n">extra_str</span><span class="si">}</span><span class="s2">"</span>


<span class="n">LABEL_COLORS</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">"red"</span><span class="p">,</span>
    <span class="s2">"green"</span><span class="p">,</span>
    <span class="s2">"blue"</span><span class="p">,</span>
    <span class="s2">"purple"</span><span class="p">,</span>
    <span class="s2">"yellow"</span><span class="p">,</span>
    <span class="s2">"orange"</span><span class="p">,</span>
    <span class="s2">"pink"</span><span class="p">,</span>
    <span class="s2">"cyan"</span><span class="p">,</span>
    <span class="s2">"gray"</span><span class="p">,</span>
    <span class="s2">"brown"</span><span class="p">,</span>
<span class="p">]</span>


<span class="k">class</span><span class="w"> </span><span class="nc">Transformation</span><span class="p">(</span><span class="n">ABC</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    An abstract class for transforming a sequence of text to produce a</span>
<span class="sd">    potential adversarial example.</span>
<span class="sd">    """</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">current_text</span><span class="p">,</span>
        <span class="n">pre_transformation_constraints</span><span class="o">=</span><span class="p">[],</span>
        <span class="n">indices_to_modify</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">shifted_idxs</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="p">):</span>
<span class="w">        </span><span class="sd">"""</span>
<span class="sd">        Applies the pre_transformation_constraints then calls</span>
<span class="sd">        _get_transformations.</span>

<span class="sd">        Args:</span>
<span class="sd">          current_text: String</span>
<span class="sd">            The AttackedText Object to transform.</span>
<span class="sd">          pre_transformation_constraints: List</span>
<span class="sd">            The PreTransformationConstraint to apply for cross-checking transformation compatibility.</span>
<span class="sd">          indices_to_modify: Integer</span>
<span class="sd">            Word indices to be modified as dictated by the SearchMethod.</span>
<span class="sd">          shifted_idxs: Boolean</span>
<span class="sd">            Indicates whether indices could be shifted from their original position in the text.</span>

<span class="sd">        Returns:</span>
<span class="sd">          transformed_texts: List</span>
<span class="sd">            Returns a list of all possible transformations for current_text.</span>
<span class="sd">        """</span>
        <span class="k">if</span> <span class="n">indices_to_modify</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">indices_to_modify</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">current_text</span><span class="o">.</span><span class="n">words</span><span class="p">)))</span>
            <span class="c1"># If we are modifying all indices, we don't care if some of the indices might have been shifted.</span>
            <span class="n">shifted_idxs</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">indices_to_modify</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">indices_to_modify</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">shifted_idxs</span><span class="p">:</span>
            <span class="n">indices_to_modify</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span>
                <span class="n">current_text</span><span class="o">.</span><span class="n">convert_from_original_idxs</span><span class="p">(</span><span class="n">indices_to_modify</span><span class="p">)</span>
            <span class="p">)</span>

        <span class="k">for</span> <span class="n">constraint</span> <span class="ow">in</span> <span class="n">pre_transformation_constraints</span><span class="p">:</span>
            <span class="n">indices_to_modify</span> <span class="o">=</span> <span class="n">indices_to_modify</span> <span class="o">&amp;</span> <span class="n">constraint</span><span class="p">(</span><span class="n">current_text</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="n">transformed_texts</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_transformations</span><span class="p">(</span><span class="n">current_text</span><span class="p">,</span> <span class="n">indices_to_modify</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">text</span> <span class="ow">in</span> <span class="n">transformed_texts</span><span class="p">:</span>
            <span class="n">text</span><span class="o">.</span><span class="n">attack_attrs</span><span class="p">[</span><span class="s2">"last_transformation"</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span>
        <span class="k">return</span> <span class="n">transformed_texts</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">_get_transformations</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">current_text</span><span class="p">,</span> <span class="n">indices_to_modify</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""</span>
<span class="sd">        Returns a list of all possible transformations for current_text,</span>
<span class="sd">        only modifying indices_to_modify.</span>
<span class="sd">        Must be overridden by specific transformations.</span>

<span class="sd">        Args:</span>
<span class="sd">          current_text: String</span>
<span class="sd">            The AttackedText Object to transform.</span>
<span class="sd">          indicies_to_modify: Integer</span>
<span class="sd">            Specifies word indices which can be modified.</span>

<span class="sd">        Returns:</span>
<span class="sd">          Nothing</span>
<span class="sd">        """</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">deterministic</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="kc">True</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">extra_repr_keys</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">[]</span>

    <span class="fm">__repr__</span> <span class="o">=</span> <span class="fm">__str__</span> <span class="o">=</span> <span class="n">default_class_repr</span>


<span class="k">class</span><span class="w"> </span><span class="nc">WordSwap</span><span class="p">(</span><span class="n">Transformation</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    An abstract class that takes a sentence and transforms it by replacing</span>
<span class="sd">    some of its words.</span>
<span class="sd">    """</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">letters_to_insert</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""</span>
<span class="sd">        Initializes following attributes</span>

<span class="sd">        Args:</span>
<span class="sd">          letters_to_insert: String</span>
<span class="sd">            Letters allowed for insertion into words (used by some char-based transformations)</span>

<span class="sd">        Returns:</span>
<span class="sd">          Nothing</span>
<span class="sd">        """</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">letters_to_insert</span> <span class="o">=</span> <span class="n">letters_to_insert</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">letters_to_insert</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">letters_to_insert</span> <span class="o">=</span> <span class="n">string</span><span class="o">.</span><span class="n">ascii_letters</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_get_replacement_words</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">word</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""</span>
<span class="sd">        Returns a set of replacements given an input word.</span>
<span class="sd">        Must be overriden by specific word swap transformations.</span>

<span class="sd">        Args:</span>
<span class="sd">          word: String</span>
<span class="sd">            The input word for which replacements are to be found.</span>

<span class="sd">        Returns:</span>
<span class="sd">          Nothing</span>
<span class="sd">        """</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_get_random_letter</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""</span>
<span class="sd">        Helper function that returns a random single letter from the English</span>
<span class="sd">        alphabet that could be lowercase or uppercase.</span>

<span class="sd">        Args:</span>
<span class="sd">          None</span>

<span class="sd">        Returns:</span>
<span class="sd">          Random Single Letter to simulate random-letter transformation</span>
<span class="sd">        """</span>
        <span class="k">return</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">letters_to_insert</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_get_transformations</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">current_text</span><span class="p">,</span> <span class="n">indices_to_modify</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""</span>
<span class="sd">        Returns a list of all possible transformations for current_text,</span>
<span class="sd">        only modifying indices_to_modify.</span>
<span class="sd">        Must be overridden by specific transformations.</span>

<span class="sd">        Args:</span>
<span class="sd">          current_text: String</span>
<span class="sd">            The AttackedText Object to transform.</span>
<span class="sd">          indicies_to_modify: Integer</span>
<span class="sd">            Which word indices can be modified.</span>

<span class="sd">        Returns:</span>
<span class="sd">          transformed_texts: List</span>
<span class="sd">            List of all transformed texts i.e., index at which transformation was applied</span>
<span class="sd">        """</span>
        <span class="n">words</span> <span class="o">=</span> <span class="n">current_text</span><span class="o">.</span><span class="n">words</span>
        <span class="n">transformed_texts</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">indices_to_modify</span><span class="p">:</span>
            <span class="n">word_to_replace</span> <span class="o">=</span> <span class="n">words</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="n">replacement_words</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_replacement_words</span><span class="p">(</span><span class="n">word_to_replace</span><span class="p">)</span>
            <span class="n">transformed_texts_idx</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">replacement_words</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">r</span> <span class="o">==</span> <span class="n">word_to_replace</span><span class="p">:</span>
                    <span class="k">continue</span>
                <span class="n">transformed_texts_idx</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">current_text</span><span class="o">.</span><span class="n">replace_word_at_index</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">r</span><span class="p">))</span>
            <span class="n">transformed_texts</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">transformed_texts_idx</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">transformed_texts</span>


<span class="k">class</span><span class="w"> </span><span class="nc">WordSwapQWERTY</span><span class="p">(</span><span class="n">WordSwap</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    A transformation that swaps characters with adjacent keys on a</span>
<span class="sd">    QWERTY keyboard, replicating the kind of errors that come from typing</span>
<span class="sd">    too quickly.</span>
<span class="sd">    """</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">random_one</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">skip_first_char</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">skip_last_char</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">"""</span>
<span class="sd">        Initiates the following attributes</span>

<span class="sd">        Args:</span>
<span class="sd">          random_one: Boolean</span>
<span class="sd">            Specifies whether to return a single (random) swap, or all possible swaps.</span>
<span class="sd">          skip_first_char: Boolean</span>
<span class="sd">            When True, do not modify the first character of each word.</span>
<span class="sd">          skip_last_char: Boolean</span>
<span class="sd">            When True, do not modify the last character of each word.</span>

<span class="sd">        Usage/Example:</span>
<span class="sd">          &gt;&gt;&gt; from textattack.transformations import WordSwapQWERTY</span>
<span class="sd">          &gt;&gt;&gt; from textattack.augmentation import Augmenter</span>
<span class="sd">          &gt;&gt;&gt; transformation = WordSwapQWERT()</span>
<span class="sd">          &gt;&gt;&gt; augmenter = Augmenter(transformation=transformation)</span>
<span class="sd">          &gt;&gt;&gt; s = 'I am fabulous.'</span>
<span class="sd">          &gt;&gt;&gt; augmenter.augment(s)</span>

<span class="sd">        Returns:</span>
<span class="sd">          Nothing</span>
<span class="sd">        """</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">random_one</span> <span class="o">=</span> <span class="n">random_one</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">skip_first_char</span> <span class="o">=</span> <span class="n">skip_first_char</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">skip_last_char</span> <span class="o">=</span> <span class="n">skip_last_char</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_keyboard_adjacency</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">"q"</span><span class="p">:</span> <span class="p">[</span>
                <span class="s2">"w"</span><span class="p">,</span>
                <span class="s2">"a"</span><span class="p">,</span>
                <span class="s2">"s"</span><span class="p">,</span>
            <span class="p">],</span>
            <span class="s2">"w"</span><span class="p">:</span> <span class="p">[</span><span class="s2">"q"</span><span class="p">,</span> <span class="s2">"e"</span><span class="p">,</span> <span class="s2">"a"</span><span class="p">,</span> <span class="s2">"s"</span><span class="p">,</span> <span class="s2">"d"</span><span class="p">],</span>
            <span class="s2">"e"</span><span class="p">:</span> <span class="p">[</span><span class="s2">"w"</span><span class="p">,</span> <span class="s2">"s"</span><span class="p">,</span> <span class="s2">"d"</span><span class="p">,</span> <span class="s2">"f"</span><span class="p">,</span> <span class="s2">"r"</span><span class="p">],</span>
            <span class="s2">"r"</span><span class="p">:</span> <span class="p">[</span><span class="s2">"e"</span><span class="p">,</span> <span class="s2">"d"</span><span class="p">,</span> <span class="s2">"f"</span><span class="p">,</span> <span class="s2">"g"</span><span class="p">,</span> <span class="s2">"t"</span><span class="p">],</span>
            <span class="s2">"t"</span><span class="p">:</span> <span class="p">[</span><span class="s2">"r"</span><span class="p">,</span> <span class="s2">"f"</span><span class="p">,</span> <span class="s2">"g"</span><span class="p">,</span> <span class="s2">"h"</span><span class="p">,</span> <span class="s2">"y"</span><span class="p">],</span>
            <span class="s2">"y"</span><span class="p">:</span> <span class="p">[</span><span class="s2">"t"</span><span class="p">,</span> <span class="s2">"g"</span><span class="p">,</span> <span class="s2">"h"</span><span class="p">,</span> <span class="s2">"j"</span><span class="p">,</span> <span class="s2">"u"</span><span class="p">],</span>
            <span class="s2">"u"</span><span class="p">:</span> <span class="p">[</span><span class="s2">"y"</span><span class="p">,</span> <span class="s2">"h"</span><span class="p">,</span> <span class="s2">"j"</span><span class="p">,</span> <span class="s2">"k"</span><span class="p">,</span> <span class="s2">"i"</span><span class="p">],</span>
            <span class="s2">"i"</span><span class="p">:</span> <span class="p">[</span><span class="s2">"u"</span><span class="p">,</span> <span class="s2">"j"</span><span class="p">,</span> <span class="s2">"k"</span><span class="p">,</span> <span class="s2">"l"</span><span class="p">,</span> <span class="s2">"o"</span><span class="p">],</span>
            <span class="s2">"o"</span><span class="p">:</span> <span class="p">[</span><span class="s2">"i"</span><span class="p">,</span> <span class="s2">"k"</span><span class="p">,</span> <span class="s2">"l"</span><span class="p">,</span> <span class="s2">"p"</span><span class="p">],</span>
            <span class="s2">"p"</span><span class="p">:</span> <span class="p">[</span><span class="s2">"o"</span><span class="p">,</span> <span class="s2">"l"</span><span class="p">],</span>
            <span class="s2">"a"</span><span class="p">:</span> <span class="p">[</span><span class="s2">"q"</span><span class="p">,</span> <span class="s2">"w"</span><span class="p">,</span> <span class="s2">"s"</span><span class="p">,</span> <span class="s2">"z"</span><span class="p">,</span> <span class="s2">"x"</span><span class="p">],</span>
            <span class="s2">"s"</span><span class="p">:</span> <span class="p">[</span><span class="s2">"q"</span><span class="p">,</span> <span class="s2">"w"</span><span class="p">,</span> <span class="s2">"e"</span><span class="p">,</span> <span class="s2">"a"</span><span class="p">,</span> <span class="s2">"d"</span><span class="p">,</span> <span class="s2">"z"</span><span class="p">,</span> <span class="s2">"x"</span><span class="p">],</span>
            <span class="s2">"d"</span><span class="p">:</span> <span class="p">[</span><span class="s2">"w"</span><span class="p">,</span> <span class="s2">"e"</span><span class="p">,</span> <span class="s2">"r"</span><span class="p">,</span> <span class="s2">"f"</span><span class="p">,</span> <span class="s2">"c"</span><span class="p">,</span> <span class="s2">"x"</span><span class="p">,</span> <span class="s2">"s"</span><span class="p">],</span>
            <span class="s2">"f"</span><span class="p">:</span> <span class="p">[</span><span class="s2">"e"</span><span class="p">,</span> <span class="s2">"r"</span><span class="p">,</span> <span class="s2">"t"</span><span class="p">,</span> <span class="s2">"g"</span><span class="p">,</span> <span class="s2">"v"</span><span class="p">,</span> <span class="s2">"c"</span><span class="p">,</span> <span class="s2">"d"</span><span class="p">],</span>
            <span class="s2">"g"</span><span class="p">:</span> <span class="p">[</span><span class="s2">"r"</span><span class="p">,</span> <span class="s2">"t"</span><span class="p">,</span> <span class="s2">"y"</span><span class="p">,</span> <span class="s2">"h"</span><span class="p">,</span> <span class="s2">"b"</span><span class="p">,</span> <span class="s2">"v"</span><span class="p">,</span> <span class="s2">"d"</span><span class="p">],</span>
            <span class="s2">"h"</span><span class="p">:</span> <span class="p">[</span><span class="s2">"t"</span><span class="p">,</span> <span class="s2">"y"</span><span class="p">,</span> <span class="s2">"u"</span><span class="p">,</span> <span class="s2">"g"</span><span class="p">,</span> <span class="s2">"j"</span><span class="p">,</span> <span class="s2">"b"</span><span class="p">,</span> <span class="s2">"n"</span><span class="p">],</span>
            <span class="s2">"j"</span><span class="p">:</span> <span class="p">[</span><span class="s2">"y"</span><span class="p">,</span> <span class="s2">"u"</span><span class="p">,</span> <span class="s2">"i"</span><span class="p">,</span> <span class="s2">"k"</span><span class="p">,</span> <span class="s2">"m"</span><span class="p">,</span> <span class="s2">"n"</span><span class="p">,</span> <span class="s2">"h"</span><span class="p">],</span>
            <span class="s2">"k"</span><span class="p">:</span> <span class="p">[</span><span class="s2">"u"</span><span class="p">,</span> <span class="s2">"i"</span><span class="p">,</span> <span class="s2">"o"</span><span class="p">,</span> <span class="s2">"l"</span><span class="p">,</span> <span class="s2">"m"</span><span class="p">,</span> <span class="s2">"j"</span><span class="p">],</span>
            <span class="s2">"l"</span><span class="p">:</span> <span class="p">[</span><span class="s2">"i"</span><span class="p">,</span> <span class="s2">"o"</span><span class="p">,</span> <span class="s2">"p"</span><span class="p">,</span> <span class="s2">"k"</span><span class="p">],</span>
            <span class="s2">"z"</span><span class="p">:</span> <span class="p">[</span><span class="s2">"a"</span><span class="p">,</span> <span class="s2">"s"</span><span class="p">,</span> <span class="s2">"x"</span><span class="p">],</span>
            <span class="s2">"x"</span><span class="p">:</span> <span class="p">[</span><span class="s2">"s"</span><span class="p">,</span> <span class="s2">"d"</span><span class="p">,</span> <span class="s2">"z"</span><span class="p">,</span> <span class="s2">"c"</span><span class="p">],</span>
            <span class="s2">"c"</span><span class="p">:</span> <span class="p">[</span><span class="s2">"x"</span><span class="p">,</span> <span class="s2">"d"</span><span class="p">,</span> <span class="s2">"f"</span><span class="p">,</span> <span class="s2">"v"</span><span class="p">],</span>
            <span class="s2">"v"</span><span class="p">:</span> <span class="p">[</span><span class="s2">"c"</span><span class="p">,</span> <span class="s2">"f"</span><span class="p">,</span> <span class="s2">"g"</span><span class="p">,</span> <span class="s2">"b"</span><span class="p">],</span>
            <span class="s2">"b"</span><span class="p">:</span> <span class="p">[</span><span class="s2">"v"</span><span class="p">,</span> <span class="s2">"g"</span><span class="p">,</span> <span class="s2">"h"</span><span class="p">,</span> <span class="s2">"n"</span><span class="p">],</span>
            <span class="s2">"n"</span><span class="p">:</span> <span class="p">[</span><span class="s2">"b"</span><span class="p">,</span> <span class="s2">"h"</span><span class="p">,</span> <span class="s2">"j"</span><span class="p">,</span> <span class="s2">"m"</span><span class="p">],</span>
            <span class="s2">"m"</span><span class="p">:</span> <span class="p">[</span><span class="s2">"n"</span><span class="p">,</span> <span class="s2">"j"</span><span class="p">,</span> <span class="s2">"k"</span><span class="p">],</span>
        <span class="p">}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_get_adjacent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""</span>
<span class="sd">        Helper function to extract keys adjacent to given input key</span>

<span class="sd">        Args:</span>
<span class="sd">          s: String</span>
<span class="sd">            Letter for which adjacent keys are to be queried</span>

<span class="sd">        Returns:</span>
<span class="sd">          adjacent_keys: List</span>
<span class="sd">            List of co-occuring keys with respect to input</span>
<span class="sd">        """</span>
        <span class="n">s_lower</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">s_lower</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_keyboard_adjacency</span><span class="p">:</span>
            <span class="n">adjacent_keys</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_keyboard_adjacency</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">s_lower</span><span class="p">,</span> <span class="p">[])</span>
            <span class="k">if</span> <span class="n">s</span><span class="o">.</span><span class="n">isupper</span><span class="p">():</span>
                <span class="k">return</span> <span class="p">[</span><span class="n">key</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">adjacent_keys</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">adjacent_keys</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_get_replacement_words</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">word</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""</span>
<span class="sd">        Helper function to find candidate words with respect to given input key.</span>
<span class="sd">        Candidate words are words selected based on nearest neighbors</span>
<span class="sd">        with scope for subsequent swapping.</span>

<span class="sd">        Args:</span>
<span class="sd">          word: String</span>
<span class="sd">            Word for which candidate words are to be generated.</span>

<span class="sd">        Returns:</span>
<span class="sd">          candidate_words: List</span>
<span class="sd">            List of candidate words with respect to input word.</span>
<span class="sd">        """</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">word</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[]</span>

        <span class="n">candidate_words</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="n">start_idx</span> <span class="o">=</span> <span class="mi">1</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">skip_first_char</span> <span class="k">else</span> <span class="mi">0</span>
        <span class="n">end_idx</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">word</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">skip_last_char</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">start_idx</span> <span class="o">&gt;=</span> <span class="n">end_idx</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[]</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">random_one</span><span class="p">:</span>
            <span class="n">i</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randrange</span><span class="p">(</span><span class="n">start_idx</span><span class="p">,</span> <span class="n">end_idx</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">candidate_word</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">word</span><span class="p">[:</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_adjacent</span><span class="p">(</span><span class="n">word</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span> <span class="o">+</span> <span class="n">word</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="p">:]</span>
            <span class="p">)</span>
            <span class="n">candidate_words</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">candidate_word</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">start_idx</span><span class="p">,</span> <span class="n">end_idx</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">swap_key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_adjacent</span><span class="p">(</span><span class="n">word</span><span class="p">[</span><span class="n">i</span><span class="p">]):</span>
                    <span class="n">candidate_word</span> <span class="o">=</span> <span class="n">word</span><span class="p">[:</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">swap_key</span> <span class="o">+</span> <span class="n">word</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="p">:]</span>
                    <span class="n">candidate_words</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">candidate_word</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">candidate_words</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">deterministic</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">random_one</span>


<span class="n">EXTENSION_MAP</span> <span class="o">=</span> <span class="p">{</span><span class="s2">"ain't"</span><span class="p">:</span> <span class="s2">"isn't"</span><span class="p">,</span> <span class="s2">"aren't"</span><span class="p">:</span> <span class="s1">'are not'</span><span class="p">,</span> <span class="s2">"can't"</span><span class="p">:</span> <span class="s1">'cannot'</span><span class="p">,</span> <span class="s2">"can't've"</span><span class="p">:</span> <span class="s1">'cannot have'</span><span class="p">,</span> <span class="s2">"could've"</span><span class="p">:</span> <span class="s1">'could have'</span><span class="p">,</span> <span class="s2">"couldn't"</span><span class="p">:</span> <span class="s1">'could not'</span><span class="p">,</span> <span class="s2">"didn't"</span><span class="p">:</span> <span class="s1">'did not'</span><span class="p">,</span> <span class="s2">"doesn't"</span><span class="p">:</span> <span class="s1">'does not'</span><span class="p">,</span> <span class="s2">"don't"</span><span class="p">:</span> <span class="s1">'do not'</span><span class="p">,</span> <span class="s2">"hadn't"</span><span class="p">:</span> <span class="s1">'had not'</span><span class="p">,</span> <span class="s2">"hasn't"</span><span class="p">:</span> <span class="s1">'has not'</span><span class="p">,</span> <span class="s2">"haven't"</span><span class="p">:</span> <span class="s1">'have not'</span><span class="p">,</span> <span class="s2">"he'd"</span><span class="p">:</span> <span class="s1">'he would'</span><span class="p">,</span> <span class="s2">"he'd've"</span><span class="p">:</span> <span class="s1">'he would have'</span><span class="p">,</span> <span class="s2">"he'll"</span><span class="p">:</span> <span class="s1">'he will'</span><span class="p">,</span> <span class="s2">"he's"</span><span class="p">:</span> <span class="s1">'he is'</span><span class="p">,</span> <span class="s2">"how'd"</span><span class="p">:</span> <span class="s1">'how did'</span><span class="p">,</span> <span class="s2">"how'd'y"</span><span class="p">:</span> <span class="s1">'how do you'</span><span class="p">,</span> <span class="s2">"how'll"</span><span class="p">:</span> <span class="s1">'how will'</span><span class="p">,</span> <span class="s2">"how's"</span><span class="p">:</span> <span class="s1">'how is'</span><span class="p">,</span> <span class="s2">"I'd"</span><span class="p">:</span> <span class="s1">'I would'</span><span class="p">,</span> <span class="s2">"I'll"</span><span class="p">:</span> <span class="s1">'I will'</span><span class="p">,</span> <span class="s2">"I'm"</span><span class="p">:</span> <span class="s1">'I am'</span><span class="p">,</span> <span class="s2">"I've"</span><span class="p">:</span> <span class="s1">'I have'</span><span class="p">,</span> <span class="s2">"i'd"</span><span class="p">:</span> <span class="s1">'i would'</span><span class="p">,</span> <span class="s2">"i'll"</span><span class="p">:</span> <span class="s1">'i will'</span><span class="p">,</span> <span class="s2">"i'm"</span><span class="p">:</span> <span class="s1">'i am'</span><span class="p">,</span> <span class="s2">"i've"</span><span class="p">:</span> <span class="s1">'i have'</span><span class="p">,</span> <span class="s2">"isn't"</span><span class="p">:</span> <span class="s1">'is not'</span><span class="p">,</span> <span class="s2">"it'd"</span><span class="p">:</span> <span class="s1">'it would'</span><span class="p">,</span> <span class="s2">"it'll"</span><span class="p">:</span> <span class="s1">'it will'</span><span class="p">,</span> <span class="s2">"it's"</span><span class="p">:</span> <span class="s1">'it is'</span><span class="p">,</span> <span class="s2">"ma'am"</span><span class="p">:</span> <span class="s1">'madam'</span><span class="p">,</span> <span class="s2">"might've"</span><span class="p">:</span> <span class="s1">'might have'</span><span class="p">,</span> <span class="s2">"mightn't"</span><span class="p">:</span> <span class="s1">'might not'</span><span class="p">,</span> <span class="s2">"must've"</span><span class="p">:</span> <span class="s1">'must have'</span><span class="p">,</span> <span class="s2">"mustn't"</span><span class="p">:</span> <span class="s1">'must not'</span><span class="p">,</span> <span class="s2">"needn't"</span><span class="p">:</span> <span class="s1">'need not'</span><span class="p">,</span> <span class="s2">"oughtn't"</span><span class="p">:</span> <span class="s1">'ought not'</span><span class="p">,</span> <span class="s2">"shan't"</span><span class="p">:</span> <span class="s1">'shall not'</span><span class="p">,</span> <span class="s2">"she'd"</span><span class="p">:</span> <span class="s1">'she would'</span><span class="p">,</span> <span class="s2">"she'll"</span><span class="p">:</span> <span class="s1">'she will'</span><span class="p">,</span> <span class="s2">"she's"</span><span class="p">:</span> <span class="s1">'she is'</span><span class="p">,</span> <span class="s2">"should've"</span><span class="p">:</span> <span class="s1">'should have'</span><span class="p">,</span> <span class="s2">"shouldn't"</span><span class="p">:</span> <span class="s1">'should not'</span><span class="p">,</span> <span class="s2">"that'd"</span><span class="p">:</span> <span class="s1">'that would'</span><span class="p">,</span> <span class="s2">"that's"</span><span class="p">:</span> <span class="s1">'that is'</span><span class="p">,</span> <span class="s2">"there'd"</span><span class="p">:</span> <span class="s1">'there would'</span><span class="p">,</span> <span class="s2">"there's"</span><span class="p">:</span> <span class="s1">'there is'</span><span class="p">,</span> <span class="s2">"they'd"</span><span class="p">:</span> <span class="s1">'they would'</span><span class="p">,</span> <span class="s2">"they'll"</span><span class="p">:</span> <span class="s1">'they will'</span><span class="p">,</span> <span class="s2">"they're"</span><span class="p">:</span> <span class="s1">'they are'</span><span class="p">,</span> <span class="s2">"they've"</span><span class="p">:</span> <span class="s1">'they have'</span><span class="p">,</span> <span class="s2">"wasn't"</span><span class="p">:</span> <span class="s1">'was not'</span><span class="p">,</span> <span class="s2">"we'd"</span><span class="p">:</span> <span class="s1">'we would'</span><span class="p">,</span> <span class="s2">"we'll"</span><span class="p">:</span> <span class="s1">'we will'</span><span class="p">,</span> <span class="s2">"we're"</span><span class="p">:</span> <span class="s1">'we are'</span><span class="p">,</span> <span class="s2">"we've"</span><span class="p">:</span> <span class="s1">'we have'</span><span class="p">,</span> <span class="s2">"weren't"</span><span class="p">:</span> <span class="s1">'were not'</span><span class="p">,</span> <span class="s2">"what're"</span><span class="p">:</span> <span class="s1">'what are'</span><span class="p">,</span> <span class="s2">"what's"</span><span class="p">:</span> <span class="s1">'what is'</span><span class="p">,</span> <span class="s2">"when's"</span><span class="p">:</span> <span class="s1">'when is'</span><span class="p">,</span> <span class="s2">"where'd"</span><span class="p">:</span> <span class="s1">'where did'</span><span class="p">,</span> <span class="s2">"where's"</span><span class="p">:</span> <span class="s1">'where is'</span><span class="p">,</span> <span class="s2">"where've"</span><span class="p">:</span> <span class="s1">'where have'</span><span class="p">,</span> <span class="s2">"who'll"</span><span class="p">:</span> <span class="s1">'who will'</span><span class="p">,</span> <span class="s2">"who's"</span><span class="p">:</span> <span class="s1">'who is'</span><span class="p">,</span> <span class="s2">"who've"</span><span class="p">:</span> <span class="s1">'who have'</span><span class="p">,</span> <span class="s2">"why's"</span><span class="p">:</span> <span class="s1">'why is'</span><span class="p">,</span> <span class="s2">"won't"</span><span class="p">:</span> <span class="s1">'will not'</span><span class="p">,</span> <span class="s2">"would've"</span><span class="p">:</span> <span class="s1">'would have'</span><span class="p">,</span> <span class="s2">"wouldn't"</span><span class="p">:</span> <span class="s1">'would not'</span><span class="p">,</span> <span class="s2">"you'd"</span><span class="p">:</span> <span class="s1">'you would'</span><span class="p">,</span> <span class="s2">"you'd've"</span><span class="p">:</span> <span class="s1">'you would have'</span><span class="p">,</span> <span class="s2">"you'll"</span><span class="p">:</span> <span class="s1">'you will'</span><span class="p">,</span> <span class="s2">"you're"</span><span class="p">:</span> <span class="s1">'you are'</span><span class="p">,</span> <span class="s2">"you've"</span><span class="p">:</span> <span class="s1">'you have'</span><span class="p">}</span>


<span class="k">class</span><span class="w"> </span><span class="nc">WordSwap</span><span class="p">(</span><span class="n">Transformation</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    An abstract class that takes a sentence and transforms it by replacing</span>
<span class="sd">    some of its words.</span>
<span class="sd">    """</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">letters_to_insert</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""</span>
<span class="sd">        Initiates the following attributes</span>

<span class="sd">        Args:</span>
<span class="sd">          letters_to_insert: String</span>
<span class="sd">            Letters allowed for insertion into words</span>
<span class="sd">            (used by some char-based transformations)</span>

<span class="sd">        Returns:</span>
<span class="sd">          Nothing</span>
<span class="sd">        """</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">letters_to_insert</span> <span class="o">=</span> <span class="n">letters_to_insert</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">letters_to_insert</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">letters_to_insert</span> <span class="o">=</span> <span class="n">string</span><span class="o">.</span><span class="n">ascii_letters</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_get_replacement_words</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">word</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""</span>
<span class="sd">        Returns a set of replacements given an input word.</span>
<span class="sd">        Must be overridden by specific word swap transformations.</span>

<span class="sd">        Args:</span>
<span class="sd">          word: String</span>
<span class="sd">            The input word to find replacements for.</span>

<span class="sd">        Returns:</span>
<span class="sd">          Nothing</span>
<span class="sd">        """</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_get_random_letter</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""</span>
<span class="sd">        Helper function that returns a random single letter from the English</span>
<span class="sd">        alphabet that could be lowercase or uppercase.</span>

<span class="sd">        Args:</span>
<span class="sd">          None</span>

<span class="sd">        Returns:</span>
<span class="sd">          Random single letter for random-letter transformation</span>
<span class="sd">        """</span>
        <span class="k">return</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">letters_to_insert</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_get_transformations</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">current_text</span><span class="p">,</span> <span class="n">indices_to_modify</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""</span>
<span class="sd">        Returns a list of all possible transformations for current_text,</span>
<span class="sd">        only modifying indices_to_modify.</span>
<span class="sd">        Must be overridden by specific transformations.</span>

<span class="sd">        Args:</span>
<span class="sd">          current_text: String</span>
<span class="sd">            The AttackedText Object to transform.</span>
<span class="sd">          indicies_to_modify: Integer</span>
<span class="sd">            Which word indices can be modified.</span>

<span class="sd">        Returns:</span>
<span class="sd">          transformed_texts: List</span>
<span class="sd">            List of all transformed texts with indexes at which transformation was applied</span>
<span class="sd">        """</span>
        <span class="n">words</span> <span class="o">=</span> <span class="n">current_text</span><span class="o">.</span><span class="n">words</span>
        <span class="n">transformed_texts</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">indices_to_modify</span><span class="p">:</span>
            <span class="n">word_to_replace</span> <span class="o">=</span> <span class="n">words</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="n">replacement_words</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_replacement_words</span><span class="p">(</span><span class="n">word_to_replace</span><span class="p">)</span>
            <span class="n">transformed_texts_idx</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">replacement_words</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">r</span> <span class="o">==</span> <span class="n">word_to_replace</span><span class="p">:</span>
                    <span class="k">continue</span>
                <span class="n">transformed_texts_idx</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">current_text</span><span class="o">.</span><span class="n">replace_word_at_index</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">r</span><span class="p">))</span>
            <span class="n">transformed_texts</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">transformed_texts_idx</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">transformed_texts</span>


<span class="k">class</span><span class="w"> </span><span class="nc">WordSwapExtend</span><span class="p">(</span><span class="n">WordSwap</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Transforms an input by performing extension on recognized</span>
<span class="sd">    combinations.</span>
<span class="sd">    """</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_get_transformations</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">current_text</span><span class="p">,</span> <span class="n">indices_to_modify</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""</span>
<span class="sd">        Return all possible transformed sentences, each with one extension.</span>

<span class="sd">        Args:</span>
<span class="sd">          current_text: String</span>
<span class="sd">            The AttackedText Object to transform.</span>
<span class="sd">          indicies_to_modify: Integer</span>
<span class="sd">            Which word indices can be modified.</span>

<span class="sd">        Returns:</span>
<span class="sd">          transformed_texts: List</span>
<span class="sd">            List of all transformed texts based on extension map</span>

<span class="sd">        Usage/Examples:</span>
<span class="sd">        &gt;&gt;&gt; from textattack.transformations import WordSwapExtend</span>
<span class="sd">        &gt;&gt;&gt; from textattack.augmentation import Augmenter</span>
<span class="sd">        &gt;&gt;&gt; transformation = WordSwapExtend()</span>
<span class="sd">        &gt;&gt;&gt; augmenter = Augmenter(transformation=transformation)</span>
<span class="sd">        &gt;&gt;&gt; s = '''I'm fabulous'''</span>
<span class="sd">        &gt;&gt;&gt; augmenter.augment(s)</span>
<span class="sd">        """</span>
        <span class="n">transformed_texts</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">words</span> <span class="o">=</span> <span class="n">current_text</span><span class="o">.</span><span class="n">words</span>
        <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="n">indices_to_modify</span><span class="p">:</span>
            <span class="n">word</span> <span class="o">=</span> <span class="n">words</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
            <span class="c1"># expend when word in map</span>
            <span class="k">if</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">EXTENSION_MAP</span><span class="p">:</span>
                <span class="n">expanded</span> <span class="o">=</span> <span class="n">EXTENSION_MAP</span><span class="p">[</span><span class="n">word</span><span class="p">]</span>
                <span class="n">transformed_text</span> <span class="o">=</span> <span class="n">current_text</span><span class="o">.</span><span class="n">replace_word_at_index</span><span class="p">(</span><span class="n">idx</span><span class="p">,</span> <span class="n">expanded</span><span class="p">)</span>
                <span class="n">transformed_texts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">transformed_text</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">transformed_texts</span>


<span class="k">class</span><span class="w"> </span><span class="nc">WordSwapContract</span><span class="p">(</span><span class="n">WordSwap</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Transforms an input by performing contraction on recognized</span>
<span class="sd">    combinations.</span>
<span class="sd">    """</span>

    <span class="n">reverse_contraction_map</span> <span class="o">=</span> <span class="p">{</span><span class="n">v</span><span class="p">:</span> <span class="n">k</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">EXTENSION_MAP</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_get_transformations</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">current_text</span><span class="p">,</span> <span class="n">indices_to_modify</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""</span>
<span class="sd">        Return all possible transformed sentences, each with one</span>
<span class="sd">        contraction.</span>

<span class="sd">        Args:</span>
<span class="sd">          current_text: String</span>
<span class="sd">            The AttackedText Object to transform.</span>
<span class="sd">          indicies_to_modify: Integer</span>
<span class="sd">            Which word indices can be modified.</span>

<span class="sd">        Returns:</span>
<span class="sd">          transformed_texts: List</span>
<span class="sd">            List of all transformed texts based on reverse contraction map</span>

<span class="sd">        Usage/Example:</span>
<span class="sd">        &gt;&gt;&gt; from textattack.transformations import WordSwapContract</span>
<span class="sd">        &gt;&gt;&gt; from textattack.augmentation import Augmenter</span>
<span class="sd">        &gt;&gt;&gt; transformation = WordSwapContract()</span>
<span class="sd">        &gt;&gt;&gt; augmenter = Augmenter(transformation=transformation)</span>
<span class="sd">        &gt;&gt;&gt; s = 'I am 12 years old.'</span>
<span class="sd">        &gt;&gt;&gt; augmenter.augment(s)</span>
<span class="sd">        """</span>
        <span class="n">transformed_texts</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="n">words</span> <span class="o">=</span> <span class="n">current_text</span><span class="o">.</span><span class="n">words</span>
        <span class="n">indices_to_modify</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">indices_to_modify</span><span class="p">)</span>

        <span class="c1"># search for every 2-words combination in reverse_contraction_map</span>
        <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">word_idx</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">indices_to_modify</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]):</span>
            <span class="n">next_idx</span> <span class="o">=</span> <span class="n">indices_to_modify</span><span class="p">[</span><span class="n">idx</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">idx</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">!=</span> <span class="n">next_idx</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="n">word</span> <span class="o">=</span> <span class="n">words</span><span class="p">[</span><span class="n">word_idx</span><span class="p">]</span>
            <span class="n">next_word</span> <span class="o">=</span> <span class="n">words</span><span class="p">[</span><span class="n">next_idx</span><span class="p">]</span>

            <span class="c1"># generating the words to search for</span>
            <span class="n">key</span> <span class="o">=</span> <span class="s2">" "</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">word</span><span class="p">,</span> <span class="n">next_word</span><span class="p">])</span>

            <span class="c1"># when a possible contraction is found in map, contract the current text</span>
            <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">reverse_contraction_map</span><span class="p">:</span>
                <span class="n">transformed_text</span> <span class="o">=</span> <span class="n">current_text</span><span class="o">.</span><span class="n">replace_word_at_index</span><span class="p">(</span>
                    <span class="n">idx</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">reverse_contraction_map</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
                <span class="p">)</span>
                <span class="n">transformed_text</span> <span class="o">=</span> <span class="n">transformed_text</span><span class="o">.</span><span class="n">delete_word_at_index</span><span class="p">(</span><span class="n">next_idx</span><span class="p">)</span>
                <span class="n">transformed_texts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">transformed_text</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">transformed_texts</span>


<span class="k">class</span><span class="w"> </span><span class="nc">WordSwapHomoglyphSwap</span><span class="p">(</span><span class="n">WordSwap</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Transforms an input by replacing its words with visually similar words</span>
<span class="sd">    using homoglyph swaps.</span>
<span class="sd">    A homoglyph is one of two or more graphemes, characters, or glyphs</span>
<span class="sd">    with shapes that appear identical or very similar.</span>
<span class="sd">    """</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">random_one</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""</span>
<span class="sd">        Initiates the following attributes</span>

<span class="sd">        Args:</span>
<span class="sd">          random_one: Boolean</span>
<span class="sd">            Choosing random substring for transformation</span>

<span class="sd">        Returns:</span>
<span class="sd">          Nothing</span>

<span class="sd">        Usage/Examples:</span>
<span class="sd">          &gt;&gt;&gt; from textattack.transformations import WordSwapHomoglyphSwap</span>
<span class="sd">          &gt;&gt;&gt; from textattack.augmentation import Augmenter</span>
<span class="sd">          &gt;&gt;&gt; transformation = WordSwapHomoglyphSwap()</span>
<span class="sd">          &gt;&gt;&gt; augmenter = Augmenter(transformation=transformation)</span>
<span class="sd">          &gt;&gt;&gt; s = 'I am fabulous.'</span>
<span class="sd">          &gt;&gt;&gt; augmenter.augment(s)</span>
<span class="sd">        """</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">homos</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">"-"</span><span class="p">:</span> <span class="s2">"˗"</span><span class="p">,</span>
            <span class="s2">"9"</span><span class="p">:</span> <span class="s2">"৭"</span><span class="p">,</span>
            <span class="s2">"8"</span><span class="p">:</span> <span class="s2">"Ȣ"</span><span class="p">,</span>
            <span class="s2">"7"</span><span class="p">:</span> <span class="s2">"𝟕"</span><span class="p">,</span>
            <span class="s2">"6"</span><span class="p">:</span> <span class="s2">"б"</span><span class="p">,</span>
            <span class="s2">"5"</span><span class="p">:</span> <span class="s2">"Ƽ"</span><span class="p">,</span>
            <span class="s2">"4"</span><span class="p">:</span> <span class="s2">"Ꮞ"</span><span class="p">,</span>
            <span class="s2">"3"</span><span class="p">:</span> <span class="s2">"Ʒ"</span><span class="p">,</span>
            <span class="s2">"2"</span><span class="p">:</span> <span class="s2">"ᒿ"</span><span class="p">,</span>
            <span class="s2">"1"</span><span class="p">:</span> <span class="s2">"l"</span><span class="p">,</span>
            <span class="s2">"0"</span><span class="p">:</span> <span class="s2">"O"</span><span class="p">,</span>
            <span class="s2">"'"</span><span class="p">:</span> <span class="s2">"`"</span><span class="p">,</span>
            <span class="s2">"a"</span><span class="p">:</span> <span class="s2">"ɑ"</span><span class="p">,</span>
            <span class="s2">"b"</span><span class="p">:</span> <span class="s2">"Ь"</span><span class="p">,</span>
            <span class="s2">"c"</span><span class="p">:</span> <span class="s2">"ϲ"</span><span class="p">,</span>
            <span class="s2">"d"</span><span class="p">:</span> <span class="s2">"ԁ"</span><span class="p">,</span>
            <span class="s2">"e"</span><span class="p">:</span> <span class="s2">"е"</span><span class="p">,</span>
            <span class="s2">"f"</span><span class="p">:</span> <span class="s2">"𝚏"</span><span class="p">,</span>
            <span class="s2">"g"</span><span class="p">:</span> <span class="s2">"ɡ"</span><span class="p">,</span>
            <span class="s2">"h"</span><span class="p">:</span> <span class="s2">"հ"</span><span class="p">,</span>
            <span class="s2">"i"</span><span class="p">:</span> <span class="s2">"і"</span><span class="p">,</span>
            <span class="s2">"j"</span><span class="p">:</span> <span class="s2">"ϳ"</span><span class="p">,</span>
            <span class="s2">"k"</span><span class="p">:</span> <span class="s2">"𝒌"</span><span class="p">,</span>
            <span class="s2">"l"</span><span class="p">:</span> <span class="s2">"ⅼ"</span><span class="p">,</span>
            <span class="s2">"m"</span><span class="p">:</span> <span class="s2">"ｍ"</span><span class="p">,</span>
            <span class="s2">"n"</span><span class="p">:</span> <span class="s2">"ո"</span><span class="p">,</span>
            <span class="s2">"o"</span><span class="p">:</span> <span class="s2">"о"</span><span class="p">,</span>
            <span class="s2">"p"</span><span class="p">:</span> <span class="s2">"р"</span><span class="p">,</span>
            <span class="s2">"q"</span><span class="p">:</span> <span class="s2">"ԛ"</span><span class="p">,</span>
            <span class="s2">"r"</span><span class="p">:</span> <span class="s2">"ⲅ"</span><span class="p">,</span>
            <span class="s2">"s"</span><span class="p">:</span> <span class="s2">"ѕ"</span><span class="p">,</span>
            <span class="s2">"t"</span><span class="p">:</span> <span class="s2">"𝚝"</span><span class="p">,</span>
            <span class="s2">"u"</span><span class="p">:</span> <span class="s2">"ս"</span><span class="p">,</span>
            <span class="s2">"v"</span><span class="p">:</span> <span class="s2">"ѵ"</span><span class="p">,</span>
            <span class="s2">"w"</span><span class="p">:</span> <span class="s2">"ԝ"</span><span class="p">,</span>
            <span class="s2">"x"</span><span class="p">:</span> <span class="s2">"×"</span><span class="p">,</span>
            <span class="s2">"y"</span><span class="p">:</span> <span class="s2">"у"</span><span class="p">,</span>
            <span class="s2">"z"</span><span class="p">:</span> <span class="s2">"ᴢ"</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">random_one</span> <span class="o">=</span> <span class="n">random_one</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_get_replacement_words</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">word</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""</span>
<span class="sd">        Returns a list containing all possible words with 1 character</span>
<span class="sd">        replaced by a homoglyph.</span>

<span class="sd">        Args:</span>
<span class="sd">          word: String</span>
<span class="sd">            Word for which homoglyphs are to be generated.</span>

<span class="sd">        Returns:</span>
<span class="sd">          candidate_words: List</span>
<span class="sd">            List of homoglyphs with respect to input word.</span>
<span class="sd">        """</span>
        <span class="n">candidate_words</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">random_one</span><span class="p">:</span>
            <span class="n">i</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">word</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">word</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">homos</span><span class="p">:</span>
                <span class="n">repl_letter</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">homos</span><span class="p">[</span><span class="n">word</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span>
                <span class="n">candidate_word</span> <span class="o">=</span> <span class="n">word</span><span class="p">[:</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">repl_letter</span> <span class="o">+</span> <span class="n">word</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="p">:]</span>
                <span class="n">candidate_words</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">candidate_word</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">word</span><span class="p">)):</span>
                <span class="k">if</span> <span class="n">word</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">homos</span><span class="p">:</span>
                    <span class="n">repl_letter</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">homos</span><span class="p">[</span><span class="n">word</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span>
                    <span class="n">candidate_word</span> <span class="o">=</span> <span class="n">word</span><span class="p">[:</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">repl_letter</span> <span class="o">+</span> <span class="n">word</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="p">:]</span>
                    <span class="n">candidate_words</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">candidate_word</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">candidate_words</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">deterministic</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">random_one</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">extra_repr_keys</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">extra_repr_keys</span><span class="p">()</span>


<span class="k">class</span><span class="w"> </span><span class="nc">WordSwapRandomCharacterDeletion</span><span class="p">(</span><span class="n">WordSwap</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Transforms an input by deleting its characters.</span>
<span class="sd">    """</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">random_one</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">skip_first_char</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">skip_last_char</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">"""</span>
<span class="sd">        Initiates the following parameters:</span>

<span class="sd">        Args:</span>
<span class="sd">          random_one: Boolean</span>
<span class="sd">            Whether to return a single word with a random</span>
<span class="sd">            character deleted. If not, returns all possible options.</span>
<span class="sd">          skip_first_char: Boolean</span>
<span class="sd">            Whether to disregard deleting the first character.</span>
<span class="sd">          skip_last_char: Boolean</span>
<span class="sd">            Whether to disregard deleting the last character.</span>

<span class="sd">        Returns:</span>
<span class="sd">          Nothing</span>

<span class="sd">        Usage/Example:</span>
<span class="sd">          &gt;&gt;&gt; from textattack.transformations import WordSwapRandomCharacterDeletion</span>
<span class="sd">          &gt;&gt;&gt; from textattack.augmentation import Augmenter</span>
<span class="sd">          &gt;&gt;&gt; transformation = WordSwapRandomCharacterDeletion()</span>
<span class="sd">          &gt;&gt;&gt; augmenter = Augmenter(transformation=transformation)</span>
<span class="sd">          &gt;&gt;&gt; s = 'I am fabulous.'</span>
<span class="sd">          &gt;&gt;&gt; augmenter.augment(s)</span>
<span class="sd">        """</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">random_one</span> <span class="o">=</span> <span class="n">random_one</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">skip_first_char</span> <span class="o">=</span> <span class="n">skip_first_char</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">skip_last_char</span> <span class="o">=</span> <span class="n">skip_last_char</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_get_replacement_words</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">word</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""</span>
<span class="sd">        Returns a list containing all possible words with 1 letter</span>
<span class="sd">        deleted.</span>

<span class="sd">        Args:</span>
<span class="sd">          word: String</span>
<span class="sd">            The input word to find replacements for.</span>

<span class="sd">        Returns:</span>
<span class="sd">          candidate_words: List</span>
<span class="sd">            List of candidate words with single letter deletion</span>
<span class="sd">        """</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">word</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[]</span>

        <span class="n">candidate_words</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="n">start_idx</span> <span class="o">=</span> <span class="mi">1</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">skip_first_char</span> <span class="k">else</span> <span class="mi">0</span>
        <span class="n">end_idx</span> <span class="o">=</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">word</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">skip_last_char</span> <span class="k">else</span> <span class="nb">len</span><span class="p">(</span><span class="n">word</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">start_idx</span> <span class="o">&gt;=</span> <span class="n">end_idx</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[]</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">random_one</span><span class="p">:</span>
            <span class="n">i</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">start_idx</span><span class="p">,</span> <span class="n">end_idx</span><span class="p">)</span>
            <span class="n">candidate_word</span> <span class="o">=</span> <span class="n">word</span><span class="p">[:</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">word</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="p">:]</span>
            <span class="n">candidate_words</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">candidate_word</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">start_idx</span><span class="p">,</span> <span class="n">end_idx</span><span class="p">):</span>
                <span class="n">candidate_word</span> <span class="o">=</span> <span class="n">word</span><span class="p">[:</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">word</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="p">:]</span>
                <span class="n">candidate_words</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">candidate_word</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">candidate_words</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">deterministic</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">random_one</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">extra_repr_keys</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">extra_repr_keys</span><span class="p">()</span> <span class="o">+</span> <span class="p">[</span><span class="s2">"random_one"</span><span class="p">]</span>


<span class="k">class</span><span class="w"> </span><span class="nc">WordSwapNeighboringCharacterSwap</span><span class="p">(</span><span class="n">WordSwap</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Transforms an input by replacing its words with a neighboring character</span>
<span class="sd">    swap.</span>
<span class="sd">    """</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">random_one</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">skip_first_char</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">skip_last_char</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">"""</span>
<span class="sd">        Initiates the following attributes</span>

<span class="sd">        Args:</span>
<span class="sd">          random_one: Boolean</span>
<span class="sd">            Whether to return a single word with two characters</span>
<span class="sd">            swapped. If not, returns all possible options.</span>
<span class="sd">          skip_first_char: Boolean</span>
<span class="sd">            Whether to disregard perturbing the first</span>
<span class="sd">            character.</span>
<span class="sd">          skip_last_char: Boolean</span>
<span class="sd">            Whether to disregard perturbing the last</span>
<span class="sd">            character.</span>

<span class="sd">        Returns:</span>
<span class="sd">          Nothing</span>

<span class="sd">        Usage/Examples:</span>
<span class="sd">          &gt;&gt;&gt; from textattack.transformations import WordSwapNeighboringCharacterSwap</span>
<span class="sd">          &gt;&gt;&gt; from textattack.augmentation import Augmenter</span>
<span class="sd">          &gt;&gt;&gt; transformation = WordSwapNeighboringCharacterSwap()</span>
<span class="sd">          &gt;&gt;&gt; augmenter = Augmenter(transformation=transformation)</span>
<span class="sd">          &gt;&gt;&gt; s = 'I am fabulous.'</span>
<span class="sd">          &gt;&gt;&gt; augmenter.augment(s)</span>
<span class="sd">        """</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">random_one</span> <span class="o">=</span> <span class="n">random_one</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">skip_first_char</span> <span class="o">=</span> <span class="n">skip_first_char</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">skip_last_char</span> <span class="o">=</span> <span class="n">skip_last_char</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_get_replacement_words</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">word</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""</span>
<span class="sd">        Returns a list containing all possible words with a single pair of</span>
<span class="sd">        neighboring characters swapped.</span>

<span class="sd">        Args:</span>
<span class="sd">          word: String</span>
<span class="sd">            The input word to find replacements for.</span>

<span class="sd">        Returns:</span>
<span class="sd">          candidate_words: List</span>
<span class="sd">            List of candidate words</span>
<span class="sd">        """</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">word</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[]</span>

        <span class="n">candidate_words</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="n">start_idx</span> <span class="o">=</span> <span class="mi">1</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">skip_first_char</span> <span class="k">else</span> <span class="mi">0</span>
        <span class="n">end_idx</span> <span class="o">=</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">word</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">skip_last_char</span> <span class="k">else</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">word</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">start_idx</span> <span class="o">&gt;=</span> <span class="n">end_idx</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[]</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">random_one</span><span class="p">:</span>
            <span class="n">i</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">start_idx</span><span class="p">,</span> <span class="n">end_idx</span><span class="p">)</span>
            <span class="n">candidate_word</span> <span class="o">=</span> <span class="n">word</span><span class="p">[:</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">word</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">word</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">word</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span> <span class="p">:]</span>
            <span class="n">candidate_words</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">candidate_word</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">start_idx</span><span class="p">,</span> <span class="n">end_idx</span><span class="p">):</span>
                <span class="n">candidate_word</span> <span class="o">=</span> <span class="n">word</span><span class="p">[:</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">word</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">word</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">word</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span> <span class="p">:]</span>
                <span class="n">candidate_words</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">candidate_word</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">candidate_words</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">deterministic</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">random_one</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">extra_repr_keys</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">extra_repr_keys</span><span class="p">()</span> <span class="o">+</span> <span class="p">[</span><span class="s2">"random_one"</span><span class="p">]</span>


<span class="k">class</span><span class="w"> </span><span class="nc">WordSwapRandomCharacterInsertion</span><span class="p">(</span><span class="n">WordSwap</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Transforms an input by inserting a random character.</span>
<span class="sd">    """</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">random_one</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">skip_first_char</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">skip_last_char</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">"""</span>
<span class="sd">        Initiates the following attributes</span>

<span class="sd">        Args:</span>
<span class="sd">          random_one: Boolean</span>
<span class="sd">            Whether to return a single word with a random</span>
<span class="sd">            character deleted. If not, returns all possible options.</span>
<span class="sd">          skip_first_char: Boolean</span>
<span class="sd">            Whether to disregard inserting as the first character.</span>
<span class="sd">          skip_last_char: Boolean</span>
<span class="sd">            Whether to disregard inserting as the last character.</span>

<span class="sd">        Returns:</span>
<span class="sd">          Nothing</span>

<span class="sd">        Usage/Example:</span>
<span class="sd">          &gt;&gt;&gt; from textattack.transformations import WordSwapRandomCharacterInsertion</span>
<span class="sd">          &gt;&gt;&gt; from textattack.augmentation import Augmenter</span>
<span class="sd">          &gt;&gt;&gt; transformation = WordSwapRandomCharacterInsertion()</span>
<span class="sd">          &gt;&gt;&gt; augmenter = Augmenter(transformation=transformation)</span>
<span class="sd">          &gt;&gt;&gt; s = 'I am fabulous.'</span>
<span class="sd">          &gt;&gt;&gt; augmenter.augment(s)</span>
<span class="sd">        """</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">random_one</span> <span class="o">=</span> <span class="n">random_one</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">skip_first_char</span> <span class="o">=</span> <span class="n">skip_first_char</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">skip_last_char</span> <span class="o">=</span> <span class="n">skip_last_char</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_get_replacement_words</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">word</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""</span>
<span class="sd">        Returns a list containing all possible words with 1 random</span>
<span class="sd">        character inserted.</span>

<span class="sd">        Args:</span>
<span class="sd">          word: String</span>
<span class="sd">            The input word to find replacements for.</span>

<span class="sd">        Returns:</span>
<span class="sd">          candidate_words: List</span>
<span class="sd">            List of candidate words with all possible words with 1 random</span>
<span class="sd">            character inserted.</span>
<span class="sd">        """</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">word</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[]</span>

        <span class="n">candidate_words</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="n">start_idx</span> <span class="o">=</span> <span class="mi">1</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">skip_first_char</span> <span class="k">else</span> <span class="mi">0</span>
        <span class="n">end_idx</span> <span class="o">=</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">word</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">skip_last_char</span> <span class="k">else</span> <span class="nb">len</span><span class="p">(</span><span class="n">word</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">start_idx</span> <span class="o">&gt;=</span> <span class="n">end_idx</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[]</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">random_one</span><span class="p">:</span>
            <span class="n">i</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">start_idx</span><span class="p">,</span> <span class="n">end_idx</span><span class="p">)</span>
            <span class="n">candidate_word</span> <span class="o">=</span> <span class="n">word</span><span class="p">[:</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_random_letter</span><span class="p">()</span> <span class="o">+</span> <span class="n">word</span><span class="p">[</span><span class="n">i</span><span class="p">:]</span>
            <span class="n">candidate_words</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">candidate_word</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">start_idx</span><span class="p">,</span> <span class="n">end_idx</span><span class="p">):</span>
                <span class="n">candidate_word</span> <span class="o">=</span> <span class="n">word</span><span class="p">[:</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_random_letter</span><span class="p">()</span> <span class="o">+</span> <span class="n">word</span><span class="p">[</span><span class="n">i</span><span class="p">:]</span>
                <span class="n">candidate_words</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">candidate_word</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">candidate_words</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">deterministic</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">random_one</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">extra_repr_keys</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">extra_repr_keys</span><span class="p">()</span> <span class="o">+</span> <span class="p">[</span><span class="s2">"random_one"</span><span class="p">]</span>


<span class="k">class</span><span class="w"> </span><span class="nc">WordSwapRandomCharacterSubstitution</span><span class="p">(</span><span class="n">WordSwap</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Transforms an input by replacing one character in a word with a random</span>
<span class="sd">    new character.</span>
<span class="sd">    """</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">random_one</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""</span>
<span class="sd">        Initiates the following attributes</span>

<span class="sd">        Args:</span>
<span class="sd">          random_one: Boolean</span>
<span class="sd">            Whether to return a single word with a random</span>
<span class="sd">            character deleted. If not set, returns all possible options.</span>

<span class="sd">        Returns:</span>
<span class="sd">          Nothing</span>

<span class="sd">        Usage/Example:</span>
<span class="sd">          &gt;&gt;&gt; from textattack.transformations import WordSwapRandomCharacterSubstitution</span>
<span class="sd">          &gt;&gt;&gt; from textattack.augmentation import Augmenter</span>
<span class="sd">          &gt;&gt;&gt; transformation = WordSwapRandomCharacterSubstitution()</span>
<span class="sd">          &gt;&gt;&gt; augmenter = Augmenter(transformation=transformation)</span>
<span class="sd">          &gt;&gt;&gt; s = 'I am fabulous.'</span>
<span class="sd">          &gt;&gt;&gt; augmenter.augment(s)</span>
<span class="sd">        """</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">random_one</span> <span class="o">=</span> <span class="n">random_one</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_get_replacement_words</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">word</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""</span>
<span class="sd">        Returns a list containing all possible words with 1 letter</span>
<span class="sd">        substituted for a random letter.</span>

<span class="sd">        Args:</span>
<span class="sd">          word: String</span>
<span class="sd">            The input word to find replacements for.</span>

<span class="sd">        Returns:</span>
<span class="sd">          candidate_words: List</span>
<span class="sd">            List of candidate words with combinations involving random substitution</span>
<span class="sd">        """</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">word</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[]</span>

        <span class="n">candidate_words</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">random_one</span><span class="p">:</span>
            <span class="n">i</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">word</span><span class="p">))</span>
            <span class="n">candidate_word</span> <span class="o">=</span> <span class="n">word</span><span class="p">[:</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_random_letter</span><span class="p">()</span> <span class="o">+</span> <span class="n">word</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="p">:]</span>
            <span class="n">candidate_words</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">candidate_word</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">word</span><span class="p">)):</span>
                <span class="n">candidate_word</span> <span class="o">=</span> <span class="n">word</span><span class="p">[:</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_random_letter</span><span class="p">()</span> <span class="o">+</span> <span class="n">word</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="p">:]</span>
                <span class="n">candidate_words</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">candidate_word</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">candidate_words</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">deterministic</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">random_one</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">extra_repr_keys</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">extra_repr_keys</span><span class="p">()</span> <span class="o">+</span> <span class="p">[</span><span class="s2">"random_one"</span><span class="p">]</span>


<span class="k">class</span><span class="w"> </span><span class="nc">CompositeTransformation</span><span class="p">(</span><span class="n">Transformation</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    A transformation which applies each of a list of transformations,</span>
<span class="sd">    returning a set of all optoins.</span>
<span class="sd">    """</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">transformations</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""</span>
<span class="sd">        Initiates the following attributes</span>

<span class="sd">        Args:</span>
<span class="sd">          transformations: List</span>
<span class="sd">            The list of Transformation to apply.</span>

<span class="sd">        Returns:</span>
<span class="sd">          Nothing</span>
<span class="sd">        """</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span>
            <span class="nb">isinstance</span><span class="p">(</span><span class="n">transformations</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">transformations</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)</span>
        <span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">"transformations must be list or tuple"</span><span class="p">)</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="nb">len</span><span class="p">(</span><span class="n">transformations</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">"transformations cannot be empty"</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">transformations</span> <span class="o">=</span> <span class="n">transformations</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_get_transformations</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">_</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""</span>
<span class="sd">        Placeholder method that would throw an error if a user tried to</span>
<span class="sd">        treat the CompositeTransformation as a 'normal' transformation.</span>

<span class="sd">        Args:</span>
<span class="sd">          None</span>

<span class="sd">        Returns:</span>
<span class="sd">          Nothing</span>
<span class="sd">        """</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
            <span class="s2">"CompositeTransformation does not support _get_transformations()."</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""</span>
<span class="sd">        Generates new attacked texts based on different possible transformations</span>

<span class="sd">        Args:</span>
<span class="sd">          None</span>

<span class="sd">        Returns:</span>
<span class="sd">          new_attacked_texts: List</span>
<span class="sd">            List of new attacked texts based on different possible transformations</span>

<span class="sd">        """</span>
        <span class="n">new_attacked_texts</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">transformation</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">transformations</span><span class="p">:</span>
            <span class="n">new_attacked_texts</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">transformation</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">))</span>
        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="n">new_attacked_texts</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">main_str</span> <span class="o">=</span> <span class="s2">"CompositeTransformation"</span> <span class="o">+</span> <span class="s2">"("</span>
        <span class="n">transformation_lines</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">transformation</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">transformations</span><span class="p">):</span>
            <span class="n">transformation_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">utils</span><span class="o">.</span><span class="n">add_indent</span><span class="p">(</span><span class="sa">f</span><span class="s2">"(</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">): </span><span class="si">{</span><span class="n">transformation</span><span class="si">}</span><span class="s2">"</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
        <span class="n">transformation_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">")"</span><span class="p">)</span>
        <span class="n">main_str</span> <span class="o">+=</span> <span class="n">utils</span><span class="o">.</span><span class="n">add_indent</span><span class="p">(</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span> <span class="o">+</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">transformation_lines</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">main_str</span>

    <span class="fm">__str__</span> <span class="o">=</span> <span class="fm">__repr__</span>


<span class="sd">"""</span>
<span class="sd">===================</span>
<span class="sd">Augmenter Class</span>
<span class="sd">===================</span>
<span class="sd">"""</span>
<span class="n">device</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">(</span><span class="s2">"cuda"</span> <span class="k">if</span> <span class="n">torch</span><span class="o">.</span><span class="n">cuda</span><span class="o">.</span><span class="n">is_available</span><span class="p">()</span> <span class="k">else</span> <span class="s2">"cpu"</span><span class="p">)</span>

<span class="k">class</span><span class="w"> </span><span class="nc">PreTransformationConstraint</span><span class="p">(</span><span class="n">ABC</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    An abstract class that represents constraints which are applied before</span>
<span class="sd">    the transformation.</span>
<span class="sd">    These restrict which words are allowed to be modified during the</span>
<span class="sd">    transformation. For example, we might not allow stopwords to be</span>
<span class="sd">    modified.</span>
<span class="sd">    """</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">current_text</span><span class="p">,</span> <span class="n">transformation</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""</span>
<span class="sd">        Returns the word indices in current_text which are able to be</span>
<span class="sd">        modified. First checks compatibility with transformation then calls</span>
<span class="sd">        _get_modifiable_indices</span>

<span class="sd">        Args:</span>
<span class="sd">          current_text: String</span>
<span class="sd">            The AttackedText Object input to consider.</span>
<span class="sd">          transformation: Transformation Object</span>
<span class="sd">            The Transformation which will be applied.</span>

<span class="sd">        Returns:</span>
<span class="sd">          Modifiable indices of input if transformation is compatible</span>
<span class="sd">          Words of current text otherwise</span>
<span class="sd">        """</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_compatibility</span><span class="p">(</span><span class="n">transformation</span><span class="p">):</span>
            <span class="k">return</span> <span class="nb">set</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">current_text</span><span class="o">.</span><span class="n">words</span><span class="p">)))</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_modifiable_indices</span><span class="p">(</span><span class="n">current_text</span><span class="p">)</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">_get_modifiable_indices</span><span class="p">(</span><span class="n">current_text</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""</span>
<span class="sd">        Returns the word indices in current_text which are able to be</span>
<span class="sd">        modified. Must be overridden by specific pre-transformation</span>
<span class="sd">        constraints.</span>

<span class="sd">        Args:</span>
<span class="sd">          current_text: String</span>
<span class="sd">            The AttackedText Object input to consider.</span>

<span class="sd">        Returns:</span>
<span class="sd">          Nothing</span>
<span class="sd">        """</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">check_compatibility</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">transformation</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""</span>
<span class="sd">        Checks if this constraint is compatible with the given</span>
<span class="sd">        transformation. For example, the WordEmbeddingDistance constraint</span>
<span class="sd">        compares the embedding of the word inserted with that of the word</span>
<span class="sd">        deleted. Therefore it can only be applied in the case of word swaps,</span>
<span class="sd">        and not for transformations which involve only one of insertion or</span>
<span class="sd">        deletion.</span>

<span class="sd">        Args:</span>
<span class="sd">          transformation: Transformation Object</span>
<span class="sd">            The Transformation to check compatibility for.</span>

<span class="sd">        Returns:</span>
<span class="sd">          True</span>
<span class="sd">        """</span>
        <span class="k">return</span> <span class="kc">True</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">extra_repr_keys</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""</span>
<span class="sd">        Set the extra representation of the constraint using these keys.</span>
<span class="sd">        To print customized extra information, you should reimplement</span>
<span class="sd">        this method in your own constraint. Both single-line and multi-</span>
<span class="sd">        line strings are acceptable.</span>

<span class="sd">        Args:</span>
<span class="sd">          None</span>

<span class="sd">        Returns:</span>
<span class="sd">          []</span>
<span class="sd">        """</span>
        <span class="k">return</span> <span class="p">[]</span>

    <span class="fm">__str__</span> <span class="o">=</span> <span class="fm">__repr__</span> <span class="o">=</span> <span class="n">default_class_repr</span>


<span class="n">flair</span><span class="o">.</span><span class="n">device</span> <span class="o">=</span> <span class="n">device</span>

<span class="k">def</span><span class="w"> </span><span class="nf">words_from_text</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">words_to_ignore</span><span class="o">=</span><span class="p">[]):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Lowercases a string, removes all non-alphanumeric characters, and splits</span>
<span class="sd">    into words.</span>

<span class="sd">    Args:</span>
<span class="sd">      s: String</span>
<span class="sd">        Input String</span>
<span class="sd">      words_to_ignore: List</span>
<span class="sd">        List of words that explicitly need to be ignored</span>

<span class="sd">    Returns:</span>
<span class="sd">      words: List</span>
<span class="sd">        Legitimate list of alpha-numeric words that aren't ignored</span>
<span class="sd">    """</span>
    <span class="n">homos</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span>
        <span class="p">[</span>
            <span class="s2">"˗"</span><span class="p">,</span>
            <span class="s2">"৭"</span><span class="p">,</span>
            <span class="s2">"Ȣ"</span><span class="p">,</span>
            <span class="s2">"𝟕"</span><span class="p">,</span>
            <span class="s2">"б"</span><span class="p">,</span>
            <span class="s2">"Ƽ"</span><span class="p">,</span>
            <span class="s2">"Ꮞ"</span><span class="p">,</span>
            <span class="s2">"Ʒ"</span><span class="p">,</span>
            <span class="s2">"ᒿ"</span><span class="p">,</span>
            <span class="s2">"l"</span><span class="p">,</span>
            <span class="s2">"O"</span><span class="p">,</span>
            <span class="s2">"`"</span><span class="p">,</span>
            <span class="s2">"ɑ"</span><span class="p">,</span>
            <span class="s2">"Ь"</span><span class="p">,</span>
            <span class="s2">"ϲ"</span><span class="p">,</span>
            <span class="s2">"ԁ"</span><span class="p">,</span>
            <span class="s2">"е"</span><span class="p">,</span>
            <span class="s2">"𝚏"</span><span class="p">,</span>
            <span class="s2">"ɡ"</span><span class="p">,</span>
            <span class="s2">"հ"</span><span class="p">,</span>
            <span class="s2">"і"</span><span class="p">,</span>
            <span class="s2">"ϳ"</span><span class="p">,</span>
            <span class="s2">"𝒌"</span><span class="p">,</span>
            <span class="s2">"ⅼ"</span><span class="p">,</span>
            <span class="s2">"ｍ"</span><span class="p">,</span>
            <span class="s2">"ո"</span><span class="p">,</span>
            <span class="s2">"о"</span><span class="p">,</span>
            <span class="s2">"р"</span><span class="p">,</span>
            <span class="s2">"ԛ"</span><span class="p">,</span>
            <span class="s2">"ⲅ"</span><span class="p">,</span>
            <span class="s2">"ѕ"</span><span class="p">,</span>
            <span class="s2">"𝚝"</span><span class="p">,</span>
            <span class="s2">"ս"</span><span class="p">,</span>
            <span class="s2">"ѵ"</span><span class="p">,</span>
            <span class="s2">"ԝ"</span><span class="p">,</span>
            <span class="s2">"×"</span><span class="p">,</span>
            <span class="s2">"у"</span><span class="p">,</span>
            <span class="s2">"ᴢ"</span><span class="p">,</span>
        <span class="p">]</span>
    <span class="p">)</span>
    <span class="n">words</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">word</span> <span class="o">=</span> <span class="s2">""</span>
    <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="s2">" "</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">split</span><span class="p">()):</span>
        <span class="k">if</span> <span class="n">c</span><span class="o">.</span><span class="n">isalnum</span><span class="p">()</span> <span class="ow">or</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">homos</span><span class="p">:</span>
            <span class="n">word</span> <span class="o">+=</span> <span class="n">c</span>
        <span class="k">elif</span> <span class="n">c</span> <span class="ow">in</span> <span class="s2">"'-_*@"</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">word</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="c1"># Allow apostrophes, hyphens, underscores, asterisks and at signs as long as they don't begin the</span>
            <span class="c1"># word.</span>
            <span class="n">word</span> <span class="o">+=</span> <span class="n">c</span>
        <span class="k">elif</span> <span class="n">word</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">word</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">words_to_ignore</span><span class="p">:</span>
                <span class="n">words</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">word</span><span class="p">)</span>
            <span class="n">word</span> <span class="o">=</span> <span class="s2">""</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">word</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">word</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">words_to_ignore</span><span class="p">):</span>
        <span class="n">words</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">word</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">words</span>


<span class="n">_flair_pos_tagger</span> <span class="o">=</span> <span class="kc">None</span>


<span class="k">def</span><span class="w"> </span><span class="nf">flair_tag</span><span class="p">(</span><span class="n">sentence</span><span class="p">,</span> <span class="n">tag_type</span><span class="o">=</span><span class="s2">"upos-fast"</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Tags a Sentence object using flair part-of-speech tagger.</span>

<span class="sd">    Args:</span>
<span class="sd">      sentence: Object</span>
<span class="sd">        Input Sequence</span>
<span class="sd">      tag_type: String</span>
<span class="sd">        Type of flair tag that needs to be applied</span>

<span class="sd">    Returns:</span>
<span class="sd">      Nothing</span>
<span class="sd">    """</span>
    <span class="k">global</span> <span class="n">_flair_pos_tagger</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">_flair_pos_tagger</span><span class="p">:</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">flair.models</span><span class="w"> </span><span class="kn">import</span> <span class="n">SequenceTagger</span>

        <span class="n">_flair_pos_tagger</span> <span class="o">=</span> <span class="n">SequenceTagger</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">tag_type</span><span class="p">)</span>
    <span class="n">_flair_pos_tagger</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">sentence</span><span class="p">)</span>


<span class="k">def</span><span class="w"> </span><span class="nf">zip_flair_result</span><span class="p">(</span><span class="n">pred</span><span class="p">,</span> <span class="n">tag_type</span><span class="o">=</span><span class="s2">"upos-fast"</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Takes a sentence tagging from flair and returns two lists, of words</span>
<span class="sd">    and their corresponding parts-of-speech.</span>

<span class="sd">    Args:</span>
<span class="sd">      pred: Object</span>
<span class="sd">        Resulting Prediction on input sentence post tagging</span>
<span class="sd">      tag_type: String</span>
<span class="sd">        Type of flair tag that needs to be applied</span>

<span class="sd">    Returns:</span>
<span class="sd">      Nothing</span>
<span class="sd">    """</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">flair.data</span><span class="w"> </span><span class="kn">import</span> <span class="n">Sentence</span>


<span class="k">class</span><span class="w"> </span><span class="nc">AttackedText</span><span class="p">:</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    A helper class that represents a string that can be attacked.</span>
<span class="sd">    Models that take multiple sentences as input separate them by SPLIT_TOKEN.</span>
<span class="sd">    Attacks "see" the entire input, joined into one string, without the split</span>
<span class="sd">    token.</span>
<span class="sd">    AttackedText instances that were perturbed from other AttackedText</span>
<span class="sd">    objects contain a pointer to the previous text</span>
<span class="sd">    (attack_attrs["previous_attacked_text"]), so that the full chain of</span>
<span class="sd">    perturbations might be reconstructed by using this key to form a linked</span>
<span class="sd">    list.</span>
<span class="sd">    """</span>

    <span class="n">SPLIT_TOKEN</span> <span class="o">=</span> <span class="s2">"&lt;SPLIT&gt;"</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text_input</span><span class="p">,</span> <span class="n">attack_attrs</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="c1"># Read in ``text_input`` as a string or OrderedDict.</span>
<span class="w">        </span><span class="sd">"""</span>
<span class="sd">        Initiates the following attributes:</span>

<span class="sd">        Args:</span>
<span class="sd">          text: String</span>
<span class="sd">            The string that this AttackedText Object represents</span>
<span class="sd">          attack_attrs: Dictionary</span>
<span class="sd">            Dictionary of various attributes stored during the</span>
<span class="sd">            course of an attack.</span>

<span class="sd">        Returns:</span>
<span class="sd">          Nothing</span>
<span class="sd">        """</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">text_input</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_text_input</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">([(</span><span class="s2">"text"</span><span class="p">,</span> <span class="n">text_input</span><span class="p">)])</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">text_input</span><span class="p">,</span> <span class="n">OrderedDict</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_text_input</span> <span class="o">=</span> <span class="n">text_input</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">"Invalid text_input type </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">text_input</span><span class="p">)</span><span class="si">}</span><span class="s2"> (required str or OrderedDict)"</span>
            <span class="p">)</span>
        <span class="c1"># Process input lazily.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_words</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_words_per_input</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_pos_tags</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_ner_tags</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="c1"># Format text inputs.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_text_input</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">([(</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_text_input</span><span class="o">.</span><span class="n">items</span><span class="p">()])</span>
        <span class="k">if</span> <span class="n">attack_attrs</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">attack_attrs</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">attack_attrs</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">attack_attrs</span> <span class="o">=</span> <span class="n">attack_attrs</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Invalid type for attack_attrs: </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">attack_attrs</span><span class="p">)</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
        <span class="c1"># Indices of words from the *original* text. Allows us to map</span>
        <span class="c1"># indices between original text and this text, and vice-versa.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">attack_attrs</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s2">"original_index_map"</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num_words</span><span class="p">))</span>
        <span class="c1"># A list of all indices in *this* text that have been modified.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">attack_attrs</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s2">"modified_indices"</span><span class="p">,</span> <span class="nb">set</span><span class="p">())</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""</span>
<span class="sd">        Compares two text instances to make sure they have the same attack</span>
<span class="sd">        attributes.</span>
<span class="sd">        Since some elements stored in self.attack_attrs may be numpy</span>
<span class="sd">        arrays, we have to take special care when comparing them.</span>

<span class="sd">        Args:</span>
<span class="sd">          Other: String</span>
<span class="sd">            Specifies second text instance to be compared for attack attributes</span>

<span class="sd">        Returns:</span>
<span class="sd">          True</span>
<span class="sd">        """</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">text</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">text</span><span class="p">):</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">attack_attrs</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">attack_attrs</span><span class="p">):</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">attack_attrs</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">other</span><span class="o">.</span><span class="n">attack_attrs</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">False</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">attack_attrs</span><span class="p">[</span><span class="n">key</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">attack_attrs</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">attack_attrs</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">):</span>
                    <span class="k">return</span> <span class="kc">False</span>
                <span class="k">elif</span> <span class="ow">not</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">attack_attrs</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">attack_attrs</span><span class="p">[</span><span class="n">key</span><span class="p">])</span><span class="o">.</span><span class="n">all</span><span class="p">():</span>
                    <span class="k">return</span> <span class="kc">False</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">attack_attrs</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">attack_attrs</span><span class="p">[</span><span class="n">key</span><span class="p">]:</span>
                    <span class="k">return</span> <span class="kc">False</span>
        <span class="k">return</span> <span class="kc">True</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__hash__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">hash</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">free_memory</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""</span>
<span class="sd">        Delete items that take up memory.</span>
<span class="sd">        Can be called once the AttackedText is only needed to display.</span>

<span class="sd">        Args:</span>
<span class="sd">          None</span>

<span class="sd">        Returns:</span>
<span class="sd">          Nothing</span>
<span class="sd">        """</span>
        <span class="k">if</span> <span class="s2">"previous_attacked_text"</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">attack_attrs</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">attack_attrs</span><span class="p">[</span><span class="s2">"previous_attacked_text"</span><span class="p">]</span><span class="o">.</span><span class="n">free_memory</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">attack_attrs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">"previous_attacked_text"</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">attack_attrs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">"last_transformation"</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">attack_attrs</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">attack_attrs</span><span class="p">[</span><span class="n">key</span><span class="p">],</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">attack_attrs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">text_window_around_index</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">window_size</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""</span>
<span class="sd">        The text window of window_size words centered around</span>
<span class="sd">        index.</span>

<span class="sd">        Args:</span>
<span class="sd">          index: Integer</span>
<span class="sd">            Index of transformation within input sequence</span>
<span class="sd">          window_size: Integer</span>
<span class="sd">            Specifies size of the window around index</span>

<span class="sd">        Returns:</span>
<span class="sd">          Substring of text with specified window_size</span>
<span class="sd">        """</span>
        <span class="n">length</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_words</span>
        <span class="n">half_size</span> <span class="o">=</span> <span class="p">(</span><span class="n">window_size</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="mf">2.0</span>
        <span class="k">if</span> <span class="n">index</span> <span class="o">-</span> <span class="n">half_size</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">start</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">end</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">window_size</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">length</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">index</span> <span class="o">+</span> <span class="n">half_size</span> <span class="o">&gt;=</span> <span class="n">length</span><span class="p">:</span>
            <span class="n">start</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">length</span> <span class="o">-</span> <span class="n">window_size</span><span class="p">)</span>
            <span class="n">end</span> <span class="o">=</span> <span class="n">length</span> <span class="o">-</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">start</span> <span class="o">=</span> <span class="n">index</span> <span class="o">-</span> <span class="n">math</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">half_size</span><span class="p">)</span>
            <span class="n">end</span> <span class="o">=</span> <span class="n">index</span> <span class="o">+</span> <span class="n">math</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">half_size</span><span class="p">)</span>
        <span class="n">text_idx_start</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_text_index_of_word_index</span><span class="p">(</span><span class="n">start</span><span class="p">)</span>
        <span class="n">text_idx_end</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_text_index_of_word_index</span><span class="p">(</span><span class="n">end</span><span class="p">)</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">words</span><span class="p">[</span><span class="n">end</span><span class="p">])</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="p">[</span><span class="n">text_idx_start</span><span class="p">:</span><span class="n">text_idx_end</span><span class="p">]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">pos_of_word_index</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">desired_word_idx</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""</span>
<span class="sd">        Returns the part-of-speech of the word at index word_idx.</span>
<span class="sd">        Uses FLAIR part-of-speech tagger.</span>

<span class="sd">        Args:</span>
<span class="sd">          desired_word_idx: Integer</span>
<span class="sd">            Index where POS transformation is to be applied within input sequence</span>

<span class="sd">        Returns:</span>
<span class="sd">          Part-of-speech of the word at index word_idx</span>
<span class="sd">        """</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pos_tags</span><span class="p">:</span>
            <span class="n">sentence</span> <span class="o">=</span> <span class="n">Sentence</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="p">,</span> <span class="n">use_tokenizer</span><span class="o">=</span><span class="n">words_from_text</span>
            <span class="p">)</span>
            <span class="n">flair_tag</span><span class="p">(</span><span class="n">sentence</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_pos_tags</span> <span class="o">=</span> <span class="n">sentence</span>
        <span class="n">flair_word_list</span><span class="p">,</span> <span class="n">flair_pos_list</span> <span class="o">=</span> <span class="n">zip_flair_result</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_pos_tags</span>
        <span class="p">)</span>

        <span class="k">for</span> <span class="n">word_idx</span><span class="p">,</span> <span class="n">word</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">words</span><span class="p">):</span>
            <span class="k">assert</span> <span class="p">(</span>
                <span class="n">word</span> <span class="ow">in</span> <span class="n">flair_word_list</span>
            <span class="p">),</span> <span class="s2">"word absent in flair returned part-of-speech tags"</span>
            <span class="n">word_idx_in_flair_tags</span> <span class="o">=</span> <span class="n">flair_word_list</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">word</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">word_idx</span> <span class="o">==</span> <span class="n">desired_word_idx</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">flair_pos_list</span><span class="p">[</span><span class="n">word_idx_in_flair_tags</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">flair_word_list</span> <span class="o">=</span> <span class="n">flair_word_list</span><span class="p">[</span><span class="n">word_idx_in_flair_tags</span> <span class="o">+</span> <span class="mi">1</span> <span class="p">:]</span>
                <span class="n">flair_pos_list</span> <span class="o">=</span> <span class="n">flair_pos_list</span><span class="p">[</span><span class="n">word_idx_in_flair_tags</span> <span class="o">+</span> <span class="mi">1</span> <span class="p">:]</span>

        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">"Did not find word from index </span><span class="si">{</span><span class="n">desired_word_idx</span><span class="si">}</span><span class="s2"> in flair POS tag"</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">ner_of_word_index</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">desired_word_idx</span><span class="p">,</span> <span class="n">model_name</span><span class="o">=</span><span class="s2">"ner"</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""</span>
<span class="sd">        Returns the ner tag of the word at index word_idx.</span>
<span class="sd">        Uses FLAIR ner tagger.</span>

<span class="sd">        Args:</span>
<span class="sd">          desired_word_idx: Integer</span>
<span class="sd">            Index where POS transformation is to be applied within input sequence</span>
<span class="sd">          model_name: String</span>
<span class="sd">            Name of the model tag that needs to be applied</span>

<span class="sd">        Returns:</span>
<span class="sd">          ner tag of the word at index word_idx.</span>

<span class="sd">        """</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ner_tags</span><span class="p">:</span>
            <span class="n">sentence</span> <span class="o">=</span> <span class="n">Sentence</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="p">,</span> <span class="n">use_tokenizer</span> <span class="o">=</span> <span class="n">words_from_text</span>
            <span class="p">)</span>
            <span class="n">flair_tag</span><span class="p">(</span><span class="n">sentence</span><span class="p">,</span> <span class="n">model_name</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_ner_tags</span> <span class="o">=</span> <span class="n">sentence</span>
        <span class="n">flair_word_list</span><span class="p">,</span> <span class="n">flair_ner_list</span> <span class="o">=</span> <span class="n">zip_flair_result</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_ner_tags</span><span class="p">,</span> <span class="s2">"ner"</span>
        <span class="p">)</span>

        <span class="k">for</span> <span class="n">word_idx</span><span class="p">,</span> <span class="n">word</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">flair_word_list</span><span class="p">):</span>
            <span class="n">word_idx_in_flair_tags</span> <span class="o">=</span> <span class="n">flair_word_list</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">word</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">word_idx</span> <span class="o">==</span> <span class="n">desired_word_idx</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">flair_ner_list</span><span class="p">[</span><span class="n">word_idx_in_flair_tags</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">flair_word_list</span> <span class="o">=</span> <span class="n">flair_word_list</span><span class="p">[</span><span class="n">word_idx_in_flair_tags</span> <span class="o">+</span> <span class="mi">1</span> <span class="p">:]</span>
                <span class="n">flair_ner_list</span> <span class="o">=</span> <span class="n">flair_ner_list</span><span class="p">[</span><span class="n">word_idx_in_flair_tags</span> <span class="o">+</span> <span class="mi">1</span> <span class="p">:]</span>

        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">"Did not find word from index </span><span class="si">{</span><span class="n">desired_word_idx</span><span class="si">}</span><span class="s2"> in flair POS tag"</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_text_index_of_word_index</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""</span>
<span class="sd">        Returns the index of word following i in self.text.</span>

<span class="sd">        Args:</span>
<span class="sd">          i: Integer</span>
<span class="sd">            Index of word upon which perturbation is intended.</span>

<span class="sd">        Returns:</span>
<span class="sd">          look_after_index: Index</span>
<span class="sd">            Index of the word following word[i]</span>
<span class="sd">        """</span>
        <span class="n">pre_words</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">words</span><span class="p">[:</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
        <span class="n">lower_text</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
        <span class="c1"># Find all words until `i` in string.</span>
        <span class="n">look_after_index</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">pre_words</span><span class="p">:</span>
            <span class="n">look_after_index</span> <span class="o">=</span> <span class="n">lower_text</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">word</span><span class="o">.</span><span class="n">lower</span><span class="p">(),</span> <span class="n">look_after_index</span><span class="p">)</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span>
                <span class="n">word</span>
            <span class="p">)</span>
        <span class="n">look_after_index</span> <span class="o">-=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">words</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">look_after_index</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">text_until_word_index</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""</span>
<span class="sd">        Returns the text before the beginning of word at index i.</span>

<span class="sd">        Args:</span>
<span class="sd">          i: Integer</span>
<span class="sd">            Index of word upon which perturbation is intended.</span>

<span class="sd">        Returns:</span>
<span class="sd">          Text before the beginning of word at index i.</span>
<span class="sd">        """</span>
        <span class="n">look_after_index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_text_index_of_word_index</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="p">[:</span><span class="n">look_after_index</span><span class="p">]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">text_after_word_index</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""</span>
<span class="sd">        Returns the text after the end of word at index i.</span>

<span class="sd">        Args:</span>
<span class="sd">          i: Integer</span>
<span class="sd">            Index of word upon which perturbation is intended.</span>

<span class="sd">        Returns:</span>
<span class="sd">          Text after the end of word at index i.</span>
<span class="sd">        """</span>
        <span class="c1"># Get index of beginning of word then jump to end of word.</span>
        <span class="n">look_after_index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_text_index_of_word_index</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">words</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="p">[</span><span class="n">look_after_index</span><span class="p">:]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">first_word_diff</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other_attacked_text</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""</span>
<span class="sd">        Returns the first word in self.words that differs from</span>
<span class="sd">        other_attacked_text.</span>
<span class="sd">        Useful for word swap strategies.</span>

<span class="sd">        Args:</span>
<span class="sd">          other_attacked_text: String Object</span>
<span class="sd">            Sentence/sequence to be compared with given input</span>

<span class="sd">        Returns:</span>
<span class="sd">          w1: String</span>
<span class="sd">            First differing word in self.words if difference exists</span>
<span class="sd">            None otherwise</span>
<span class="sd">        """</span>
        <span class="n">w1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">words</span>
        <span class="n">w2</span> <span class="o">=</span> <span class="n">other_attacked_text</span><span class="o">.</span><span class="n">words</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">w1</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">w2</span><span class="p">))):</span>
            <span class="k">if</span> <span class="n">w1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">!=</span> <span class="n">w2</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
                <span class="k">return</span> <span class="n">w1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">first_word_diff_index</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other_attacked_text</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""</span>
<span class="sd">        Returns the index of the first word in self.words that differs from</span>
<span class="sd">        other_attacked_text.</span>
<span class="sd">        Useful for word swap strategies.</span>

<span class="sd">        Args:</span>
<span class="sd">          other_attacked_text: String object</span>
<span class="sd">            Sentence/sequence to be compared with given input</span>

<span class="sd">        Returns:</span>
<span class="sd">          w1: String</span>
<span class="sd">            First differing word in self.words if difference exists</span>
<span class="sd">            None otherwise</span>
<span class="sd">        """</span>
        <span class="n">w1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">words</span>
        <span class="n">w2</span> <span class="o">=</span> <span class="n">other_attacked_text</span><span class="o">.</span><span class="n">words</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">w1</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">w2</span><span class="p">))):</span>
            <span class="k">if</span> <span class="n">w1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">!=</span> <span class="n">w2</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
                <span class="k">return</span> <span class="n">i</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">all_words_diff</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other_attacked_text</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""</span>
<span class="sd">        Returns the set of indices for which this and other_attacked_text</span>
<span class="sd">        have different words.</span>

<span class="sd">        Args:</span>
<span class="sd">          other_attacked_text: String object</span>
<span class="sd">            Sentence/sequence to be compared with given input</span>

<span class="sd">        Returns:</span>
<span class="sd">          indices: Set</span>
<span class="sd">            differing indices for corresponding words betwee self.words and other_attacked_text</span>
<span class="sd">        """</span>
        <span class="n">indices</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        <span class="n">w1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">words</span>
        <span class="n">w2</span> <span class="o">=</span> <span class="n">other_attacked_text</span><span class="o">.</span><span class="n">words</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">w1</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">w2</span><span class="p">))):</span>
            <span class="k">if</span> <span class="n">w1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">!=</span> <span class="n">w2</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
                <span class="n">indices</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">indices</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">ith_word_diff</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other_attacked_text</span><span class="p">,</span> <span class="n">i</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""</span>
<span class="sd">        Returns whether the word at index i differs from</span>
<span class="sd">        other_attacked_text.</span>

<span class="sd">        Args:</span>
<span class="sd">          other_attacked_text: String object</span>
<span class="sd">            Sentence/sequence to be compared with given input</span>
<span class="sd">          i: Integer</span>
<span class="sd">            Index of word of interest within input sequence</span>

<span class="sd">        Returns:</span>
<span class="sd">          w1: Boolean</span>
<span class="sd">            Checks for differing words in self.words at index i</span>
<span class="sd">        """</span>
        <span class="n">w1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">words</span>
        <span class="n">w2</span> <span class="o">=</span> <span class="n">other_attacked_text</span><span class="o">.</span><span class="n">words</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">w1</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">&lt;</span> <span class="n">i</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">w2</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">&lt;</span> <span class="n">i</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">return</span> <span class="n">w1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">!=</span> <span class="n">w2</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">words_diff_num</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other_attacked_text</span><span class="p">):</span>
        <span class="c1"># using edit distance to calculate words diff num</span>
        <span class="k">def</span><span class="w"> </span><span class="nf">generate_tokens</span><span class="p">(</span><span class="n">words</span><span class="p">):</span>
<span class="w">            </span><span class="sd">"""</span>
<span class="sd">            Generates token for given sequence of words</span>

<span class="sd">            Args:</span>
<span class="sd">              words: List</span>
<span class="sd">                Sequence of words</span>

<span class="sd">            Returns:</span>
<span class="sd">              result: Dictionary</span>
<span class="sd">                Word mapped to corresponding index</span>
<span class="sd">            """</span>
            <span class="n">result</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="n">idx</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">words</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">w</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">result</span><span class="p">:</span>
                    <span class="n">result</span><span class="p">[</span><span class="n">w</span><span class="p">]</span> <span class="o">=</span> <span class="n">idx</span>
                    <span class="n">idx</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">return</span> <span class="n">result</span>

        <span class="k">def</span><span class="w"> </span><span class="nf">words_to_tokens</span><span class="p">(</span><span class="n">words</span><span class="p">,</span> <span class="n">tokens</span><span class="p">):</span>
<span class="w">            </span><span class="sd">"""</span>
<span class="sd">            Helper function to extract corresponding words from tokens</span>

<span class="sd">            Args:</span>
<span class="sd">              words: List</span>
<span class="sd">                Sequence of words</span>
<span class="sd">              tokens: List</span>
<span class="sd">                Sequence of tokens</span>

<span class="sd">            Returns:</span>
<span class="sd">              result: List</span>
<span class="sd">                Corresponding token for each word</span>
<span class="sd">            """</span>
            <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">words</span><span class="p">:</span>
                <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tokens</span><span class="p">[</span><span class="n">w</span><span class="p">])</span>
            <span class="k">return</span> <span class="n">result</span>

        <span class="k">def</span><span class="w"> </span><span class="nf">edit_distance</span><span class="p">(</span><span class="n">w1_t</span><span class="p">,</span> <span class="n">w2_t</span><span class="p">):</span>
<span class="w">            </span><span class="sd">"""</span>
<span class="sd">            Function to find the edit distance between given pair of words</span>

<span class="sd">            Args:</span>
<span class="sd">              w1_t: String</span>
<span class="sd">                Input Sequence #1</span>
<span class="sd">              w2_t: String</span>
<span class="sd">                Input Sequence #2</span>

<span class="sd">            Returns:</span>
<span class="sd">              matrix: 2D Tensor</span>
<span class="sd">                Distance between each letter in input sequence #1 in</span>
<span class="sd">                relation to letter in input sequence #2</span>
<span class="sd">            """</span>
            <span class="n">matrix</span> <span class="o">=</span> <span class="p">[</span>
                <span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="n">j</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">w2_t</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">w1_t</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
            <span class="p">]</span>

            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">w1_t</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">w2_t</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
                    <span class="k">if</span> <span class="n">w1_t</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">w2_t</span><span class="p">[</span><span class="n">j</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]:</span>
                        <span class="n">d</span> <span class="o">=</span> <span class="mi">0</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">d</span> <span class="o">=</span> <span class="mi">1</span>
                    <span class="n">matrix</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span>
                        <span class="n">matrix</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span>
                        <span class="n">matrix</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span>
                        <span class="n">matrix</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">][</span><span class="n">j</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">d</span><span class="p">,</span>
                    <span class="p">)</span>

            <span class="k">return</span> <span class="n">matrix</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">w1_t</span><span class="p">)][</span><span class="nb">len</span><span class="p">(</span><span class="n">w2_t</span><span class="p">)]</span>

        <span class="k">def</span><span class="w"> </span><span class="nf">cal_dif</span><span class="p">(</span><span class="n">w1</span><span class="p">,</span> <span class="n">w2</span><span class="p">):</span>
<span class="w">            </span><span class="sd">"""</span>
<span class="sd">            Calculate the edit distance given any pair of characters</span>

<span class="sd">            Args:</span>
<span class="sd">              w1: String</span>
<span class="sd">                Input Character #1</span>
<span class="sd">              w2: String</span>
<span class="sd">                Input Character #2</span>

<span class="sd">            Returns:</span>
<span class="sd">              Distance between token of input sequence #1 in</span>
<span class="sd">              relation to token of input sequence #2</span>
<span class="sd">            """</span>
            <span class="n">tokens</span> <span class="o">=</span> <span class="n">generate_tokens</span><span class="p">(</span><span class="n">w1</span> <span class="o">+</span> <span class="n">w2</span><span class="p">)</span>
            <span class="n">w1_t</span> <span class="o">=</span> <span class="n">words_to_tokens</span><span class="p">(</span><span class="n">w1</span><span class="p">,</span> <span class="n">tokens</span><span class="p">)</span>
            <span class="n">w2_t</span> <span class="o">=</span> <span class="n">words_to_tokens</span><span class="p">(</span><span class="n">w2</span><span class="p">,</span> <span class="n">tokens</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">edit_distance</span><span class="p">(</span><span class="n">w1_t</span><span class="p">,</span> <span class="n">w2_t</span><span class="p">)</span>

        <span class="n">w1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">words</span>
        <span class="n">w2</span> <span class="o">=</span> <span class="n">other_attacked_text</span><span class="o">.</span><span class="n">words</span>
        <span class="k">return</span> <span class="n">cal_dif</span><span class="p">(</span><span class="n">w1</span><span class="p">,</span> <span class="n">w2</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">convert_from_original_idxs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">idxs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""</span>
<span class="sd">        Takes indices of words from original string and converts them to</span>
<span class="sd">        indices of the same words in the current string.</span>
<span class="sd">        Uses information from</span>
<span class="sd">        self.attack_attrs['original_index_map'], which maps word</span>
<span class="sd">        indices from the original to perturbed text.</span>

<span class="sd">        Args:</span>
<span class="sd">          idxs: List</span>
<span class="sd">            List of indexes</span>

<span class="sd">        Returns:</span>
<span class="sd">          List of mapping of word indices from the original to perturbed text</span>
<span class="sd">        """</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">attack_attrs</span><span class="p">[</span><span class="s2">"original_index_map"</span><span class="p">])</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">idxs</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">idxs</span><span class="p">,</span> <span class="nb">set</span><span class="p">):</span>
            <span class="n">idxs</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">idxs</span><span class="p">)</span>

        <span class="k">elif</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">idxs</span><span class="p">,</span> <span class="p">[</span><span class="nb">list</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">"convert_from_original_idxs got invalid idxs type </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">idxs</span><span class="p">)</span><span class="si">}</span><span class="s2">"</span>
            <span class="p">)</span>

        <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">attack_attrs</span><span class="p">[</span><span class="s2">"original_index_map"</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">idxs</span><span class="p">]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">replace_words_at_indices</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">indices</span><span class="p">,</span> <span class="n">new_words</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""</span>
<span class="sd">        This code returns a new AttackedText object where the word at</span>
<span class="sd">        index is replaced with a new word.</span>

<span class="sd">        Args:</span>
<span class="sd">          indices: List</span>
<span class="sd">            List of indexes of words in input sequence</span>
<span class="sd">          new_words: List</span>
<span class="sd">            List of words with new word as replacement for original word</span>

<span class="sd">        Returns:</span>
<span class="sd">          New AttackedText object where the word at</span>
<span class="sd">          index is replaced with a new word.</span>

<span class="sd">        """</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">indices</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">new_words</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">"Cannot replace </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">new_words</span><span class="p">)</span><span class="si">}</span><span class="s2"> words at </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">indices</span><span class="p">)</span><span class="si">}</span><span class="s2"> indices."</span>
            <span class="p">)</span>
        <span class="n">words</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">words</span><span class="p">[:]</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">new_word</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">indices</span><span class="p">,</span> <span class="n">new_words</span><span class="p">):</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">new_word</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">"replace_words_at_indices requires ``str`` words, got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">new_word</span><span class="p">)</span><span class="si">}</span><span class="s2">"</span>
                <span class="p">)</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">i</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">words</span><span class="p">)):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Cannot assign word at index </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
            <span class="n">words</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_word</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">generate_new_attacked_text</span><span class="p">(</span><span class="n">words</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">replace_word_at_index</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">new_word</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""</span>
<span class="sd">        This code returns a new AttackedText object where the word at</span>
<span class="sd">        index is replaced with a new word.</span>

<span class="sd">        Args:</span>
<span class="sd">          indices: Integer</span>
<span class="sd">            Index of word</span>
<span class="sd">          new_word: String</span>
<span class="sd">            New word for replacement at index of word</span>

<span class="sd">        Returns:</span>
<span class="sd">          New AttackedText object where the word at</span>
<span class="sd">          index is replaced with a new word.</span>
<span class="sd">        """</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">new_word</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">"replace_word_at_index requires ``str`` new_word, got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">new_word</span><span class="p">)</span><span class="si">}</span><span class="s2">"</span>
            <span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">replace_words_at_indices</span><span class="p">([</span><span class="n">index</span><span class="p">],</span> <span class="p">[</span><span class="n">new_word</span><span class="p">])</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">delete_word_at_index</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""</span>
<span class="sd">        This code returns a new AttackedText object where the word at</span>
<span class="sd">        index is removed.</span>

<span class="sd">         Args:</span>
<span class="sd">          index: Integer</span>
<span class="sd">            Index of word</span>

<span class="sd">        Returns:</span>
<span class="sd">          New AttackedText object where the word at</span>
<span class="sd">          index is removed.</span>
<span class="sd">        """</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">replace_word_at_index</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="s2">""</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">insert_text_after_word_index</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">text</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""</span>
<span class="sd">        Inserts a string before word at index "index" and attempts to add</span>
<span class="sd">        appropriate spacing.</span>

<span class="sd">        Args:</span>
<span class="sd">          index: Integer</span>
<span class="sd">            Index of word</span>
<span class="sd">          text: String</span>
<span class="sd">            Input Sequence</span>

<span class="sd">        Returns:</span>
<span class="sd">          New AttackedText object where new word is inserted</span>
<span class="sd">          before word at index "index".</span>
<span class="sd">        """</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">"text must be an str, got type </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">text</span><span class="p">)</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">word_at_index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">words</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
        <span class="n">new_text</span> <span class="o">=</span> <span class="s2">" "</span><span class="o">.</span><span class="n">join</span><span class="p">((</span><span class="n">word_at_index</span><span class="p">,</span> <span class="n">text</span><span class="p">))</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">replace_word_at_index</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">new_text</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">insert_text_before_word_index</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">text</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""</span>
<span class="sd">        Inserts a string before word at index "index" and attempts to add</span>
<span class="sd">        appropriate spacing.</span>

<span class="sd">        Args:</span>
<span class="sd">          index: Integer</span>
<span class="sd">            Index of word</span>
<span class="sd">          text: String</span>
<span class="sd">            Input Sequence</span>

<span class="sd">        Returns:</span>
<span class="sd">          New AttackedText object where the word before</span>
<span class="sd">          index "index" is replaced with a new word.</span>
<span class="sd">        """</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">"text must be an str, got type </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">text</span><span class="p">)</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">word_at_index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">words</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
        <span class="c1"># TODO if ``word_at_index`` is at the beginning of a sentence, we should</span>
        <span class="c1"># optionally capitalize ``text``.</span>
        <span class="n">new_text</span> <span class="o">=</span> <span class="s2">" "</span><span class="o">.</span><span class="n">join</span><span class="p">((</span><span class="n">text</span><span class="p">,</span> <span class="n">word_at_index</span><span class="p">))</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">replace_word_at_index</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">new_text</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_deletion_indices</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""</span>
<span class="sd">        Returns attack attributes based on corresponding</span>
<span class="sd">        attributes in original_index_map</span>

<span class="sd">        Args:</span>
<span class="sd">          None</span>

<span class="sd">        Returns:</span>
<span class="sd">          Attack attributes based on corresponding</span>
<span class="sd">          attributes in original_index_map</span>
<span class="sd">        """</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">attack_attrs</span><span class="p">[</span><span class="s2">"original_index_map"</span><span class="p">][</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">attack_attrs</span><span class="p">[</span><span class="s2">"original_index_map"</span><span class="p">]</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span>
        <span class="p">]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">generate_new_attacked_text</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_words</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""</span>
<span class="sd">        Returns a new AttackedText object and replaces old list of words</span>
<span class="sd">        with a new list of words, but preserves the punctuation and spacing of</span>
<span class="sd">        the original message.</span>
<span class="sd">        self.words is a list of the words in the current text with</span>
<span class="sd">        punctuation removed. However, each "word" in new_words could</span>
<span class="sd">        be an empty string, representing a word deletion, or a string</span>
<span class="sd">        with multiple space-separated words, representation an insertion</span>
<span class="sd">        of one or more words.</span>

<span class="sd">        Args:</span>
<span class="sd">          new_words: String</span>
<span class="sd">            New word for potential replacement</span>

<span class="sd">        Returns:</span>
<span class="sd">          TextAttack object with preturbed text and attack attributes</span>
<span class="sd">        """</span>
        <span class="n">perturbed_text</span> <span class="o">=</span> <span class="s2">""</span>
        <span class="n">original_text</span> <span class="o">=</span> <span class="n">AttackedText</span><span class="o">.</span><span class="n">SPLIT_TOKEN</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_text_input</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
        <span class="n">new_attack_attrs</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="k">if</span> <span class="s2">"label_names"</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">attack_attrs</span><span class="p">:</span>
            <span class="n">new_attack_attrs</span><span class="p">[</span><span class="s2">"label_names"</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">attack_attrs</span><span class="p">[</span><span class="s2">"label_names"</span><span class="p">]</span>
        <span class="n">new_attack_attrs</span><span class="p">[</span><span class="s2">"newly_modified_indices"</span><span class="p">]</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        <span class="c1"># Point to previously monitored text.</span>
        <span class="n">new_attack_attrs</span><span class="p">[</span><span class="s2">"previous_attacked_text"</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span>
        <span class="c1"># Use `new_attack_attrs` to track indices with respect to the original</span>
        <span class="c1"># text.</span>
        <span class="n">new_attack_attrs</span><span class="p">[</span><span class="s2">"modified_indices"</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">attack_attrs</span><span class="p">[</span>
            <span class="s2">"modified_indices"</span>
        <span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">new_attack_attrs</span><span class="p">[</span><span class="s2">"original_index_map"</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">attack_attrs</span><span class="p">[</span>
            <span class="s2">"original_index_map"</span>
        <span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">new_i</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="c1"># Create the new attacked text by swapping out words from the original</span>
        <span class="c1"># text with a sequence of 0+ words in the new text.</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">input_word</span><span class="p">,</span> <span class="n">adv_word_seq</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">words</span><span class="p">,</span> <span class="n">new_words</span><span class="p">)):</span>
            <span class="n">word_start</span> <span class="o">=</span> <span class="n">original_text</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">input_word</span><span class="p">)</span>
            <span class="n">word_end</span> <span class="o">=</span> <span class="n">word_start</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">input_word</span><span class="p">)</span>
            <span class="n">perturbed_text</span> <span class="o">+=</span> <span class="n">original_text</span><span class="p">[:</span><span class="n">word_start</span><span class="p">]</span>
            <span class="n">original_text</span> <span class="o">=</span> <span class="n">original_text</span><span class="p">[</span><span class="n">word_end</span><span class="p">:]</span>
            <span class="n">adv_words</span> <span class="o">=</span> <span class="n">words_from_text</span><span class="p">(</span><span class="n">adv_word_seq</span><span class="p">)</span>
            <span class="n">adv_num_words</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">adv_words</span><span class="p">)</span>
            <span class="n">num_words_diff</span> <span class="o">=</span> <span class="n">adv_num_words</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">words_from_text</span><span class="p">(</span><span class="n">input_word</span><span class="p">))</span>
            <span class="c1"># Track indices on insertions and deletions.</span>
            <span class="k">if</span> <span class="n">num_words_diff</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="c1"># Re-calculated modified indices. If words are inserted or deleted,</span>
                <span class="c1"># they could change.</span>
                <span class="n">shifted_modified_indices</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
                <span class="k">for</span> <span class="n">modified_idx</span> <span class="ow">in</span> <span class="n">new_attack_attrs</span><span class="p">[</span><span class="s2">"modified_indices"</span><span class="p">]:</span>
                    <span class="k">if</span> <span class="n">modified_idx</span> <span class="o">&lt;</span> <span class="n">i</span><span class="p">:</span>
                        <span class="n">shifted_modified_indices</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">modified_idx</span><span class="p">)</span>
                    <span class="k">elif</span> <span class="n">modified_idx</span> <span class="o">&gt;</span> <span class="n">i</span><span class="p">:</span>
                        <span class="n">shifted_modified_indices</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">modified_idx</span> <span class="o">+</span> <span class="n">num_words_diff</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">pass</span>
                <span class="n">new_attack_attrs</span><span class="p">[</span><span class="s2">"modified_indices"</span><span class="p">]</span> <span class="o">=</span> <span class="n">shifted_modified_indices</span>
                <span class="c1"># Track insertions and deletions wrt original text.</span>
                <span class="c1"># original_modification_idx = i</span>
                <span class="n">new_idx_map</span> <span class="o">=</span> <span class="n">new_attack_attrs</span><span class="p">[</span><span class="s2">"original_index_map"</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">num_words_diff</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                    <span class="c1"># Word deletion</span>
                    <span class="n">new_idx_map</span><span class="p">[</span><span class="n">new_idx_map</span> <span class="o">==</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
                <span class="n">new_idx_map</span><span class="p">[</span><span class="n">new_idx_map</span> <span class="o">&gt;</span> <span class="n">i</span><span class="p">]</span> <span class="o">+=</span> <span class="n">num_words_diff</span>

                <span class="k">if</span> <span class="n">num_words_diff</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">input_word</span> <span class="o">!=</span> <span class="n">adv_words</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
                    <span class="c1"># If insertion happens before the `input_word`</span>
                    <span class="n">new_idx_map</span><span class="p">[</span><span class="n">new_idx_map</span> <span class="o">==</span> <span class="n">i</span><span class="p">]</span> <span class="o">+=</span> <span class="n">num_words_diff</span>

                <span class="n">new_attack_attrs</span><span class="p">[</span><span class="s2">"original_index_map"</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_idx_map</span>
            <span class="c1"># Move pointer and save indices of new modified words.</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="n">adv_num_words</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">input_word</span> <span class="o">!=</span> <span class="n">adv_word_seq</span><span class="p">:</span>
                    <span class="n">new_attack_attrs</span><span class="p">[</span><span class="s2">"modified_indices"</span><span class="p">]</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">new_i</span><span class="p">)</span>
                    <span class="n">new_attack_attrs</span><span class="p">[</span><span class="s2">"newly_modified_indices"</span><span class="p">]</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">new_i</span><span class="p">)</span>
                <span class="n">new_i</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="c1"># Check spaces for deleted text.</span>
            <span class="k">if</span> <span class="n">adv_num_words</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">original_text</span><span class="p">):</span>
                <span class="c1"># Remove extra space (or else there would be two spaces for each</span>
                <span class="c1"># deleted word).</span>
                <span class="c1"># @TODO What to do with punctuation in this case? This behavior is undefined.</span>
                <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="c1"># If the first word was deleted, take a subsequent space.</span>
                    <span class="k">if</span> <span class="n">original_text</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s2">" "</span><span class="p">:</span>
                        <span class="n">original_text</span> <span class="o">=</span> <span class="n">original_text</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="c1"># If a word other than the first was deleted, take a preceding space.</span>
                    <span class="k">if</span> <span class="n">perturbed_text</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s2">" "</span><span class="p">:</span>
                        <span class="n">perturbed_text</span> <span class="o">=</span> <span class="n">perturbed_text</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="c1"># Add substitute word(s) to new sentence.</span>
            <span class="n">perturbed_text</span> <span class="o">+=</span> <span class="n">adv_word_seq</span>
        <span class="n">perturbed_text</span> <span class="o">+=</span> <span class="n">original_text</span>  <span class="c1"># Add all of the ending punctuation.</span>
        <span class="c1"># Reform perturbed_text into an OrderedDict.</span>
        <span class="n">perturbed_input_texts</span> <span class="o">=</span> <span class="n">perturbed_text</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">AttackedText</span><span class="o">.</span><span class="n">SPLIT_TOKEN</span><span class="p">)</span>
        <span class="n">perturbed_input</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">(</span>
            <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_text_input</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span> <span class="n">perturbed_input_texts</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">AttackedText</span><span class="p">(</span><span class="n">perturbed_input</span><span class="p">,</span> <span class="n">attack_attrs</span><span class="o">=</span><span class="n">new_attack_attrs</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">words_diff_ratio</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""</span>
<span class="sd">        Get the ratio of word differences between current text and x.</span>
<span class="sd">        Note that current text and x must have same number of words.</span>

<span class="sd">        Args:</span>
<span class="sd">          x: String</span>
<span class="sd">            Compares x with input text for ratio of word differences</span>

<span class="sd">        Returns:</span>
<span class="sd">          Ratio of word differences between current text and x.</span>
<span class="sd">        """</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_words</span> <span class="o">==</span> <span class="n">x</span><span class="o">.</span><span class="n">num_words</span>
        <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">words</span> <span class="o">!=</span> <span class="n">x</span><span class="o">.</span><span class="n">words</span><span class="p">))</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_words</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">align_with_model_tokens</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model_wrapper</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""</span>
<span class="sd">        Align AttackedText's words with target model's tokenization scheme</span>
<span class="sd">        (e.g. word, character, subword).</span>
<span class="sd">        Specifically, we map each word to list</span>
<span class="sd">        of indices of tokens that compose the</span>
<span class="sd">        word (e.g. embedding --&gt; ["em","##bed", "##ding"])</span>

<span class="sd">        Args:</span>
<span class="sd">          model_wrapper: textattack.models.wrappers.ModelWrapper</span>
<span class="sd">            ModelWrapper of the target model</span>

<span class="sd">        Returns:</span>
<span class="sd">          word2token_mapping: (dict[int, list[int]])</span>
<span class="sd">            Dictionary that maps i-th word to list of indices.</span>
<span class="sd">        """</span>
        <span class="n">tokens</span> <span class="o">=</span> <span class="n">model_wrapper</span><span class="o">.</span><span class="n">tokenize</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">tokenizer_input</span><span class="p">],</span> <span class="n">strip_prefix</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">word2token_mapping</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">last_matched</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">word</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">words</span><span class="p">):</span>
            <span class="n">matched_tokens</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">while</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">tokens</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">word</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">token</span> <span class="o">=</span> <span class="n">tokens</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
                <span class="n">idx</span> <span class="o">=</span> <span class="n">word</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">token</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">idx</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">word</span> <span class="o">=</span> <span class="n">word</span><span class="p">[</span><span class="n">idx</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">token</span><span class="p">)</span> <span class="p">:]</span>
                    <span class="n">matched_tokens</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>
                    <span class="n">last_matched</span> <span class="o">=</span> <span class="n">j</span>
                <span class="n">j</span> <span class="o">+=</span> <span class="mi">1</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="n">matched_tokens</span><span class="p">:</span>
                <span class="n">word2token_mapping</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
                <span class="n">j</span> <span class="o">=</span> <span class="n">last_matched</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">word2token_mapping</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">matched_tokens</span>

        <span class="k">return</span> <span class="n">word2token_mapping</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">tokenizer_input</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""</span>
<span class="sd">        The tuple of inputs to be passed to the tokenizer.</span>
<span class="sd">        """</span>
        <span class="n">input_tuple</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_text_input</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
        <span class="c1"># Prefer to return a string instead of a tuple with a single value.</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">input_tuple</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">input_tuple</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">input_tuple</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">column_labels</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""</span>
<span class="sd">        Returns the labels for this text's columns.</span>
<span class="sd">        For single-sequence inputs, this simply returns ['text'].</span>
<span class="sd">        """</span>
        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_text_input</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">words_per_input</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""</span>
<span class="sd">        Returns a list of lists of words corresponding to each input.</span>
<span class="sd">        """</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_words_per_input</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_words_per_input</span> <span class="o">=</span> <span class="p">[</span>
                <span class="n">words_from_text</span><span class="p">(</span><span class="n">_input</span><span class="p">)</span> <span class="k">for</span> <span class="n">_input</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_text_input</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
            <span class="p">]</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_words_per_input</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">words</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_words</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_words</span> <span class="o">=</span> <span class="n">words_from_text</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_words</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">text</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""</span>
<span class="sd">        Represents full text input.</span>
<span class="sd">        Multiply inputs are joined with a line break.</span>
<span class="sd">        """</span>
        <span class="k">return</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_text_input</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">num_words</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""</span>
<span class="sd">        Returns the number of words in the sequence.</span>
<span class="sd">        """</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">words</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">printable_text</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key_color</span><span class="o">=</span><span class="s2">"bold"</span><span class="p">,</span> <span class="n">key_color_method</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""</span>
<span class="sd">        Represents full text input. Adds field descriptions.</span>

<span class="sd">        Args:</span>
<span class="sd">        key_color: String</span>
<span class="sd">          Field description of input text</span>
<span class="sd">        key_color_method: String</span>
<span class="sd">          Color method description of input text</span>

<span class="sd">        Usage/Example:</span>
<span class="sd">            entailment inputs look like:</span>
<span class="sd">            premise: ...</span>
<span class="sd">            hypothesis: ...</span>

<span class="sd">        Returns:</span>
<span class="sd">          Next iterable value for single sequence inputs</span>
<span class="sd">          Shared field attributes for multi-sequence inputs</span>
<span class="sd">        """</span>
        <span class="c1"># For single-sequence inputs, don't show a prefix.</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_text_input</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_text_input</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span>
        <span class="c1"># For multiple-sequence inputs, show a prefix and a colon. Optionally,</span>
        <span class="c1"># color the key.</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">key_color_method</span><span class="p">:</span>

                <span class="k">def</span><span class="w"> </span><span class="nf">ck</span><span class="p">(</span><span class="n">k</span><span class="p">):</span>
                    <span class="k">return</span> <span class="n">textattack</span><span class="o">.</span><span class="n">shared</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">color_text</span><span class="p">(</span>
                        <span class="n">k</span><span class="p">,</span> <span class="n">key_color</span><span class="p">,</span> <span class="n">key_color_method</span>
                    <span class="p">)</span>

            <span class="k">else</span><span class="p">:</span>

                <span class="k">def</span><span class="w"> </span><span class="nf">ck</span><span class="p">(</span><span class="n">k</span><span class="p">):</span>
                    <span class="k">return</span> <span class="n">k</span>

            <span class="k">return</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">ck</span><span class="p">(</span><span class="n">key</span><span class="o">.</span><span class="n">capitalize</span><span class="p">())</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2">"</span>
                <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_text_input</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
            <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s1">'&lt;AttackedText "</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="si">}</span><span class="s1">"&gt;'</span>


<span class="k">class</span><span class="w"> </span><span class="nc">Augmenter</span><span class="p">:</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    A class for performing data augmentation using TextAttack.</span>
<span class="sd">    """</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">transformation</span><span class="p">,</span>
        <span class="n">constraints</span><span class="o">=</span><span class="p">[],</span>
        <span class="n">pct_words_to_swap</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
        <span class="n">transformations_per_example</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">"""</span>
<span class="sd">        Initiates the following attributes:</span>

<span class="sd">        Args:</span>
<span class="sd">          transformation: Transformation Object</span>
<span class="sd">            The transformation that suggests new texts from an input.</span>
<span class="sd">          constraints: List</span>
<span class="sd">            Constraints that each transformation must meet</span>
<span class="sd">          pct_words_to_swap: Float [0., 1.],</span>
<span class="sd">            Percentage of words to swap per augmented example</span>
<span class="sd">          transformations_per_example: Integer</span>
<span class="sd">            Maximum number of augmentations per input</span>

<span class="sd">         Returns:</span>
<span class="sd">          None</span>
<span class="sd">        """</span>
        <span class="k">assert</span> <span class="p">(</span>
            <span class="n">transformations_per_example</span> <span class="o">&gt;</span> <span class="mi">0</span>
        <span class="p">),</span> <span class="s2">"transformations_per_example must be a positive integer"</span>
        <span class="k">assert</span> <span class="mf">0.0</span> <span class="o">&lt;=</span> <span class="n">pct_words_to_swap</span> <span class="o">&lt;=</span> <span class="mf">1.0</span><span class="p">,</span> <span class="s2">"pct_words_to_swap must be in [0., 1.]"</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">transformation</span> <span class="o">=</span> <span class="n">transformation</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pct_words_to_swap</span> <span class="o">=</span> <span class="n">pct_words_to_swap</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">transformations_per_example</span> <span class="o">=</span> <span class="n">transformations_per_example</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">constraints</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pre_transformation_constraints</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">constraint</span> <span class="ow">in</span> <span class="n">constraints</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">constraint</span><span class="p">,</span> <span class="n">PreTransformationConstraint</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">pre_transformation_constraints</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">constraint</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">constraints</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">constraint</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_filter_transformations</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">transformed_texts</span><span class="p">,</span> <span class="n">current_text</span><span class="p">,</span> <span class="n">original_text</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""</span>
<span class="sd">        Filters a list of AttackedText objects to include only the ones</span>
<span class="sd">        that pass self.constraints.</span>

<span class="sd">        Args:</span>
<span class="sd">          Transformed_text: List</span>
<span class="sd">            List of Strings corresponding to transformations</span>
<span class="sd">          Current_text: String</span>
<span class="sd">            String to be compared against for transformation</span>
<span class="sd">            when original does not meet constraint requirement</span>
<span class="sd">          Original_text: String</span>
<span class="sd">            Original Input String</span>

<span class="sd">        Returns:</span>
<span class="sd">          All possible transformations for a given string. Currently only</span>
<span class="sd">        supports transformations which are word swaps.</span>
<span class="sd">        """</span>
        <span class="k">for</span> <span class="n">C</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">constraints</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">transformed_texts</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">break</span>
            <span class="k">if</span> <span class="n">C</span><span class="o">.</span><span class="n">compare_against_original</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">original_text</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                        <span class="sa">f</span><span class="s2">"Missing `original_text` argument when constraint </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">C</span><span class="p">)</span><span class="si">}</span><span class="s2"> is set to compare against "</span>
                        <span class="sa">f</span><span class="s2">"`original_text` "</span>
                    <span class="p">)</span>

                <span class="n">transformed_texts</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">call_many</span><span class="p">(</span><span class="n">transformed_texts</span><span class="p">,</span> <span class="n">original_text</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">transformed_texts</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">call_many</span><span class="p">(</span><span class="n">transformed_texts</span><span class="p">,</span> <span class="n">current_text</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">transformed_texts</span>


    <span class="k">def</span><span class="w"> </span><span class="nf">augment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""</span>
<span class="sd">        Returns all possible augmentations of text according to</span>
<span class="sd">        self.transformation.</span>

<span class="sd">        Args:</span>
<span class="sd">          text: String</span>
<span class="sd">            Text to be augmented via transformation</span>

<span class="sd">        Returns:</span>
<span class="sd">          Sorted list of all possible augmentations of text according to</span>
<span class="sd">          compatible self.transformation.</span>
<span class="sd">        """</span>
        <span class="n">attacked_text</span> <span class="o">=</span> <span class="n">AttackedText</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
        <span class="n">original_text</span> <span class="o">=</span> <span class="n">attacked_text</span>
        <span class="n">all_transformed_texts</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        <span class="n">num_words_to_swap</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span>
            <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pct_words_to_swap</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">attacked_text</span><span class="o">.</span><span class="n">words</span><span class="p">)),</span> <span class="mi">1</span>
        <span class="p">)</span>
        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">transformations_per_example</span><span class="p">):</span>
            <span class="n">current_text</span> <span class="o">=</span> <span class="n">attacked_text</span>
            <span class="n">words_swapped</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">current_text</span><span class="o">.</span><span class="n">attack_attrs</span><span class="p">[</span><span class="s2">"modified_indices"</span><span class="p">])</span>

            <span class="k">while</span> <span class="n">words_swapped</span> <span class="o">&lt;</span> <span class="n">num_words_to_swap</span><span class="p">:</span>
                <span class="n">transformed_texts</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">transformation</span><span class="p">(</span>
                    <span class="n">current_text</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">pre_transformation_constraints</span>
                <span class="p">)</span>

                <span class="c1"># Get rid of transformations we already have</span>
                <span class="n">transformed_texts</span> <span class="o">=</span> <span class="p">[</span>
                    <span class="n">t</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">transformed_texts</span> <span class="k">if</span> <span class="n">t</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">all_transformed_texts</span>
                <span class="p">]</span>

                <span class="c1"># Filter out transformations that don't match the constraints.</span>
                <span class="n">transformed_texts</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_filter_transformations</span><span class="p">(</span>
                    <span class="n">transformed_texts</span><span class="p">,</span> <span class="n">current_text</span><span class="p">,</span> <span class="n">original_text</span>
                <span class="p">)</span>

                <span class="c1"># if there's no more transformed texts after filter, terminate</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="nb">len</span><span class="p">(</span><span class="n">transformed_texts</span><span class="p">):</span>
                    <span class="k">break</span>

                <span class="n">current_text</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">transformed_texts</span><span class="p">)</span>

                <span class="c1"># update words_swapped based on modified indices</span>
                <span class="n">words_swapped</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span>
                    <span class="nb">len</span><span class="p">(</span><span class="n">current_text</span><span class="o">.</span><span class="n">attack_attrs</span><span class="p">[</span><span class="s2">"modified_indices"</span><span class="p">]),</span>
                    <span class="n">words_swapped</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="n">all_transformed_texts</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">current_text</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">sorted</span><span class="p">([</span><span class="n">at</span><span class="o">.</span><span class="n">printable_text</span><span class="p">()</span> <span class="k">for</span> <span class="n">at</span> <span class="ow">in</span> <span class="n">all_transformed_texts</span><span class="p">])</span>


    <span class="k">def</span><span class="w"> </span><span class="nf">augment_many</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text_list</span><span class="p">,</span> <span class="n">show_progress</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""</span>
<span class="sd">        Returns all possible augmentations of a list of strings according to</span>
<span class="sd">        self.transformation.</span>

<span class="sd">        Args:</span>
<span class="sd">          text_list: List of strings</span>
<span class="sd">            A list of strings for data augmentation</span>
<span class="sd">          show_progress: Boolean</span>
<span class="sd">            A variable that controls visibility of Augmentation progress</span>

<span class="sd">        Returns:</span>
<span class="sd">          A list(string) of augmented texts.</span>
<span class="sd">        """</span>
        <span class="k">if</span> <span class="n">show_progress</span><span class="p">:</span>
            <span class="n">text_list</span> <span class="o">=</span> <span class="n">tqdm</span><span class="o">.</span><span class="n">tqdm</span><span class="p">(</span><span class="n">text_list</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="s2">"Augmenting data..."</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">augment</span><span class="p">(</span><span class="n">text</span><span class="p">)</span> <span class="k">for</span> <span class="n">text</span> <span class="ow">in</span> <span class="n">text_list</span><span class="p">]</span>


    <span class="k">def</span><span class="w"> </span><span class="nf">augment_text_with_ids</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text_list</span><span class="p">,</span> <span class="n">id_list</span><span class="p">,</span> <span class="n">show_progress</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""</span>
<span class="sd">        Supplements a list of text with more text data.</span>

<span class="sd">         Args:</span>
<span class="sd">          text_list: List of strings</span>
<span class="sd">            A list of strings for data augmentation</span>
<span class="sd">          id_list: List of indexes</span>
<span class="sd">            A list of indexes for corresponding strings</span>
<span class="sd">          show_progress: Boolean</span>
<span class="sd">            A variable that controls visibility of augmentation progress</span>

<span class="sd">        Returns:</span>
<span class="sd">          all_text_list, all_id_list: List, List</span>
<span class="sd">            The augmented text along with the corresponding IDs for</span>
<span class="sd">            each augmented example.</span>
<span class="sd">        """</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">text_list</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">id_list</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">"List of text must be same length as list of IDs"</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">transformations_per_example</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">text_list</span><span class="p">,</span> <span class="n">id_list</span>
        <span class="n">all_text_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">all_id_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">show_progress</span><span class="p">:</span>
            <span class="n">text_list</span> <span class="o">=</span> <span class="n">tqdm</span><span class="o">.</span><span class="n">tqdm</span><span class="p">(</span><span class="n">text_list</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="s2">"Augmenting data..."</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">text</span><span class="p">,</span> <span class="n">_id</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">text_list</span><span class="p">,</span> <span class="n">id_list</span><span class="p">):</span>
            <span class="n">all_text_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
            <span class="n">all_id_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">_id</span><span class="p">)</span>
            <span class="n">augmented_texts</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">augment</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
            <span class="n">all_text_list</span><span class="o">.</span><span class="n">extend</span>
            <span class="n">all_text_list</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="n">text</span><span class="p">]</span> <span class="o">+</span> <span class="n">augmented_texts</span><span class="p">)</span>
            <span class="n">all_id_list</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="n">_id</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">augmented_texts</span><span class="p">)))</span>
        <span class="k">return</span> <span class="n">all_text_list</span><span class="p">,</span> <span class="n">all_id_list</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">main_str</span> <span class="o">=</span> <span class="s2">"Augmenter"</span> <span class="o">+</span> <span class="s2">"("</span>
        <span class="n">lines</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="c1"># self.transformation</span>
        <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">utils</span><span class="o">.</span><span class="n">add_indent</span><span class="p">(</span><span class="sa">f</span><span class="s2">"(transformation):  </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">transformation</span><span class="si">}</span><span class="s2">"</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
        <span class="c1"># self.constraints</span>
        <span class="n">constraints_lines</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">constraints</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">constraints</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">pre_transformation_constraints</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">constraints</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">constraint</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">constraints</span><span class="p">):</span>
                <span class="n">constraints_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">utils</span><span class="o">.</span><span class="n">add_indent</span><span class="p">(</span><span class="sa">f</span><span class="s2">"(</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">): </span><span class="si">{</span><span class="n">constraint</span><span class="si">}</span><span class="s2">"</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
            <span class="n">constraints_str</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">add_indent</span><span class="p">(</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span> <span class="o">+</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">constraints_lines</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">constraints_str</span> <span class="o">=</span> <span class="s2">"None"</span>
        <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">utils</span><span class="o">.</span><span class="n">add_indent</span><span class="p">(</span><span class="sa">f</span><span class="s2">"(constraints): </span><span class="si">{</span><span class="n">constraints_str</span><span class="si">}</span><span class="s2">"</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
        <span class="n">main_str</span> <span class="o">+=</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">  "</span> <span class="o">+</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">  "</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span> <span class="o">+</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span>
        <span class="n">main_str</span> <span class="o">+=</span> <span class="s2">")"</span>
        <span class="k">return</span> <span class="n">main_str</span>
</pre></div>
</div>
</div>
</details>

</div>
</section>
<section id="bonus-3-2-augment-the-original-review">
<h3>Bonus 3.2: Augment the original review<a class="headerlink" href="#bonus-3-2-augment-the-original-review" title="Permalink to this heading">#</a></h3>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Bonus 3.2: Augment the original review</span>

<span class="c1"># @markdown ---</span>
<span class="c1"># @markdown Word-level Augmentations</span>
<span class="n">word_swap_contract</span> <span class="o">=</span> <span class="kc">True</span>  <span class="c1"># @param {type:"boolean"}</span>
<span class="n">word_swap_extend</span> <span class="o">=</span> <span class="kc">False</span>  <span class="c1"># @param {type:"boolean"}</span>
<span class="n">word_swap_homoglyph_swap</span> <span class="o">=</span> <span class="kc">False</span>  <span class="c1"># @param {type:"boolean"}</span>

<span class="c1"># @markdown ---</span>
<span class="c1"># @markdown Character-level Augmentations</span>
<span class="n">word_swap_neighboring_character_swap</span> <span class="o">=</span> <span class="kc">True</span>  <span class="c1"># @param {type:"boolean"}</span>
<span class="n">word_swap_qwerty</span> <span class="o">=</span> <span class="kc">False</span>  <span class="c1"># @param {type:"boolean"}</span>
<span class="n">word_swap_random_character_deletion</span> <span class="o">=</span> <span class="kc">False</span>  <span class="c1"># @param {type:"boolean"}</span>
<span class="n">word_swap_random_character_insertion</span> <span class="o">=</span> <span class="kc">False</span>  <span class="c1"># @param {type:"boolean"}</span>
<span class="n">word_swap_random_character_substitution</span> <span class="o">=</span> <span class="kc">False</span>  <span class="c1"># @param {type:"boolean"}</span>
<span class="c1"># @markdown ---</span>

<span class="c1"># @markdown Check all the augmentations that you wish to apply!</span>

<span class="c1"># @markdown **NOTE:** *Try applying each augmentation individually, and observe the changes.*</span>

<span class="c1"># Apply augmentations</span>
<span class="n">augmentations</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">if</span> <span class="n">word_swap_contract</span><span class="p">:</span>
  <span class="n">augmentations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">WordSwapContract</span><span class="p">())</span>
<span class="k">if</span> <span class="n">word_swap_extend</span><span class="p">:</span>
  <span class="n">augmentations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">WordSwapExtend</span><span class="p">())</span>
<span class="k">if</span> <span class="n">word_swap_homoglyph_swap</span><span class="p">:</span>
  <span class="n">augmentations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">WordSwapHomoglyphSwap</span><span class="p">())</span>
<span class="k">if</span> <span class="n">word_swap_neighboring_character_swap</span><span class="p">:</span>
  <span class="n">augmentations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">WordSwapNeighboringCharacterSwap</span><span class="p">())</span>
<span class="k">if</span> <span class="n">word_swap_qwerty</span><span class="p">:</span>
  <span class="n">augmentations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">WordSwapQWERTY</span><span class="p">())</span>
<span class="k">if</span> <span class="n">word_swap_random_character_deletion</span><span class="p">:</span>
  <span class="n">augmentations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">WordSwapRandomCharacterDeletion</span><span class="p">())</span>
<span class="k">if</span> <span class="n">word_swap_random_character_insertion</span><span class="p">:</span>
  <span class="n">augmentations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">WordSwapRandomCharacterInsertion</span><span class="p">())</span>
<span class="k">if</span> <span class="n">word_swap_random_character_substitution</span><span class="p">:</span>
  <span class="n">augmentations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">WordSwapRandomCharacterSubstitution</span><span class="p">())</span>

<span class="n">transformation</span> <span class="o">=</span> <span class="n">CompositeTransformation</span><span class="p">(</span><span class="n">augmentations</span><span class="p">)</span>
<span class="n">augmenter</span> <span class="o">=</span> <span class="n">Augmenter</span><span class="p">(</span><span class="n">transformation</span><span class="o">=</span><span class="n">transformation</span><span class="p">,</span>
                      <span class="n">transformations_per_example</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">augmented_review</span> <span class="o">=</span> <span class="n">clean_text</span><span class="p">(</span><span class="n">augmenter</span><span class="o">.</span><span class="n">augment</span><span class="p">(</span><span class="n">context</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"Augmented review:</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">augmented_review</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>

</div>
<p>We can now check the predictions for the original text and its augmented version! Try to find the perfect combination of perturbations to break the model, i.e., model giving incorrect prediction for the augmented text.</p>
</section>
<section id="bonus-3-3-check-model-predictions">
<h3>Bonus 3.3: Check model predictions<a class="headerlink" href="#bonus-3-3-check-model-predictions" title="Permalink to this heading">#</a></h3>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Bonus 3.3: Check model predictions</span>
<span class="k">def</span><span class="w"> </span><span class="nf">getPrediction</span><span class="p">(</span><span class="n">text</span><span class="p">):</span>
<span class="w">  </span><span class="sd">"""</span>
<span class="sd">  Outputs model prediction based on the input text.</span>

<span class="sd">  Args:</span>
<span class="sd">    text: String</span>
<span class="sd">      Input text</span>

<span class="sd">  Returns:</span>
<span class="sd">    item of pred: Iterable</span>
<span class="sd">      Prediction on the input text</span>
<span class="sd">  """</span>
  <span class="n">inputs</span> <span class="o">=</span> <span class="n">tokenizer</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="s2">"max_length"</span><span class="p">,</span>
                     <span class="n">truncation</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">return_tensors</span><span class="o">=</span><span class="s2">"pt"</span><span class="p">)</span>
  <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">inputs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="n">inputs</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>

  <span class="n">outputs</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="o">**</span><span class="n">inputs</span><span class="p">)</span>
  <span class="n">logits</span> <span class="o">=</span> <span class="n">outputs</span><span class="o">.</span><span class="n">logits</span>
  <span class="n">pred</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">logits</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
  <span class="k">return</span> <span class="n">pred</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">"original Review:</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">context</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"</span><span class="se">\n</span><span class="s2">Predicted Sentiment ="</span><span class="p">,</span> <span class="n">getPrediction</span><span class="p">(</span><span class="n">context</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"########################################"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"</span><span class="se">\n</span><span class="s2">Augmented Review:</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">augmented_review</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"</span><span class="se">\n</span><span class="s2">Predicted Sentiment ="</span><span class="p">,</span> <span class="n">getPrediction</span><span class="p">(</span><span class="n">augmented_review</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"########################################"</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>

</div>
</section>
<section id="id4">
<h3>Submit your feedback<a class="headerlink" href="#id4" title="Permalink to this heading">#</a></h3>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Submit your feedback</span>
<span class="n">content_review</span><span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">feedback_prefix</span><span class="si">}</span><span class="s2">_Textattack_module_Interactive_Demos"</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"version_major": 2, "version_minor": 0, "model_id": "d34cb364a0da4bd3a361564a6fec4719"}</script></div>
</div>
</section>
</section>
</section>
<script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./tutorials/W2D5_AttentionAndTransformers/student"
        },
        predefinedOutput: true
    }
    </script>
<script>kernelName = 'python3'</script>
</article>
<footer class="bd-footer-article">
<!-- Previous / next buttons -->
<div class="prev-next-area">
<a class="left-prev" href="W2D5_Tutorial1.html" id="prev-link" title="previous page">
<i class="fa-solid fa-angle-left"></i>
<div class="prev-next-info">
<p class="prev-next-subtitle">previous</p>
<p class="prev-next-title">Tutorial 1: Learn how to work with Transformers</p>
</div>
</a>
<a class="right-next" href="../../W3D1_TimeSeriesAndNaturalLanguageProcessing/chapter_title.html" id="next-link" title="next page">
<div class="prev-next-info">
<p class="prev-next-subtitle">next</p>
<p class="prev-next-title">Time Series And Natural Language Processing</p>
</div>
<i class="fa-solid fa-angle-right"></i>
</a>
</div>
</footer>
</div>
<div class="bd-sidebar-secondary bd-toc">
<div class="toc-item">
<div class="tocsection onthispage">
<i class="fa-solid fa-list"></i> On this page
</div>
<nav class="page-toc" id="bd-toc-nav">
<ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#">
   Bonus Tutorial: Understanding Pre-training, Fine-tuning and Robustness of Transformers
  </a>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#tutorial-objectives">
   Tutorial Objectives
  </a>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#setup">
   Setup
  </a>
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#install-dependencies">
     Install dependencies
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#install-and-import-feedback-gadget">
     Install and import feedback gadget
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#set-environment-variables">
     Set environment variables
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#set-random-seed">
     Set random seed
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#set-device-gpu-or-cpu-execute-set-device">
     Set device (GPU or CPU). Execute
     <code class="docutils literal notranslate">
<span class="pre">
       set_device()
      </span>
</code>
</a>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#bonus-1-language-modeling-as-pre-training">
   Bonus 1: Language modeling as pre-training
  </a>
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#video-1-pre-training">
     Video 1: Pre-training
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#submit-your-feedback">
     Submit your feedback
    </a>
<ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#bonus-interactive-demo-1-gpt-2-for-sentiment-classification">
       Bonus Interactive Demo 1: GPT-2 for sentiment classification
      </a>
<ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#download-the-dataset-from-osf">
         Download the dataset from OSF
        </a>
</li>
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#load-the-dataset">
         Load the dataset
        </a>
</li>
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#bonus-1-1-load-yelp-reviews-dataset">
         Bonus 1.1: Load Yelp reviews dataset ⌛🤗
        </a>
</li>
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#bonus-1-2-setting-up-a-text-context">
         Bonus 1.2: Setting up a text context ✍️
        </a>
</li>
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#bonus-1-3-extending-the-review-with-pre-trained-models">
         Bonus 1.3: Extending the review with pre-trained models 🤖
        </a>
</li>
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#bonus-1-4-sentiment-binary-classification-with-likelihood-of-positive-and-negative-extensions-of-the-review">
         Bonus 1.4: Sentiment binary-classification with likelihood of positive and negative extensions of the review 👍👎
        </a>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#bonus-2-light-weight-fine-tuning">
   Bonus 2: Light-weight fine-tuning
  </a>
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#video-2-fine-tuning">
     Video 2: Fine-tuning
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#id1">
     Submit your feedback
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#bonus-2-1-data-processing">
     Bonus 2.1: Data Processing
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#bonus-2-2-model-loading">
     Bonus 2.2: Model Loading
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#bonus-2-3-fine-tuning">
     Bonus 2.3: Fine-tuning
    </a>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#bonus-3-model-robustness">
   Bonus 3: Model robustness
  </a>
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#video-3-robustness">
     Video 3: Robustness
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#id2">
     Submit your feedback
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#bonus-interactive-demo-3-break-the-model">
     Bonus Interactive Demo 3: Break the model
    </a>
<ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#bonus-3-1-load-an-original-review">
       Bonus 3.1: Load an original review
      </a>
</li>
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#id3">
       Submit your feedback
      </a>
</li>
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#helper-functions-to-avoid-textattack-issue">
       Helper functions to avoid
       <code class="docutils literal notranslate">
<span class="pre">
         textattack
        </span>
</code>
       issue
      </a>
</li>
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#bonus-3-2-augment-the-original-review">
       Bonus 3.2: Augment the original review
      </a>
</li>
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#bonus-3-3-check-model-predictions">
       Bonus 3.3: Check model predictions
      </a>
</li>
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#id4">
       Submit your feedback
      </a>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
</div>
</div>
</div>
<footer class="bd-footer-content">
<div class="bd-footer-content__inner">
<div class="bd-footer-content__inner container">
<div class="footer-item">
<p class="component-author">
By Neuromatch
</p>
</div>
<div class="footer-item">
</div>
<div class="footer-item">
<p class="last-updated">
Last updated on None.<br/>
</p>
</div>
<div class="footer-item">
<div class="extra_footer">
<div>
<a href="http://creativecommons.org/licenses/by/4.0/"><img src="https://i.creativecommons.org/l/by/4.0/88x31.png"/></a>
<a href="https://opensource.org/licenses/BSD-3-Clause"><img src="https://camo.githubusercontent.com/9b9ea65d95c9ef878afa1987df65731d47681336/68747470733a2f2f696d672e736869656c64732e696f2f707970692f6c2f736561626f726e2e737667"/></a>
The contents of this repository are shared under under a <a href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License</a>.
Software elements are additionally licensed under the <a href="https://opensource.org/licenses/BSD-3-Clause">BSD (3-Clause) License</a>.
</div>
</div>
</div>
</div>
</div>
</footer>
</main>
</div>
</div>
<!-- Scripts loaded after <body> so the DOM is not blocked -->
<script src="../../../_static/scripts/bootstrap.js?digest=796348d33e8b1d947c94"></script>
<script src="../../../_static/scripts/pydata-sphinx-theme.js?digest=796348d33e8b1d947c94"></script>
</body>
</html>